var vs=Object.defineProperty,ws=Object.defineProperties;var ks=Object.getOwnPropertyDescriptors;var tt=Object.getOwnPropertySymbols;var _n=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable;var jn=(e,t,n)=>t in e?vs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,R=(e,t)=>{for(var n in t||(t={}))_n.call(t,n)&&jn(e,n,t[n]);if(tt)for(var n of tt(t))Fn.call(t,n)&&jn(e,n,t[n]);return e},I=(e,t)=>ws(e,ks(t));var Jt=(e,t)=>{var n={};for(var r in e)_n.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&tt)for(var r of tt(e))t.indexOf(r)<0&&Fn.call(e,r)&&(n[r]=e[r]);return n};var _e=(e,t,n)=>new Promise((r,s)=>{var o=a=>{try{l(n.next(a))}catch(c){s(c)}},i=a=>{try{l(n.throw(a))}catch(c){s(c)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,i);l((n=n.apply(e,t)).next())});import{af as F,ag as Be,ah as H,ai as Le,aj as xe,ak as Ie,al as Y,am as Q,an as q,ao as an,ap as J,aq as Cr,ar as Cs,as as Ar,at as Gt,au as As,av as xs,aw as Ts,ax as Ls,ay as Ss,az as xr,aA as j,aB as cn,aC as Ms,aD as Es,aE as Tr,aF as Rs,aG as Is,aH as Wn,aI as Hs,aJ as re,aK as ue,aL as Lr,aM as Te,aN as He,aO as Ns,aP as Sr,aQ as Mr,aR as Os,aS as Ps,aT as $s,aU as zs,aV as Ds,aW as Bs,s as Er,C as js,o as _,c as U,b as C,a as E,w as K,g as x,aX as _s,aY as Fs,F as $e,r as ze,t as be,aZ as Ws,a_ as Us,a$ as Ks,b0 as Vs,b1 as Gs,b2 as nt,d as ye,b3 as qs,b4 as Xs,b5 as Js,b6 as Ys,b7 as Qs,N as Zs,b8 as eo,b9 as to,ba as no,bb as ro,i as dt,W as pt,U as un,V as dn,bc as so,bd as oo,e as ft,z as Z,be as io,bf as lo,bg as ao,a7 as co,ad as uo,n as Un,bh as po,u as fo,A as ho}from"./vue-vendor-Cf1u-26_.js";import{u as mo}from"./usePdfApi-BXiAzpXu.js";var yt=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);const s=t!=null?t:{},{children:n}=s,r=Jt(s,["children"]);if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,r,n]},go=/^\s*>\s$/,bo=F.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return yt("blockquote",I(R({},H(this.options.HTMLAttributes,e)),{children:yt("slot",{})}))},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";const n=">",r=[];return e.content.forEach(s=>{const l=t.renderChildren([s]).split(`
`).map(a=>a.trim()===""?n:`${n} ${a}`);r.push(l.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Be({find:go,type:this.type})]}}),yo=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,vo=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,wo=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ko=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Co=Le.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return yt("strong",I(R({},H(this.options.HTMLAttributes,e)),{children:yt("slot",{})}))},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ie({find:yo,type:this.type}),Ie({find:wo,type:this.type})]},addPasteRules(){return[xe({find:vo,type:this.type}),xe({find:ko,type:this.type})]}}),Ao=/(^|[^`])`([^`]+)`(?!`)$/,xo=/(^|[^`])`([^`]+)`(?!`)/g,To=Le.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",H(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ie({find:Ao,type:this.type})]},addPasteRules(){return[xe({find:xo,type:this.type})]}}),Yt=4,Lo=/^```([a-z]+)?[\s\n]$/,So=/^~~~([a-z]+)?[\s\n]$/,Mo=F.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Yt,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options;if(!n)return null;const o=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",H(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var n;return((n=e.raw)==null?void 0:n.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var n;let r="";const s=((n=e.attrs)==null?void 0:n.language)||"";return e.content?r=[`\`\`\`${s}`,t.renderChildren(e.content),"```"].join(`
`):r=`\`\`\`${s}

\`\`\``,r},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const n=(t=this.options.tabSize)!=null?t:Yt,{state:r}=e,{selection:s}=r,{$from:o,empty:i}=s;if(o.parent.type!==this.type)return!1;const l=" ".repeat(n);return i?e.commands.insertContent(l):e.commands.command(({tr:a})=>{const{from:c,to:d}=s,f=r.doc.textBetween(c,d,`
`,`
`).split(`
`).map(h=>l+h).join(`
`);return a.replaceWith(c,d,r.schema.text(f)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const n=(t=this.options.tabSize)!=null?t:Yt,{state:r}=e,{selection:s}=r,{$from:o,empty:i}=s;return o.parent.type!==this.type?!1:i?e.commands.command(({tr:l})=>{var a;const{pos:c}=o,d=o.start(),u=o.end(),f=r.doc.textBetween(d,u,`
`,`
`).split(`
`);let h=0,m=0;const g=c-d;for(let k=0;k<f.length;k+=1){if(m+f[k].length>=g){h=k;break}m+=f[k].length+1}const S=((a=f[h].match(/^ */))==null?void 0:a[0])||"",P=Math.min(S.length,n);if(P===0)return!0;let B=d;for(let k=0;k<h;k+=1)B+=f[k].length+1;return l.delete(B,B+P),c-B<=P&&l.setSelection(q.create(l.doc,B)),!0}):e.commands.command(({tr:l})=>{const{from:a,to:c}=s,p=r.doc.textBetween(a,c,`
`,`
`).split(`
`).map(f=>{var h;const m=((h=f.match(/^ */))==null?void 0:h[0])||"",g=Math.min(m.length,n);return f.slice(g)}).join(`
`);return l.replaceWith(a,c,r.schema.text(p)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:e.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const l=s.after();return l===void 0?!1:r.nodeAt(l)?e.commands.command(({tr:c})=>(c.setSelection(J.near(r.resolve(l))),!0)):e.commands.exitCode()}}},addInputRules(){return[an({find:Lo,type:this.type,getAttributes:e=>({language:e[1]})}),an({find:So,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Y({key:new Q("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s==null?void 0:s.mode;if(!n||!o)return!1;const{tr:i,schema:l}=e.state,a=l.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},a)),i.selection.$from.parent.type!==this.type&&i.setSelection(q.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),Eo=F.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""}),Ro=F.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",H(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:l}=r.extensionManager,a=o||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:d})=>{if(d&&a&&i){const u=a.filter(p=>l.includes(p.type.name));c.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Io=F.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,H(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var n;const r=(n=e.attrs)!=null&&n.level?parseInt(e.attrs.level,10):1,s="#".repeat(r);return e.content?`${s} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>I(R({},e),{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>an({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),Ho=F.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",H(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!Cs(t,t.schema.nodes[this.name]))return!1;const{selection:n}=t,{$to:r}=n,s=e();return Ar(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:o,tr:i,dispatch:l})=>{if(l){const{$to:a}=i.selection,c=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?i.setSelection(q.create(i.doc,a.pos+1)):a.nodeAfter.isBlock?i.setSelection(Gt.create(i.doc,a.pos)):i.setSelection(q.create(i.doc,a.pos));else{const d=o.schema.nodes[this.options.nextNodeType]||a.parent.type.contentMatch.defaultType,u=d==null?void 0:d.create();u&&(i.insert(c,u),i.setSelection(q.create(i.doc,c+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Cr({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),No=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Oo=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Po=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,$o=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,zo=Le.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",H(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ie({find:No,type:this.type}),Ie({find:Po,type:this.type})]},addPasteRules(){return[xe({find:Oo,type:this.type}),xe({find:$o,type:this.type})]}});const Do="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Bo="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",pn="numeric",fn="ascii",hn="alpha",Ue="asciinumeric",We="alphanumeric",mn="domain",Rr="emoji",jo="scheme",_o="slashscheme",Qt="whitespace";function Fo(e,t){return e in t||(t[e]=[]),t[e]}function Ee(e,t,n){t[pn]&&(t[Ue]=!0,t[We]=!0),t[fn]&&(t[Ue]=!0,t[hn]=!0),t[Ue]&&(t[We]=!0),t[hn]&&(t[We]=!0),t[We]&&(t[mn]=!0),t[Rr]&&(t[mn]=!0);for(const r in t){const s=Fo(r,n);s.indexOf(e)<0&&s.push(e)}}function Wo(e,t){const n={};for(const r in t)t[r].indexOf(e)>=0&&(n[r]=!0);return n}function X(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}X.groups={};X.prototype={accepts(){return!!this.t},go(e){const t=this,n=t.j[e];if(n)return n;for(let r=0;r<t.jr.length;r++){const s=t.jr[r][0],o=t.jr[r][1];if(o&&s.test(e))return o}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,n,r){for(let s=0;s<e.length;s++)this.tt(e[s],t,n,r)},tr(e,t,n,r){r=r||X.groups;let s;return t&&t.j?s=t:(s=new X(t),n&&r&&Ee(t,n,r)),this.jr.push([e,s]),s},ts(e,t,n,r){let s=this;const o=e.length;if(!o)return s;for(let i=0;i<o-1;i++)s=s.tt(e[i]);return s.tt(e[o-1],t,n,r)},tt(e,t,n,r){r=r||X.groups;const s=this;if(t&&t.j)return s.j[e]=t,t;const o=t;let i,l=s.go(e);if(l?(i=new X,Object.assign(i.j,l.j),i.jr.push.apply(i.jr,l.jr),i.jd=l.jd,i.t=l.t):i=new X,o){if(r)if(i.t&&typeof i.t=="string"){const a=Object.assign(Wo(i.t,r),n);Ee(o,a,r)}else n&&Ee(o,n,r);i.t=o}return s.j[e]=i,i}};const L=(e,t,n,r,s)=>e.ta(t,n,r,s),$=(e,t,n,r,s)=>e.tr(t,n,r,s),Kn=(e,t,n,r,s)=>e.ts(t,n,r,s),b=(e,t,n,r,s)=>e.tt(t,n,r,s),me="WORD",gn="UWORD",Ir="ASCIINUMERICAL",Hr="ALPHANUMERICAL",Je="LOCALHOST",bn="TLD",yn="UTLD",ht="SCHEME",De="SLASH_SCHEME",Mn="NUM",vn="WS",En="NL",Ke="OPENBRACE",Ve="CLOSEBRACE",vt="OPENBRACKET",wt="CLOSEBRACKET",kt="OPENPAREN",Ct="CLOSEPAREN",At="OPENANGLEBRACKET",xt="CLOSEANGLEBRACKET",Tt="FULLWIDTHLEFTPAREN",Lt="FULLWIDTHRIGHTPAREN",St="LEFTCORNERBRACKET",Mt="RIGHTCORNERBRACKET",Et="LEFTWHITECORNERBRACKET",Rt="RIGHTWHITECORNERBRACKET",It="FULLWIDTHLESSTHAN",Ht="FULLWIDTHGREATERTHAN",Nt="AMPERSAND",Ot="APOSTROPHE",Pt="ASTERISK",we="AT",$t="BACKSLASH",zt="BACKTICK",Dt="CARET",Ce="COLON",Rn="COMMA",Bt="DOLLAR",le="DOT",jt="EQUALS",In="EXCLAMATION",ne="HYPHEN",Ge="PERCENT",_t="PIPE",Ft="PLUS",Wt="POUND",qe="QUERY",Hn="QUOTE",Nr="FULLWIDTHMIDDLEDOT",Nn="SEMI",ae="SLASH",Xe="TILDE",Ut="UNDERSCORE",Or="EMOJI",Kt="SYM";var Pr=Object.freeze({__proto__:null,ALPHANUMERICAL:Hr,AMPERSAND:Nt,APOSTROPHE:Ot,ASCIINUMERICAL:Ir,ASTERISK:Pt,AT:we,BACKSLASH:$t,BACKTICK:zt,CARET:Dt,CLOSEANGLEBRACKET:xt,CLOSEBRACE:Ve,CLOSEBRACKET:wt,CLOSEPAREN:Ct,COLON:Ce,COMMA:Rn,DOLLAR:Bt,DOT:le,EMOJI:Or,EQUALS:jt,EXCLAMATION:In,FULLWIDTHGREATERTHAN:Ht,FULLWIDTHLEFTPAREN:Tt,FULLWIDTHLESSTHAN:It,FULLWIDTHMIDDLEDOT:Nr,FULLWIDTHRIGHTPAREN:Lt,HYPHEN:ne,LEFTCORNERBRACKET:St,LEFTWHITECORNERBRACKET:Et,LOCALHOST:Je,NL:En,NUM:Mn,OPENANGLEBRACKET:At,OPENBRACE:Ke,OPENBRACKET:vt,OPENPAREN:kt,PERCENT:Ge,PIPE:_t,PLUS:Ft,POUND:Wt,QUERY:qe,QUOTE:Hn,RIGHTCORNERBRACKET:Mt,RIGHTWHITECORNERBRACKET:Rt,SCHEME:ht,SEMI:Nn,SLASH:ae,SLASH_SCHEME:De,SYM:Kt,TILDE:Xe,TLD:bn,UNDERSCORE:Ut,UTLD:yn,UWORD:gn,WORD:me,WS:vn});const fe=/[a-z]/,Fe=new RegExp("\\p{L}","u"),Zt=new RegExp("\\p{Emoji}","u"),he=/\d/,en=/\s/,Vn="\r",tn=`
`,Uo="️",Ko="‍",nn="￼";let rt=null,st=null;function Vo(e=[]){const t={};X.groups=t;const n=new X;rt==null&&(rt=Gn(Do)),st==null&&(st=Gn(Bo)),b(n,"'",Ot),b(n,"{",Ke),b(n,"}",Ve),b(n,"[",vt),b(n,"]",wt),b(n,"(",kt),b(n,")",Ct),b(n,"<",At),b(n,">",xt),b(n,"（",Tt),b(n,"）",Lt),b(n,"「",St),b(n,"」",Mt),b(n,"『",Et),b(n,"』",Rt),b(n,"＜",It),b(n,"＞",Ht),b(n,"&",Nt),b(n,"*",Pt),b(n,"@",we),b(n,"`",zt),b(n,"^",Dt),b(n,":",Ce),b(n,",",Rn),b(n,"$",Bt),b(n,".",le),b(n,"=",jt),b(n,"!",In),b(n,"-",ne),b(n,"%",Ge),b(n,"|",_t),b(n,"+",Ft),b(n,"#",Wt),b(n,"?",qe),b(n,'"',Hn),b(n,"/",ae),b(n,";",Nn),b(n,"~",Xe),b(n,"_",Ut),b(n,"\\",$t),b(n,"・",Nr);const r=$(n,he,Mn,{[pn]:!0});$(r,he,r);const s=$(r,fe,Ir,{[Ue]:!0}),o=$(r,Fe,Hr,{[We]:!0}),i=$(n,fe,me,{[fn]:!0});$(i,he,s),$(i,fe,i),$(s,he,s),$(s,fe,s);const l=$(n,Fe,gn,{[hn]:!0});$(l,fe),$(l,he,o),$(l,Fe,l),$(o,he,o),$(o,fe),$(o,Fe,o);const a=b(n,tn,En,{[Qt]:!0}),c=b(n,Vn,vn,{[Qt]:!0}),d=$(n,en,vn,{[Qt]:!0});b(n,nn,d),b(c,tn,a),b(c,nn,d),$(c,en,d),b(d,Vn),b(d,tn),$(d,en,d),b(d,nn,d);const u=$(n,Zt,Or,{[Rr]:!0});b(u,"#"),$(u,Zt,u),b(u,Uo,u);const p=b(u,Ko);b(p,"#"),$(p,Zt,u);const f=[[fe,i],[he,s]],h=[[fe,null],[Fe,l],[he,o]];for(let m=0;m<rt.length;m++)ve(n,rt[m],bn,me,f);for(let m=0;m<st.length;m++)ve(n,st[m],yn,gn,h);Ee(bn,{tld:!0,ascii:!0},t),Ee(yn,{utld:!0,alpha:!0},t),ve(n,"file",ht,me,f),ve(n,"mailto",ht,me,f),ve(n,"http",De,me,f),ve(n,"https",De,me,f),ve(n,"ftp",De,me,f),ve(n,"ftps",De,me,f),Ee(ht,{scheme:!0,ascii:!0},t),Ee(De,{slashscheme:!0,ascii:!0},t),e=e.sort((m,g)=>m[0]>g[0]?1:-1);for(let m=0;m<e.length;m++){const g=e[m][0],S=e[m][1]?{[jo]:!0}:{[_o]:!0};g.indexOf("-")>=0?S[mn]=!0:fe.test(g)?he.test(g)?S[Ue]=!0:S[fn]=!0:S[pn]=!0,Kn(n,g,g,S)}return Kn(n,"localhost",Je,{ascii:!0}),n.jd=new X(Kt),{start:n,tokens:Object.assign({groups:t},Pr)}}function $r(e,t){const n=Go(t.replace(/[A-Z]/g,l=>l.toLowerCase())),r=n.length,s=[];let o=0,i=0;for(;i<r;){let l=e,a=null,c=0,d=null,u=-1,p=-1;for(;i<r&&(a=l.go(n[i]));)l=a,l.accepts()?(u=0,p=0,d=l):u>=0&&(u+=n[i].length,p++),c+=n[i].length,o+=n[i].length,i++;o-=u,i-=p,c-=u,s.push({t:d.t,v:t.slice(o-c,o),s:o-c,e:o})}return s}function Go(e){const t=[],n=e.length;let r=0;for(;r<n;){let s=e.charCodeAt(r),o,i=s<55296||s>56319||r+1===n||(o=e.charCodeAt(r+1))<56320||o>57343?e[r]:e.slice(r,r+2);t.push(i),r+=i.length}return t}function ve(e,t,n,r,s){let o;const i=t.length;for(let l=0;l<i-1;l++){const a=t[l];e.j[a]?o=e.j[a]:(o=new X(r),o.jr=s.slice(),e.j[a]=o),e=o}return o=new X(n),o.jr=s.slice(),e.j[t[i-1]]=o,o}function Gn(e){const t=[],n=[];let r=0,s="0123456789";for(;r<e.length;){let o=0;for(;s.indexOf(e[r+o])>=0;)o++;if(o>0){t.push(n.join(""));for(let i=parseInt(e.substring(r,r+o),10);i>0;i--)n.pop();r+=o}else n.push(e[r]),r++}return t}const Ye={defaultProtocol:"http",events:null,format:qn,formatHref:qn,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function On(e,t=null){let n=Object.assign({},Ye);e&&(n=Object.assign(n,e instanceof On?e.o:e));const r=n.ignoreTags,s=[];for(let o=0;o<r.length;o++)s.push(r[o].toUpperCase());this.o=n,t&&(this.defaultRender=t),this.ignoreTags=s}On.prototype={o:Ye,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,n){const r=t!=null;let s=this.o[e];return s&&(typeof s=="object"?(s=n.t in s?s[n.t]:Ye[e],typeof s=="function"&&r&&(s=s(t,n))):typeof s=="function"&&r&&(s=s(t,n.t,n)),s)},getObj(e,t,n){let r=this.o[e];return typeof r=="function"&&t!=null&&(r=r(t,n.t,n)),r},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function qn(e){return e}function zr(e,t){this.t="token",this.v=e,this.tk=t}zr.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),n=e.get("truncate",t,this),r=e.get("format",t,this);return n&&r.length>n?r.substring(0,n)+"…":r},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=Ye.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,n=this.toHref(e.get("defaultProtocol")),r=e.get("formatHref",n,this),s=e.get("tagName",n,t),o=this.toFormattedString(e),i={},l=e.get("className",n,t),a=e.get("target",n,t),c=e.get("rel",n,t),d=e.getObj("attributes",n,t),u=e.getObj("events",n,t);return i.href=r,l&&(i.class=l),a&&(i.target=a),c&&(i.rel=c),d&&Object.assign(i,d),{tagName:s,attributes:i,content:o,eventListeners:u}}};function qt(e,t){class n extends zr{constructor(s,o){super(s,o),this.t=e}}for(const r in t)n.prototype[r]=t[r];return n.t=e,n}const Xn=qt("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Jn=qt("text"),qo=qt("nl"),ot=qt("url",{isLink:!0,toHref(e=Ye.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==Je&&e[1].t===Ce}}),te=e=>new X(e);function Xo({groups:e}){const t=e.domain.concat([Nt,Pt,we,$t,zt,Dt,Bt,jt,ne,Mn,Ge,_t,Ft,Wt,ae,Kt,Xe,Ut]),n=[Ot,Ce,Rn,le,In,Ge,qe,Hn,Nn,At,xt,Ke,Ve,wt,vt,kt,Ct,Tt,Lt,St,Mt,Et,Rt,It,Ht],r=[Nt,Ot,Pt,$t,zt,Dt,Bt,jt,ne,Ke,Ve,Ge,_t,Ft,Wt,qe,ae,Kt,Xe,Ut],s=te(),o=b(s,Xe);L(o,r,o),L(o,e.domain,o);const i=te(),l=te(),a=te();L(s,e.domain,i),L(s,e.scheme,l),L(s,e.slashscheme,a),L(i,r,o),L(i,e.domain,i);const c=b(i,we);b(o,we,c),b(l,we,c),b(a,we,c);const d=b(o,le);L(d,r,o),L(d,e.domain,o);const u=te();L(c,e.domain,u),L(u,e.domain,u);const p=b(u,le);L(p,e.domain,u);const f=te(Xn);L(p,e.tld,f),L(p,e.utld,f),b(c,Je,f);const h=b(u,ne);b(h,ne,h),L(h,e.domain,u),L(f,e.domain,u),b(f,le,p),b(f,ne,h);const m=b(f,Ce);L(m,e.numeric,Xn);const g=b(i,ne),v=b(i,le);b(g,ne,g),L(g,e.domain,i),L(v,r,o),L(v,e.domain,i);const S=te(ot);L(v,e.tld,S),L(v,e.utld,S),L(S,e.domain,i),L(S,r,o),b(S,le,v),b(S,ne,g),b(S,we,c);const P=b(S,Ce),B=te(ot);L(P,e.numeric,B);const w=te(ot),k=te();L(w,t,w),L(w,n,k),L(k,t,w),L(k,n,k),b(S,ae,w),b(B,ae,w);const M=b(l,Ce),G=b(a,Ce),pe=b(G,ae),T=b(pe,ae);L(l,e.domain,i),b(l,le,v),b(l,ne,g),L(a,e.domain,i),b(a,le,v),b(a,ne,g),L(M,e.domain,w),b(M,ae,w),b(M,qe,w),L(T,e.domain,w),L(T,t,w),b(T,ae,w);const y=[[Ke,Ve],[vt,wt],[kt,Ct],[At,xt],[Tt,Lt],[St,Mt],[Et,Rt],[It,Ht]];for(let A=0;A<y.length;A++){const[se,Se]=y[A],et=b(w,se);b(k,se,et),b(et,Se,w);const Pe=te(ot);L(et,t,Pe);const je=te();L(et,n),L(Pe,t,Pe),L(Pe,n,je),L(je,t,Pe),L(je,n,je),b(Pe,Se,w),b(je,Se,w)}return b(s,Je,S),b(s,En,qo),{start:s,tokens:Pr}}function Jo(e,t,n){let r=n.length,s=0,o=[],i=[];for(;s<r;){let l=e,a=null,c=null,d=0,u=null,p=-1;for(;s<r&&!(a=l.go(n[s].t));)i.push(n[s++]);for(;s<r&&(c=a||l.go(n[s].t));)a=null,l=c,l.accepts()?(p=0,u=l):p>=0&&p++,s++,d++;if(p<0)s-=d,s<r&&(i.push(n[s]),s++);else{i.length>0&&(o.push(rn(Jn,t,i)),i=[]),s-=p,d-=p;const f=u.t,h=n.slice(s-d,s);o.push(rn(f,t,h))}}return i.length>0&&o.push(rn(Jn,t,i)),o}function rn(e,t,n){const r=n[0].s,s=n[n.length-1].e,o=t.slice(r,s);return new e(o,n)}const Yo=typeof console!="undefined"&&console&&console.warn||(()=>{}),Qo="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",O={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Zo(){return X.groups={},O.scanner=null,O.parser=null,O.tokenQueue=[],O.pluginQueue=[],O.customSchemes=[],O.initialized=!1,O}function Yn(e,t=!1){if(O.initialized&&Yo(`linkifyjs: already initialized - will not register custom scheme "${e}" ${Qo}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);O.customSchemes.push([e,t])}function ei(){O.scanner=Vo(O.customSchemes);for(let e=0;e<O.tokenQueue.length;e++)O.tokenQueue[e][1]({scanner:O.scanner});O.parser=Xo(O.scanner.tokens);for(let e=0;e<O.pluginQueue.length;e++)O.pluginQueue[e][1]({scanner:O.scanner,parser:O.parser});return O.initialized=!0,O}function Pn(e){return O.initialized||ei(),Jo(O.parser.start,e,$r(O.scanner.start,e))}Pn.scan=$r;function Dr(e,t=null,n=null){if(t&&typeof t=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);n=t,t=null}const r=new On(n),s=Pn(e),o=[];for(let i=0;i<s.length;i++){const l=s[i];l.isLink&&(!t||l.t===t)&&r.check(l)&&o.push(l.toFormattedObject(r))}return o}var $n="[\0-   ᠎ -\u2029 　]",ti=new RegExp($n),ni=new RegExp(`${$n}$`),ri=new RegExp($n,"g");function si(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function oi(e){return new Y({key:new Q("autolink"),appendTransaction:(t,n,r)=>{const s=t.some(c=>c.docChanged)&&!n.doc.eq(r.doc),o=t.some(c=>c.getMeta("preventAutolink"));if(!s||o)return;const{tr:i}=r,l=As(n.doc,[...t]);if(xs(l).forEach(({newRange:c})=>{const d=Ts(r.doc,c,f=>f.isTextblock);let u,p;if(d.length>1)u=d[0],p=r.doc.textBetween(u.pos,u.pos+u.node.nodeSize,void 0," ");else if(d.length){const f=r.doc.textBetween(c.from,c.to," "," ");if(!ni.test(f))return;u=d[0],p=r.doc.textBetween(u.pos,c.to,void 0," ")}if(u&&p){const f=p.split(ti).filter(Boolean);if(f.length<=0)return!1;const h=f[f.length-1],m=u.pos+p.lastIndexOf(h);if(!h)return!1;const g=Pn(h).map(v=>v.toObject(e.defaultProtocol));if(!si(g))return!1;g.filter(v=>v.isLink).map(v=>I(R({},v),{from:m+v.start+1,to:m+v.end+1})).filter(v=>r.schema.marks.code?!r.doc.rangeHasMark(v.from,v.to,r.schema.marks.code):!0).filter(v=>e.validate(v.value)).filter(v=>e.shouldAutoLink(v.value)).forEach(v=>{Ls(v.from,v.to,r.doc).some(S=>S.mark.type===e.type)||i.addMark(v.from,v.to,e.type.create({href:v.href}))})}}),!!i.steps.length)return i}})}function ii(e){return new Y({key:new Q("handleClickLink"),props:{handleClick:(t,n,r)=>{var s,o;if(r.button!==0||!t.editable)return!1;let i=null;if(r.target instanceof HTMLAnchorElement)i=r.target;else{const a=r.target;if(!a)return!1;const c=e.editor.view.dom;i=a.closest("a"),i&&!c.contains(i)&&(i=null)}if(!i)return!1;let l=!1;if(e.enableClickSelection&&(l=e.editor.commands.extendMarkRange(e.type.name)),e.openOnClick){const a=Ss(t.state,e.type.name),c=(s=i.href)!=null?s:a.href,d=(o=i.target)!=null?o:a.target;c&&(window.open(c,d),l=!0)}return l}}})}function li(e){return new Y({key:new Q("handlePasteLink"),props:{handlePaste:(t,n,r)=>{const{shouldAutoLink:s}=e,{state:o}=t,{selection:i}=o,{empty:l}=i;if(l)return!1;let a="";r.content.forEach(d=>{a+=d.textContent});const c=Dr(a,{defaultProtocol:e.defaultProtocol}).find(d=>d.isLink&&d.value===a);return!a||!c||s!==void 0&&!s(c.value)?!1:e.editor.commands.setMark(e.type,{href:c.href})}}})}function Me(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!e||e.replace(ri,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var Br=Le.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){Yn(e);return}Yn(e.scheme,e.optionalSlashes)})},onDestroy(){Zo()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!Me(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>{const t=/^[a-z][a-z0-9+.-]*:\/\//i.test(e),n=/^[a-z][a-z0-9+.-]*:/i.test(e);if(t||n&&!e.includes("@"))return!0;const s=(e.includes("@")?e.split("@").pop():e).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(s)||!/\./.test(s))}}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:n=>!!Me(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!Me(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",H(this.options.HTMLAttributes,e),0]:["a",H(this.options.HTMLAttributes,I(R({},e),{href:""})),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var n,r,s,o;const i=(r=(n=e.attrs)==null?void 0:n.href)!=null?r:"",l=(o=(s=e.attrs)==null?void 0:s.title)!=null?o:"",a=t.renderChildren(e);return l?`[${a}](${i} "${l}")`:`[${a}](${i})`},addCommands(){return{setLink:e=>({chain:t})=>{const{href:n}=e;return this.options.isAllowedUri(n,{defaultValidate:r=>!!Me(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{const{href:n}=e||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!Me(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[xe({find:e=>{const t=[];if(e){const{protocols:n,defaultProtocol:r}=this.options,s=Dr(e).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:i=>!!Me(i,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(o=>{this.options.shouldAutoLink(o.value)&&t.push({text:o.value,data:{href:o.href},index:o.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;return this.options.autolink&&e.push(oi({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!Me(s,t),protocols:t,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),e.push(ii({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(li({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),ai=Object.defineProperty,ci=(e,t)=>{for(var n in t)ai(e,n,{get:t[n],enumerable:!0})},ui="listItem",Qn="textStyle",Zn=/^\s*([-+*])\s$/,jr=F.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",H(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ui,this.editor.getAttributes(Qn)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=Be({find:Zn,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Be({find:Zn,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Qn),editor:this.editor})),[e]}}),_r=F.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",H(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let n=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(s=>s.type==="paragraph"))n=t.parseChildren(e.tokens);else{const s=e.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(n=[{type:"paragraph",content:t.parseInline(s.tokens)}],e.tokens.length>1){const i=e.tokens.slice(1),l=t.parseChildren(i);n.push(...l)}}else n=t.parseChildren(e.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(e,t,n)=>xr(e,t,r=>{var s,o;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((o=(s=r.meta)==null?void 0:s.parentAttrs)==null?void 0:o.start)||1)+r.index}. `:"- "},n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),di={};ci(di,{findListItemPos:()=>Ze,getNextListDepth:()=>zn,handleBackspace:()=>wn,handleDelete:()=>kn,hasListBefore:()=>Fr,hasListItemAfter:()=>pi,hasListItemBefore:()=>Wr,listItemHasSubList:()=>Ur,nextListIsDeeper:()=>Kr,nextListIsHigher:()=>Vr});var Ze=(e,t)=>{const{$from:n}=t.selection,r=Tr(e,t.schema);let s=null,o=n.depth,i=n.pos,l=null;for(;o>0&&l===null;)s=n.node(o),s.type===r?l=o:(o-=1,i-=1);return l===null?null:{$pos:t.doc.resolve(i),depth:l}},zn=(e,t)=>{const n=Ze(e,t);if(!n)return!1;const[,r]=Rs(t,e,n.$pos.pos+4);return r},Fr=(e,t,n)=>{const{$anchor:r}=e.selection,s=Math.max(0,r.pos-2),o=e.doc.resolve(s).node();return!(!o||!n.includes(o.type.name))},Wr=(e,t)=>{var n;const{$anchor:r}=t.selection,s=t.doc.resolve(r.pos-2);return!(s.index()===0||((n=s.nodeBefore)==null?void 0:n.type.name)!==e)},Ur=(e,t,n)=>{if(!n)return!1;const r=Tr(e,t.schema);let s=!1;return n.descendants(o=>{o.type===r&&(s=!0)}),s},wn=(e,t,n)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!cn(e.state,t)&&Fr(e.state,t,n)){const{$anchor:l}=e.state.selection,a=e.state.doc.resolve(l.before()-1),c=[];a.node().descendants((p,f)=>{p.type.name===t&&c.push({node:p,pos:f})});const d=c.at(-1);if(!d)return!1;const u=e.state.doc.resolve(a.start()+d.pos+1);return e.chain().cut({from:l.start()-1,to:l.end()+1},u.end()).joinForward().run()}if(!cn(e.state,t)||!Ms(e.state))return!1;const r=Ze(t,e.state);if(!r)return!1;const o=e.state.doc.resolve(r.$pos.pos-2).node(r.depth),i=Ur(t,e.state,o);return Wr(t,e.state)&&!i?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},Kr=(e,t)=>{const n=zn(e,t),r=Ze(e,t);return!r||!n?!1:n>r.depth},Vr=(e,t)=>{const n=zn(e,t),r=Ze(e,t);return!r||!n?!1:n<r.depth},kn=(e,t)=>{if(!cn(e.state,t)||!Es(e.state,t))return!1;const{selection:n}=e.state,{$from:r,$to:s}=n;return!n.empty&&r.sameParent(s)?!1:Kr(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():Vr(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},pi=(e,t)=>{var n;const{$anchor:r}=t.selection,s=t.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((n=s.nodeAfter)==null?void 0:n.type.name)!==e)},Gr=j.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n})=>{e.state.schema.nodes[n]!==void 0&&kn(e,n)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n})=>{e.state.schema.nodes[n]!==void 0&&kn(e,n)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{e.state.schema.nodes[n]!==void 0&&wn(e,n,r)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{e.state.schema.nodes[n]!==void 0&&wn(e,n,r)&&(t=!0)}),t}}}}),er=/^(\s*)(\d+)\.\s+(.*)$/,fi=/^\s/;function hi(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n],o=s.match(er);if(!o)break;const[,i,l,a]=o,c=i.length;let d=a,u=n+1;const p=[s];for(;u<e.length;){const f=e[u];if(f.match(er))break;if(f.trim()==="")p.push(f),d+=`
`,u+=1;else if(f.match(fi))p.push(f),d+=`
${f.slice(c+2)}`,u+=1;else break}t.push({indent:c,number:parseInt(l,10),content:d.trim(),raw:p.join(`
`)}),r=u,n=u}return[t,r]}function qr(e,t,n){var r;const s=[];let o=0;for(;o<e.length;){const i=e[o];if(i.indent===t){const l=i.content.split(`
`),a=((r=l[0])==null?void 0:r.trim())||"",c=[];a&&c.push({type:"paragraph",raw:a,tokens:n.inlineTokens(a)});const d=l.slice(1).join(`
`).trim();if(d){const f=n.blockTokens(d);c.push(...f)}let u=o+1;const p=[];for(;u<e.length&&e[u].indent>t;)p.push(e[u]),u+=1;if(p.length>0){const f=Math.min(...p.map(m=>m.indent)),h=qr(p,f,n);c.push({type:"list",ordered:!0,start:p[0].number,items:h,raw:p.map(m=>m.raw).join(`
`)})}s.push({type:"list_item",raw:i.raw,tokens:c}),o=u}else o+=1}return s}function mi(e,t){return e.map(n=>{if(n.type!=="list_item")return t.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")r.push(...t.parseChildren([s]));else if(s.type==="text"&&s.tokens){const o=t.parseChildren([s]);r.push({type:"paragraph",content:o})}else{const o=t.parseChildren([s]);o.length>0&&r.push(...o)}}),{type:"listItem",content:r}})}var gi="listItem",tr="textStyle",nr=/^(\d+)\.\s$/,Xr=F.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const r=e,{start:t}=r,n=Jt(r,["start"]);return t===1?["ol",H(this.options.HTMLAttributes,n),0]:["ol",H(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];const n=e.start||1,r=e.items?mi(e.items,t):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{const t=e.match(/^(\s*)(\d+)\.\s+/),n=t==null?void 0:t.index;return n!==void 0?n:-1},tokenize:(e,t,n)=>{var r;const s=e.split(`
`),[o,i]=hi(s);if(o.length===0)return;const l=qr(o,0,n);return l.length===0?void 0:{type:"list",ordered:!0,start:((r=o[0])==null?void 0:r.number)||1,items:l,raw:s.slice(0,i).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(gi,this.editor.getAttributes(tr)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=Be({find:nr,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Be({find:nr,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>R({start:+t[1]},this.editor.getAttributes(tr)),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),bi=/^\s*(\[([( |x])?\])\s$/,yi=F.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",H(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{const n=[];if(e.tokens&&e.tokens.length>0?n.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?n.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):n.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){const r=t.parseChildren(e.nestedTokens);n.push(...r)}return t.createNode("taskItem",{checked:e.checked||!1},n)},renderMarkdown:(e,t)=>{var n;const s=`- [${(n=e.attrs)!=null&&n.checked?"x":" "}] `;return xr(e,t,s)},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?I(R({},e),{Tab:()=>this.editor.commands.sinkListItem(this.name)}):e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:n,editor:r})=>{const s=document.createElement("li"),o=document.createElement("label"),i=document.createElement("span"),l=document.createElement("input"),a=document.createElement("div"),c=u=>{var p,f;l.ariaLabel=((f=(p=this.options.a11y)==null?void 0:p.checkboxLabel)==null?void 0:f.call(p,u,l.checked))||`Task item checkbox for ${u.textContent||"empty task item"}`};c(e),o.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",u=>u.preventDefault()),l.addEventListener("change",u=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:p}=u.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:f})=>{const h=n();if(typeof h!="number")return!1;const m=f.doc.nodeAt(h);return f.setNodeMarkup(h,void 0,I(R({},m==null?void 0:m.attrs),{checked:p})),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,p)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([u,p])=>{s.setAttribute(u,p)}),s.dataset.checked=e.attrs.checked,l.checked=e.attrs.checked,o.append(l,i),s.append(o,a),Object.entries(t).forEach(([u,p])=>{s.setAttribute(u,p)});let d=new Set(Object.keys(t));return{dom:s,contentDOM:a,update:u=>{if(u.type!==this.type)return!1;s.dataset.checked=u.attrs.checked,l.checked=u.attrs.checked,c(u);const p=r.extensionManager.attributes,f=Is(u,p),h=new Set(Object.keys(f)),m=this.options.HTMLAttributes;return d.forEach(g=>{h.has(g)||(g in m?s.setAttribute(g,m[g]):s.removeAttribute(g))}),Object.entries(f).forEach(([g,v])=>{v==null?g in m?s.setAttribute(g,m[g]):s.removeAttribute(g):s.setAttribute(g,v)}),d=h,!0}}}},addInputRules(){return[Be({find:bi,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),vi=F.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",H(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;const n=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return n!==void 0?n:-1},tokenize(e,t,n){const r=o=>{const i=Wn(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,a)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:n.inlineTokens(l.mainContent),nestedTokens:a}),customNestedParser:r},n);return i?[{type:"taskList",raw:i.raw,items:i.items}]:n.blockTokens(o)},s=Wn(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,i)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:n.inlineTokens(o.mainContent),nestedTokens:i}),customNestedParser:r},n);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});j.create({name:"listKit",addExtensions(){const e=[];return this.options.bulletList!==!1&&e.push(jr.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(_r.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(Gr.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(Xr.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(yi.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(vi.configure(this.options.taskList)),e}});var rr="&nbsp;",wi=" ",ki=F.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",H(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{const n=e.tokens||[];if(n.length===1&&n[0].type==="image")return t.parseChildren([n[0]]);const r=t.parseInline(n);return r.length===1&&r[0].type==="text"&&(r[0].text===rr||r[0].text===wi)?t.createNode("paragraph",void 0,[]):t.createNode("paragraph",void 0,r)},renderMarkdown:(e,t)=>{if(!e)return"";const n=Array.isArray(e.content)?e.content:[];return n.length===0?rr:t.renderChildren(n)},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Ci=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Ai=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,xi=Le.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",H(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ie({find:Ci,type:this.type})]},addPasteRules(){return[xe({find:Ai,type:this.type})]}}),Ti=F.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),Jr=Le.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",H(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,n){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!s)return;const o=s[2].trim();return{type:"underline",raw:s[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function Li(e={}){return new Y({view(t){return new Si(t,e)}})}class Si{constructor(t,n){var r;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let o=i=>{this[s](i)};return t.dom.addEventListener(s,o),{name:s,handler:o}})}destroy(){this.handlers.forEach(({name:t,handler:n})=>this.editorView.dom.removeEventListener(t,n))}update(t,n){this.cursorPos!=null&&n.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,r,s=this.editorView.dom,o=s.getBoundingClientRect(),i=o.width/s.offsetWidth,l=o.height/s.offsetHeight;if(n){let u=t.nodeBefore,p=t.nodeAfter;if(u||p){let f=this.editorView.nodeDOM(this.cursorPos-(u?u.nodeSize:0));if(f){let h=f.getBoundingClientRect(),m=u?h.bottom:h.top;u&&p&&(m=(m+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let g=this.width/2*l;r={left:h.left,right:h.right,top:m-g,bottom:m+g}}}}if(!r){let u=this.editorView.coordsAtPos(this.cursorPos),p=this.width/2*i;r={left:u.left-p,right:u.left+p,top:u.top,bottom:u.bottom}}let a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let c,d;if(!a||a==document.body&&getComputedStyle(a).position=="static")c=-pageXOffset,d=-pageYOffset;else{let u=a.getBoundingClientRect(),p=u.width/a.offsetWidth,f=u.height/a.offsetHeight;c=u.left-a.scrollLeft*p,d=u.top-a.scrollTop*f}this.element.style.left=(r.left-c)/i+"px",this.element.style.top=(r.top-d)/l+"px",this.element.style.width=(r.right-r.left)/i+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,o=typeof s=="function"?s(this.editorView,n,t):s;if(n&&!o){let i=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=Hs(this.editorView.state.doc,i,this.editorView.dragging.slice);l!=null&&(i=l)}this.setCursor(i),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class z extends J{constructor(t){super(t,t)}map(t,n){let r=t.resolve(n.map(this.head));return z.valid(r)?new z(r):J.near(r)}content(){return ue.empty}eq(t){return t instanceof z&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new z(t.resolve(n.pos))}getBookmark(){return new Dn(this.anchor)}static valid(t){let n=t.parent;if(n.isTextblock||!Mi(t)||!Ei(t))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let s=n.contentMatchAt(t.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(t,n,r=!1){e:for(;;){if(!r&&z.valid(t))return t;let s=t.pos,o=null;for(let i=t.depth;;i--){let l=t.node(i);if(n>0?t.indexAfter(i)<l.childCount:t.index(i)>0){o=l.child(n>0?t.indexAfter(i):t.index(i)-1);break}else if(i==0)return null;s+=n;let a=t.doc.resolve(s);if(z.valid(a))return a}for(;;){let i=n>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!Gt.isSelectable(o)){t=t.doc.resolve(s+o.nodeSize*n),r=!1;continue e}break}o=i,s+=n;let l=t.doc.resolve(s);if(z.valid(l))return l}return null}}}z.prototype.visible=!1;z.findFrom=z.findGapCursorFrom;J.jsonID("gapcursor",z);class Dn{constructor(t){this.pos=t}map(t){return new Dn(t.map(this.pos))}resolve(t){let n=t.resolve(this.pos);return z.valid(n)?new z(n):J.near(n)}}function Yr(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function Mi(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||Yr(s.type))return!0;if(s.inlineContent)return!1}}return!0}function Ei(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||Yr(s.type))return!0;if(s.inlineContent)return!1}}return!0}function Ri(){return new Y({props:{decorations:Oi,createSelectionBetween(e,t,n){return t.pos==n.pos&&z.valid(n)?new z(n):null},handleClick:Hi,handleKeyDown:Ii,handleDOMEvents:{beforeinput:Ni}}})}const Ii=Lr({ArrowLeft:it("horiz",-1),ArrowRight:it("horiz",1),ArrowUp:it("vert",-1),ArrowDown:it("vert",1)});function it(e,t){const n=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(r,s,o){let i=r.selection,l=t>0?i.$to:i.$from,a=i.empty;if(i instanceof q){if(!o.endOfTextblock(n)||l.depth==0)return!1;a=!1,l=r.doc.resolve(t>0?l.after():l.before())}let c=z.findGapCursorFrom(l,t,a);return c?(s&&s(r.tr.setSelection(new z(c))),!0):!1}}function Hi(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!z.valid(r))return!1;let s=e.posAtCoords({left:n.clientX,top:n.clientY});return s&&s.inside>-1&&Gt.isSelectable(e.state.doc.nodeAt(s.inside))?!1:(e.dispatch(e.state.tr.setSelection(new z(r))),!0)}function Ni(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof z))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let s=re.empty;for(let i=r.length-1;i>=0;i--)s=re.from(r[i].createAndFill(null,s));let o=e.state.tr.replace(n.pos,n.pos,new ue(s,0,0));return o.setSelection(q.near(o.doc.resolve(n.pos+1))),e.dispatch(o),!1}function Oi(e){if(!(e.selection instanceof z))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Te.create(e.doc,[He.widget(e.selection.head,t,{key:"gapcursor"})])}var Vt=200,W=function(){};W.prototype.append=function(t){return t.length?(t=W.from(t),!this.length&&t||t.length<Vt&&this.leafAppend(t)||this.length<Vt&&t.leafPrepend(this)||this.appendInner(t)):this};W.prototype.prepend=function(t){return t.length?W.from(t).append(this):this};W.prototype.appendInner=function(t){return new Pi(this,t)};W.prototype.slice=function(t,n){return t===void 0&&(t=0),n===void 0&&(n=this.length),t>=n?W.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,n))};W.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};W.prototype.forEach=function(t,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(t,n,r,0):this.forEachInvertedInner(t,n,r,0)};W.prototype.map=function(t,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(o,i){return s.push(t(o,i))},n,r),s};W.from=function(t){return t instanceof W?t:t&&t.length?new Qr(t):W.empty};var Qr=function(e){function t(r){e.call(this),this.values=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(s,o){return s==0&&o==this.length?this:new t(this.values.slice(s,o))},t.prototype.getInner=function(s){return this.values[s]},t.prototype.forEachInner=function(s,o,i,l){for(var a=o;a<i;a++)if(s(this.values[a],l+a)===!1)return!1},t.prototype.forEachInvertedInner=function(s,o,i,l){for(var a=o-1;a>=i;a--)if(s(this.values[a],l+a)===!1)return!1},t.prototype.leafAppend=function(s){if(this.length+s.length<=Vt)return new t(this.values.concat(s.flatten()))},t.prototype.leafPrepend=function(s){if(this.length+s.length<=Vt)return new t(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(W);W.empty=new Qr([]);var Pi=function(e){function t(n,r){e.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,s,o,i){var l=this.left.length;if(s<l&&this.left.forEachInner(r,s,Math.min(o,l),i)===!1||o>l&&this.right.forEachInner(r,Math.max(s-l,0),Math.min(this.length,o)-l,i+l)===!1)return!1},t.prototype.forEachInvertedInner=function(r,s,o,i){var l=this.left.length;if(s>l&&this.right.forEachInvertedInner(r,s-l,Math.max(o,l)-l,i+l)===!1||o<l&&this.left.forEachInvertedInner(r,Math.min(s,l),o,i)===!1)return!1},t.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var o=this.left.length;return s<=o?this.left.slice(r,s):r>=o?this.right.slice(r-o,s-o):this.left.slice(r,o).append(this.right.slice(0,s-o))},t.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new t(this.left,s)},t.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new t(s,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t}(W);const $i=500;class oe{constructor(t,n){this.items=t,this.eventCount=n}popEvent(t,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,o;n&&(s=this.remapping(r,this.items.length),o=s.maps.length);let i=t.tr,l,a,c=[],d=[];return this.items.forEach((u,p)=>{if(!u.step){s||(s=this.remapping(r,p+1),o=s.maps.length),o--,d.push(u);return}if(s){d.push(new ce(u.map));let f=u.step.map(s.slice(o)),h;f&&i.maybeStep(f).doc&&(h=i.mapping.maps[i.mapping.maps.length-1],c.push(new ce(h,void 0,void 0,c.length+d.length))),o--,h&&s.appendMap(h,o)}else i.maybeStep(u.step);if(u.selection)return l=s?u.selection.map(s.slice(o)):u.selection,a=new oe(this.items.slice(0,r).append(d.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:i,selection:l}}addTransform(t,n,r,s){let o=[],i=this.eventCount,l=this.items,a=!s&&l.length?l.get(l.length-1):null;for(let d=0;d<t.steps.length;d++){let u=t.steps[d].invert(t.docs[d]),p=new ce(t.mapping.maps[d],u,n),f;(f=a&&a.merge(p))&&(p=f,d?o.pop():l=l.slice(0,l.length-1)),o.push(p),n&&(i++,n=void 0),s||(a=p)}let c=i-r.depth;return c>Di&&(l=zi(l,c),i-=c),new oe(l.append(o),i)}remapping(t,n){let r=new Ns;return this.items.forEach((s,o)=>{let i=s.mirrorOffset!=null&&o-s.mirrorOffset>=t?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,i)},t,n),r}addMaps(t){return this.eventCount==0?this:new oe(this.items.append(t.map(n=>new ce(n))),this.eventCount)}rebased(t,n){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-n),o=t.mapping,i=t.steps.length,l=this.eventCount;this.items.forEach(p=>{p.selection&&l--},s);let a=n;this.items.forEach(p=>{let f=o.getMirror(--a);if(f==null)return;i=Math.min(i,f);let h=o.maps[f];if(p.step){let m=t.steps[f].invert(t.docs[f]),g=p.selection&&p.selection.map(o.slice(a+1,f));g&&l++,r.push(new ce(h,m,g))}else r.push(new ce(h))},s);let c=[];for(let p=n;p<i;p++)c.push(new ce(o.maps[p]));let d=this.items.slice(0,s).append(c).append(r),u=new oe(d,l);return u.emptyItemCount()>$i&&(u=u.compress(this.items.length-r.length)),u}emptyItemCount(){let t=0;return this.items.forEach(n=>{n.step||t++}),t}compress(t=this.items.length){let n=this.remapping(0,t),r=n.maps.length,s=[],o=0;return this.items.forEach((i,l)=>{if(l>=t)s.push(i),i.selection&&o++;else if(i.step){let a=i.step.map(n.slice(r)),c=a&&a.getMap();if(r--,c&&n.appendMap(c,r),a){let d=i.selection&&i.selection.map(n.slice(r));d&&o++;let u=new ce(c.invert(),a,d),p,f=s.length-1;(p=s.length&&s[f].merge(u))?s[f]=p:s.push(u)}}else i.map&&r--},this.items.length,0),new oe(W.from(s.reverse()),o)}}oe.empty=new oe(W.empty,0);function zi(e,t){let n;return e.forEach((r,s)=>{if(r.selection&&t--==0)return n=s,!1}),e.slice(n)}class ce{constructor(t,n,r,s){this.map=t,this.step=n,this.selection=r,this.mirrorOffset=s}merge(t){if(this.step&&t.step&&!t.selection){let n=t.step.merge(this.step);if(n)return new ce(n.getMap().invert(),n,this.selection)}}}class ke{constructor(t,n,r,s,o){this.done=t,this.undone=n,this.prevRanges=r,this.prevTime=s,this.prevComposition=o}}const Di=20;function Bi(e,t,n,r){let s=n.getMeta(Re),o;if(s)return s.historyState;n.getMeta(Fi)&&(e=new ke(e.done,e.undone,null,0,-1));let i=n.getMeta("appendedTransaction");if(n.steps.length==0)return e;if(i&&i.getMeta(Re))return i.getMeta(Re).redo?new ke(e.done.addTransform(n,void 0,r,mt(t)),e.undone,sr(n.mapping.maps),e.prevTime,e.prevComposition):new ke(e.done,e.undone.addTransform(n,void 0,r,mt(t)),null,e.prevTime,e.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),a=e.prevTime==0||!i&&e.prevComposition!=l&&(e.prevTime<(n.time||0)-r.newGroupDelay||!ji(n,e.prevRanges)),c=i?sn(e.prevRanges,n.mapping):sr(n.mapping.maps);return new ke(e.done.addTransform(n,a?t.selection.getBookmark():void 0,r,mt(t)),oe.empty,c,n.time,l==null?e.prevComposition:l)}else return(o=n.getMeta("rebased"))?new ke(e.done.rebased(n,o),e.undone.rebased(n,o),sn(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new ke(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),sn(e.prevRanges,n.mapping),e.prevTime,e.prevComposition)}function ji(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((r,s)=>{for(let o=0;o<t.length;o+=2)r<=t[o+1]&&s>=t[o]&&(n=!0)}),n}function sr(e){let t=[];for(let n=e.length-1;n>=0&&t.length==0;n--)e[n].forEach((r,s,o,i)=>t.push(o,i));return t}function sn(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let s=t.map(e[r],1),o=t.map(e[r+1],-1);s<=o&&n.push(s,o)}return n}function _i(e,t,n){let r=mt(t),s=Re.get(t).spec.config,o=(n?e.undone:e.done).popEvent(t,r);if(!o)return null;let i=o.selection.resolve(o.transform.doc),l=(n?e.done:e.undone).addTransform(o.transform,t.selection.getBookmark(),s,r),a=new ke(n?l:o.remaining,n?o.remaining:l,null,0,-1);return o.transform.setSelection(i).setMeta(Re,{redo:n,historyState:a})}let on=!1,or=null;function mt(e){let t=e.plugins;if(or!=t){on=!1,or=t;for(let n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){on=!0;break}}return on}const Re=new Q("history"),Fi=new Q("closeHistory");function Wi(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Y({key:Re,state:{init(){return new ke(oe.empty,oe.empty,null,0,-1)},apply(t,n,r){return Bi(n,r,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,n){let r=n.inputType,s=r=="historyUndo"?es:r=="historyRedo"?ts:null;return!s||!t.editable?!1:(n.preventDefault(),s(t.state,t.dispatch))}}}})}function Zr(e,t){return(n,r)=>{let s=Re.getState(n);if(!s||(e?s.undone:s.done).eventCount==0)return!1;if(r){let o=_i(s,n,e);o&&r(t?o.scrollIntoView():o)}return!0}}const es=Zr(!1,!0),ts=Zr(!0,!0);j.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc;if(((e==null?void 0:e.mode)||this.options.mode)==="textSize"){const r=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(r)}return t.nodeSize},this.storage.words=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc,n=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let e=!1;return[new Y({key:new Q("characterCount"),appendTransaction:(t,n,r)=>{if(e)return;const s=this.options.limit;if(s==null||s===0){e=!0;return}const o=this.storage.characters({node:r.doc});if(o>s){const i=o-s,l=0,a=i;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const c=r.tr.deleteRange(l,a);return e=!0,c}e=!0},filterTransaction:(t,n)=>{const r=this.options.limit;if(!t.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:n.doc}),o=this.storage.characters({node:t.doc});if(o<=r||s>r&&o>r&&o<=s)return!0;if(s>r&&o>r&&o>s||!t.getMeta("paste"))return!1;const l=t.selection.$head.pos,a=o-r,c=l-a,d=l;return t.deleteRange(c,d),!(this.storage.characters({node:t.doc})>r)}})]}});var Ui=j.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Li(this.options)]}});j.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Y({key:new Q("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=t,o=[];if(!n||!r)return Te.create(e,[]);let i=0;this.options.mode==="deepest"&&e.descendants((a,c)=>{if(a.isText)return;if(!(s>=c&&s<=c+a.nodeSize-1))return!1;i+=1});let l=0;return e.descendants((a,c)=>{if(a.isText||!(s>=c&&s<=c+a.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&i-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";o.push(He.node(c,c+a.nodeSize,{class:this.options.className}))}),Te.create(e,o)}}})]}});var Ki=j.create({name:"gapCursor",addProseMirrorPlugins(){return[Ri()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=Sr(Mr(e,"allowGapCursor",n)))!=null?t:null}}}),ir="placeholder";function Vi(e){return e.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}j.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:ir,placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const e=this.options.dataAttribute?`data-${Vi(this.options.dataAttribute)}`:`data-${ir}`;return[new Y({key:new Q("placeholder"),props:{decorations:({doc:t,selection:n})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=n,o=[];if(!r)return null;const i=this.editor.isEmpty;return t.descendants((l,a)=>{const c=s>=a&&s<=a+l.nodeSize,d=!l.isLeaf&&Os(l);if((c||!this.options.showOnlyCurrent)&&d){const u=[this.options.emptyNodeClass];i&&u.push(this.options.emptyEditorClass);const p=He.node(a,a+l.nodeSize,{class:u.join(" "),[e]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:l,pos:a,hasAnchor:c}):this.options.placeholder});o.push(p)}return this.options.includeChildren}),Te.create(t,o)}}})]}});j.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new Y({key:new Q("selection"),props:{decorations(n){return n.selection.empty||e.isFocused||!e.isEditable||Ar(n.selection)||e.view.dragging?null:Te.create(n.doc,[He.inline(n.selection.from,n.selection.to,{class:t.className})])}}})]}});function lr({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||(t==null?void 0:t.type)===e}var Gi=j.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;const t=new Q(this.name),n=this.options.node||((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(n).includes(s.name));return[new Y({key:t,appendTransaction:(s,o,i)=>{const{doc:l,tr:a,schema:c}=i,d=t.getState(i),u=l.content.size,p=c.nodes[n];if(d)return a.insert(u,p.create())},state:{init:(s,o)=>{const i=o.tr.doc.lastChild;return!lr({node:i,types:r})},apply:(s,o)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return o;const i=s.doc.lastChild;return!lr({node:i,types:r})}}})]}}),qi=j.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>es(e,t),redo:()=>({state:e,dispatch:t})=>ts(e,t)}},addProseMirrorPlugins(){return[Wi(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Xi=j.create({name:"starterKit",addExtensions(){var e,t,n,r;const s=[];return this.options.bold!==!1&&s.push(Co.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(bo.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(jr.configure(this.options.bulletList)),this.options.code!==!1&&s.push(To.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(Mo.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(Eo.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(Ui.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(Ki.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(Ro.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(Io.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(qi.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(Ho.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(zo.configure(this.options.italic)),this.options.listItem!==!1&&s.push(_r.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(Gr.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&s.push(Br.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&s.push(Xr.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(ki.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(xi.configure(this.options.strike)),this.options.text!==!1&&s.push(Ti.configure(this.options.text)),this.options.underline!==!1&&s.push(Jr.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&s.push(Gi.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),Ji=Xi,Yi=20,ns=(e,t=0)=>{const n=[];return!e.children.length||t>Yi||Array.from(e.children).forEach(r=>{r.tagName==="SPAN"?n.push(r):r.children.length&&n.push(...ns(r,t+1))}),n},Qi=e=>{if(!e.children.length)return;const t=ns(e);t&&t.forEach(n=>{var r,s;const o=n.getAttribute("style"),i=(s=(r=n.parentElement)==null?void 0:r.closest("span"))==null?void 0:s.getAttribute("style");n.setAttribute("style",`${i};${o}`)})},rs=Le.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:e=>e.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&Qi(e),{}):!1}]},renderHTML({HTMLAttributes:e}){return["span",H(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleTextStyle:e=>({commands:t})=>t.toggleMark(this.name,e),removeEmptyTextStyle:()=>({tr:e})=>{const{selection:t}=e;return e.doc.nodesBetween(t.from,t.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(o=>!!o))||e.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),Zi=j.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:e=>{var t;const n=e.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const o=r[s].split(":");if(o.length>=2){const i=o[0].trim().toLowerCase(),l=o.slice(1).join(":").trim();if(i==="background-color")return l.replace(/['"]+/g,"")}}}return(t=e.style.backgroundColor)==null?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.backgroundColor?{style:`background-color: ${e.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:e=>({chain:t})=>t().setMark("textStyle",{backgroundColor:e}).run(),unsetBackgroundColor:()=>({chain:e})=>e().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),ss=j.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:e=>{var t;const n=e.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const o=r[s].split(":");if(o.length>=2){const i=o[0].trim().toLowerCase(),l=o.slice(1).join(":").trim();if(i==="color")return l.replace(/['"]+/g,"")}}}return(t=e.style.color)==null?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.color?{style:`color: ${e.color}`}:{}}}}]},addCommands(){return{setColor:e=>({chain:t})=>t().setMark("textStyle",{color:e}).run(),unsetColor:()=>({chain:e})=>e().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),os=j.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:e=>e.style.fontFamily,renderHTML:e=>e.fontFamily?{style:`font-family: ${e.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:e=>({chain:t})=>t().setMark("textStyle",{fontFamily:e}).run(),unsetFontFamily:()=>({chain:e})=>e().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),el=j.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:e=>e.style.fontSize,renderHTML:e=>e.fontSize?{style:`font-size: ${e.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:e=>({chain:t})=>t().setMark("textStyle",{fontSize:e}).run(),unsetFontSize:()=>({chain:e})=>e().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),tl=j.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:e=>e.style.lineHeight,renderHTML:e=>e.lineHeight?{style:`line-height: ${e.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:e=>({chain:t})=>t().setMark("textStyle",{lineHeight:e}).run(),unsetLineHeight:()=>({chain:e})=>e().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});j.create({name:"textStyleKit",addExtensions(){const e=[];return this.options.backgroundColor!==!1&&e.push(Zi.configure(this.options.backgroundColor)),this.options.color!==!1&&e.push(ss.configure(this.options.color)),this.options.fontFamily!==!1&&e.push(os.configure(this.options.fontFamily)),this.options.fontSize!==!1&&e.push(el.configure(this.options.fontSize)),this.options.lineHeight!==!1&&e.push(tl.configure(this.options.lineHeight)),this.options.textStyle!==!1&&e.push(rs.configure(this.options.textStyle)),e}});var nl=j.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>{const t=e.style.textAlign;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:e=>e.textAlign?{style:`text-align: ${e.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.map(n=>t.updateAttributes(n,{textAlign:e})).some(n=>n):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.map(t=>e.resetAttributes(t,"textAlign")).some(t=>t),toggleTextAlign:e=>({editor:t,commands:n})=>this.options.alignments.includes(e)?t.isActive({textAlign:e})?n.unsetTextAlign():n.setTextAlign(e):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),rl=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,sl=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,ol=Le.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:e=>e.getAttribute("data-color")||e.style.backgroundColor,renderHTML:e=>e.color?{"data-color":e.color,style:`background-color: ${e.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:e}){return["mark",H(this.options.HTMLAttributes,e),0]},renderMarkdown:(e,t)=>`==${t.renderChildren(e)}==`,parseMarkdown:(e,t)=>t.applyMark("highlight",t.parseInline(e.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:e=>e.indexOf("=="),tokenize(e,t,n){const s=/^(==)([^=]+)(==)/.exec(e);if(s){const o=s[2].trim(),i=n.inlineTokens(o);return{type:"highlight",raw:s[0],text:o,tokens:i}}}},addCommands(){return{setHighlight:e=>({commands:t})=>t.setMark(this.name,e),toggleHighlight:e=>({commands:t})=>t.toggleMark(this.name,e),unsetHighlight:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Ie({find:rl,type:this.type})]},addPasteRules(){return[xe({find:sl,type:this.type})]}}),il=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,ll=F.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",H(this.options.HTMLAttributes,e)]},parseMarkdown:(e,t)=>t.createNode("image",{src:e.href,title:e.title,alt:e.text}),renderMarkdown:e=>{var t,n,r,s,o,i;const l=(n=(t=e.attrs)==null?void 0:t.src)!=null?n:"",a=(s=(r=e.attrs)==null?void 0:r.alt)!=null?s:"",c=(i=(o=e.attrs)==null?void 0:o.title)!=null?i:"";return c?`![${a}](${l} "${c}")`:`![${a}](${l})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document=="undefined")return null;const{directions:e,minWidth:t,minHeight:n,alwaysPreserveAspectRatio:r}=this.options.resize;return({node:s,getPos:o,HTMLAttributes:i,editor:l})=>{const a=document.createElement("img");Object.entries(i).forEach(([u,p])=>{if(p!=null)switch(u){case"width":case"height":break;default:a.setAttribute(u,p);break}}),a.src=i.src;const c=new Ps({element:a,editor:l,node:s,getPos:o,onResize:(u,p)=>{a.style.width=`${u}px`,a.style.height=`${p}px`},onCommit:(u,p)=>{const f=o();f!==void 0&&this.editor.chain().setNodeSelection(f).updateAttributes(this.name,{width:u,height:p}).run()},onUpdate:(u,p,f)=>u.type===s.type,options:{directions:e,min:{width:t,height:n},preserveAspectRatio:r===!0}}),d=c.dom;return d.style.visibility="hidden",d.style.pointerEvents="none",a.onload=()=>{d.style.visibility="",d.style.pointerEvents=""},c}},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[Cr({find:il,type:this.type,getAttributes:e=>{const[,,t,n,r]=e;return{src:n,alt:t,title:r}}})]}});let Cn,An;if(typeof WeakMap!="undefined"){let e=new WeakMap;Cn=t=>e.get(t),An=(t,n)=>(e.set(t,n),n)}else{const e=[];let n=0;Cn=r=>{for(let s=0;s<e.length;s+=2)if(e[s]==r)return e[s+1]},An=(r,s)=>(n==10&&(n=0),e[n++]=r,e[n++]=s)}var D=class{constructor(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r}findCell(e){for(let t=0;t<this.map.length;t++){const n=this.map[t];if(n!=e)continue;const r=t%this.width,s=t/this.width|0;let o=r+1,i=s+1;for(let l=1;o<this.width&&this.map[t+l]==n;l++)o++;for(let l=1;i<this.height&&this.map[t+this.width*l]==n;l++)i++;return{left:r,top:s,right:o,bottom:i}}throw new RangeError(`No cell with offset ${e} found`)}colCount(e){for(let t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError(`No cell with offset ${e} found`)}nextCell(e,t,n){const{left:r,right:s,top:o,bottom:i}=this.findCell(e);return t=="horiz"?(n<0?r==0:s==this.width)?null:this.map[o*this.width+(n<0?r-1:s)]:(n<0?o==0:i==this.height)?null:this.map[r+this.width*(n<0?o-1:i)]}rectBetween(e,t){const{left:n,right:r,top:s,bottom:o}=this.findCell(e),{left:i,right:l,top:a,bottom:c}=this.findCell(t);return{left:Math.min(n,i),top:Math.min(s,a),right:Math.max(r,l),bottom:Math.max(o,c)}}cellsInRect(e){const t=[],n={};for(let r=e.top;r<e.bottom;r++)for(let s=e.left;s<e.right;s++){const o=r*this.width+s,i=this.map[o];n[i]||(n[i]=!0,!(s==e.left&&s&&this.map[o-1]==i||r==e.top&&r&&this.map[o-this.width]==i)&&t.push(i))}return t}positionAt(e,t,n){for(let r=0,s=0;;r++){const o=s+n.child(r).nodeSize;if(r==e){let i=t+e*this.width;const l=(e+1)*this.width;for(;i<l&&this.map[i]<s;)i++;return i==l?o-1:this.map[i]}s=o}}static get(e){return Cn(e)||An(e,al(e))}};function al(e){if(e.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+e.type.name);const t=cl(e),n=e.childCount,r=[];let s=0,o=null;const i=[];for(let c=0,d=t*n;c<d;c++)r[c]=0;for(let c=0,d=0;c<n;c++){const u=e.child(c);d++;for(let h=0;;h++){for(;s<r.length&&r[s]!=0;)s++;if(h==u.childCount)break;const m=u.child(h),{colspan:g,rowspan:v,colwidth:S}=m.attrs;for(let P=0;P<v;P++){if(P+c>=n){(o||(o=[])).push({type:"overlong_rowspan",pos:d,n:v-P});break}const B=s+P*t;for(let w=0;w<g;w++){r[B+w]==0?r[B+w]=d:(o||(o=[])).push({type:"collision",row:c,pos:d,n:g-w});const k=S&&S[w];if(k){const M=(B+w)%t*2,G=i[M];G==null||G!=k&&i[M+1]==1?(i[M]=k,i[M+1]=1):G==k&&i[M+1]++}}}s+=g,d+=m.nodeSize}const p=(c+1)*t;let f=0;for(;s<p;)r[s++]==0&&f++;f&&(o||(o=[])).push({type:"missing",row:c,n:f}),d++}(t===0||n===0)&&(o||(o=[])).push({type:"zero_sized"});const l=new D(t,n,r,o);let a=!1;for(let c=0;!a&&c<i.length;c+=2)i[c]!=null&&i[c+1]<n&&(a=!0);return a&&ul(l,i,e),l}function cl(e){let t=-1,n=!1;for(let r=0;r<e.childCount;r++){const s=e.child(r);let o=0;if(n)for(let i=0;i<r;i++){const l=e.child(i);for(let a=0;a<l.childCount;a++){const c=l.child(a);i+c.attrs.rowspan>r&&(o+=c.attrs.colspan)}}for(let i=0;i<s.childCount;i++){const l=s.child(i);o+=l.attrs.colspan,l.attrs.rowspan>1&&(n=!0)}t==-1?t=o:t!=o&&(t=Math.max(t,o))}return t}function ul(e,t,n){e.problems||(e.problems=[]);const r={};for(let s=0;s<e.map.length;s++){const o=e.map[s];if(r[o])continue;r[o]=!0;const i=n.nodeAt(o);if(!i)throw new RangeError(`No cell with offset ${o} found`);let l=null;const a=i.attrs;for(let c=0;c<a.colspan;c++){const d=t[(s+c)%e.width*2];d!=null&&(!a.colwidth||a.colwidth[c]!=d)&&((l||(l=dl(a)))[c]=d)}l&&e.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:l})}}function dl(e){if(e.colwidth)return e.colwidth.slice();const t=[];for(let n=0;n<e.colspan;n++)t.push(0);return t}function V(e){let t=e.cached.tableNodeTypes;if(!t){t=e.cached.tableNodeTypes={};for(const n in e.nodes){const r=e.nodes[n],s=r.spec.tableRole;s&&(t[s]=r)}}return t}const Ae=new Q("selectingCells");function Ne(e){for(let t=e.depth-1;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return e.node(0).resolve(e.before(t+1));return null}function pl(e){for(let t=e.depth;t>0;t--){const n=e.node(t).type.spec.tableRole;if(n==="cell"||n==="header_cell")return e.node(t)}return null}function ie(e){const t=e.selection.$head;for(let n=t.depth;n>0;n--)if(t.node(n).type.spec.tableRole=="row")return!0;return!1}function Xt(e){const t=e.selection;if("$anchorCell"in t&&t.$anchorCell)return t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell;if("node"in t&&t.node&&t.node.type.spec.tableRole=="cell")return t.$anchor;const n=Ne(t.$head)||fl(t.$head);if(n)return n;throw new RangeError(`No cell found around position ${t.head}`)}function fl(e){for(let t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){const r=t.type.spec.tableRole;if(r=="cell"||r=="header_cell")return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos;t;t=t.lastChild,n--){const r=t.type.spec.tableRole;if(r=="cell"||r=="header_cell")return e.doc.resolve(n-t.nodeSize)}}function xn(e){return e.parent.type.spec.tableRole=="row"&&!!e.nodeAfter}function hl(e){return e.node(0).resolve(e.pos+e.nodeAfter.nodeSize)}function Bn(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function is(e,t,n){const r=e.node(-1),s=D.get(r),o=e.start(-1),i=s.nextCell(e.pos-o,t,n);return i==null?null:e.node(0).resolve(o+i)}function Oe(e,t,n=1){const r=I(R({},e),{colspan:e.colspan-n});return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some(s=>s>0)||(r.colwidth=null)),r}function ls(e,t,n=1){const r=I(R({},e),{colspan:e.colspan+n});if(r.colwidth){r.colwidth=r.colwidth.slice();for(let s=0;s<n;s++)r.colwidth.splice(t,0,0)}return r}function ml(e,t,n){const r=V(t.type.schema).header_cell;for(let s=0;s<e.height;s++)if(t.nodeAt(e.map[n+s*e.width]).type!=r)return!1;return!0}var N=class ge extends J{constructor(t,n=t){const r=t.node(-1),s=D.get(r),o=t.start(-1),i=s.rectBetween(t.pos-o,n.pos-o),l=t.node(0),a=s.cellsInRect(i).filter(d=>d!=n.pos-o);a.unshift(n.pos-o);const c=a.map(d=>{const u=r.nodeAt(d);if(!u)throw new RangeError(`No cell with offset ${d} found`);const p=o+d+1;return new $s(l.resolve(p),l.resolve(p+u.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=t,this.$headCell=n}map(t,n){const r=t.resolve(n.map(this.$anchorCell.pos)),s=t.resolve(n.map(this.$headCell.pos));if(xn(r)&&xn(s)&&Bn(r,s)){const o=this.$anchorCell.node(-1)!=r.node(-1);return o&&this.isRowSelection()?ge.rowSelection(r,s):o&&this.isColSelection()?ge.colSelection(r,s):new ge(r,s)}return q.between(r,s)}content(){const t=this.$anchorCell.node(-1),n=D.get(t),r=this.$anchorCell.start(-1),s=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),o={},i=[];for(let a=s.top;a<s.bottom;a++){const c=[];for(let d=a*n.width+s.left,u=s.left;u<s.right;u++,d++){const p=n.map[d];if(o[p])continue;o[p]=!0;const f=n.findCell(p);let h=t.nodeAt(p);if(!h)throw new RangeError(`No cell with offset ${p} found`);const m=s.left-f.left,g=f.right-s.right;if(m>0||g>0){let v=h.attrs;if(m>0&&(v=Oe(v,0,m)),g>0&&(v=Oe(v,v.colspan-g,g)),f.left<s.left){if(h=h.type.createAndFill(v),!h)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(v)}`)}else h=h.type.create(v,h.content)}if(f.top<s.top||f.bottom>s.bottom){const v=I(R({},h.attrs),{rowspan:Math.min(f.bottom,s.bottom)-Math.max(f.top,s.top)});f.top<s.top?h=h.type.createAndFill(v):h=h.type.create(v,h.content)}c.push(h)}i.push(t.child(a).copy(re.from(c)))}const l=this.isColSelection()&&this.isRowSelection()?t:i;return new ue(re.from(l),1,1)}replace(t,n=ue.empty){const r=t.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){const{$from:l,$to:a}=s[i],c=t.mapping.slice(r);t.replace(c.map(l.pos),c.map(a.pos),i?ue.empty:n)}const o=J.findFrom(t.doc.resolve(t.mapping.slice(r).map(this.to)),-1);o&&t.setSelection(o)}replaceWith(t,n){this.replace(t,new ue(re.from(n),0,0))}forEachCell(t){const n=this.$anchorCell.node(-1),r=D.get(n),s=this.$anchorCell.start(-1),o=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-s,this.$headCell.pos-s));for(let i=0;i<o.length;i++)t(n.nodeAt(o[i]),s+o[i])}isColSelection(){const t=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(t,n)>0)return!1;const r=t+this.$anchorCell.nodeAfter.attrs.rowspan,s=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,s)==this.$headCell.node(-1).childCount}static colSelection(t,n=t){const r=t.node(-1),s=D.get(r),o=t.start(-1),i=s.findCell(t.pos-o),l=s.findCell(n.pos-o),a=t.node(0);return i.top<=l.top?(i.top>0&&(t=a.resolve(o+s.map[i.left])),l.bottom<s.height&&(n=a.resolve(o+s.map[s.width*(s.height-1)+l.right-1]))):(l.top>0&&(n=a.resolve(o+s.map[l.left])),i.bottom<s.height&&(t=a.resolve(o+s.map[s.width*(s.height-1)+i.right-1]))),new ge(t,n)}isRowSelection(){const t=this.$anchorCell.node(-1),n=D.get(t),r=this.$anchorCell.start(-1),s=n.colCount(this.$anchorCell.pos-r),o=n.colCount(this.$headCell.pos-r);if(Math.min(s,o)>0)return!1;const i=s+this.$anchorCell.nodeAfter.attrs.colspan,l=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(i,l)==n.width}eq(t){return t instanceof ge&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t,n=t){const r=t.node(-1),s=D.get(r),o=t.start(-1),i=s.findCell(t.pos-o),l=s.findCell(n.pos-o),a=t.node(0);return i.left<=l.left?(i.left>0&&(t=a.resolve(o+s.map[i.top*s.width])),l.right<s.width&&(n=a.resolve(o+s.map[s.width*(l.top+1)-1]))):(l.left>0&&(n=a.resolve(o+s.map[l.top*s.width])),i.right<s.width&&(t=a.resolve(o+s.map[s.width*(i.top+1)-1]))),new ge(t,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t,n){return new ge(t.resolve(n.anchor),t.resolve(n.head))}static create(t,n,r=n){return new ge(t.resolve(n),t.resolve(r))}getBookmark(){return new gl(this.$anchorCell.pos,this.$headCell.pos)}};N.prototype.visible=!1;J.jsonID("cell",N);var gl=class as{constructor(t,n){this.anchor=t,this.head=n}map(t){return new as(t.map(this.anchor),t.map(this.head))}resolve(t){const n=t.resolve(this.anchor),r=t.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&Bn(n,r)?new N(n,r):J.near(r,1)}};function bl(e){if(!(e.selection instanceof N))return null;const t=[];return e.selection.forEachCell((n,r)=>{t.push(He.node(r,r+n.nodeSize,{class:"selectedCell"}))}),Te.create(e.doc,t)}function yl({$from:e,$to:t}){if(e.pos==t.pos||e.pos<t.pos-6)return!1;let n=e.pos,r=t.pos,s=e.depth;for(;s>=0&&!(e.after(s+1)<e.end(s));s--,n++);for(let o=t.depth;o>=0&&!(t.before(o+1)>t.start(o));o--,r--);return n==r&&/row|table/.test(e.node(s).type.spec.tableRole)}function vl({$from:e,$to:t}){let n,r;for(let s=e.depth;s>0;s--){const o=e.node(s);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){n=o;break}}for(let s=t.depth;s>0;s--){const o=t.node(s);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){r=o;break}}return n!==r&&t.parentOffset===0}function wl(e,t,n){const r=(t||e).selection,s=(t||e).doc;let o,i;if(r instanceof Gt&&(i=r.node.type.spec.tableRole)){if(i=="cell"||i=="header_cell")o=N.create(s,r.from);else if(i=="row"){const l=s.resolve(r.from+1);o=N.rowSelection(l,l)}else if(!n){const l=D.get(r.node),a=r.from+1,c=a+l.map[l.width*l.height-1];o=N.create(s,a+1,c)}}else r instanceof q&&yl(r)?o=q.create(s,r.from):r instanceof q&&vl(r)&&(o=q.create(s,r.$from.start(),r.$from.end()));return o&&(t||(t=e.tr)).setSelection(o),t}const kl=new Q("fix-tables");function cs(e,t,n,r){const s=e.childCount,o=t.childCount;e:for(let i=0,l=0;i<o;i++){const a=t.child(i);for(let c=l,d=Math.min(s,i+3);c<d;c++)if(e.child(c)==a){l=c+1,n+=a.nodeSize;continue e}r(a,n),l<s&&e.child(l).sameMarkup(a)?cs(e.child(l),a,n+1,r):a.nodesBetween(0,a.content.size,r,n+1),n+=a.nodeSize}}function us(e,t){let n;const r=(s,o)=>{s.type.spec.tableRole=="table"&&(n=Cl(e,s,o,n))};return t?t.doc!=e.doc&&cs(t.doc,e.doc,0,r):e.doc.descendants(r),n}function Cl(e,t,n,r){const s=D.get(t);if(!s.problems)return r;r||(r=e.tr);const o=[];for(let a=0;a<s.height;a++)o.push(0);for(let a=0;a<s.problems.length;a++){const c=s.problems[a];if(c.type=="collision"){const d=t.nodeAt(c.pos);if(!d)continue;const u=d.attrs;for(let p=0;p<u.rowspan;p++)o[c.row+p]+=c.n;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,Oe(u,u.colspan-c.n,c.n))}else if(c.type=="missing")o[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const d=t.nodeAt(c.pos);if(!d)continue;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,I(R({},d.attrs),{rowspan:d.attrs.rowspan-c.n}))}else if(c.type=="colwidth mismatch"){const d=t.nodeAt(c.pos);if(!d)continue;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,I(R({},d.attrs),{colwidth:c.colwidth}))}else if(c.type=="zero_sized"){const d=r.mapping.map(n);r.delete(d,d+t.nodeSize)}}let i,l;for(let a=0;a<o.length;a++)o[a]&&(i==null&&(i=a),l=a);for(let a=0,c=n+1;a<s.height;a++){const d=t.child(a),u=c+d.nodeSize,p=o[a];if(p>0){let f="cell";d.firstChild&&(f=d.firstChild.type.spec.tableRole);const h=[];for(let g=0;g<p;g++){const v=V(e.schema)[f].createAndFill();v&&h.push(v)}const m=(a==0||i==a-1)&&l==a?c+1:u-1;r.insert(r.mapping.map(m),h)}c=u}return r.setMeta(kl,{fixTables:!0})}function de(e){const t=e.selection,n=Xt(e),r=n.node(-1),s=n.start(-1),o=D.get(r);return I(R({},t instanceof N?o.rectBetween(t.$anchorCell.pos-s,t.$headCell.pos-s):o.findCell(n.pos-s)),{tableStart:s,map:o,table:r})}function ds(e,{map:t,tableStart:n,table:r},s){let o=s>0?-1:0;ml(t,r,s+o)&&(o=s==0||s==t.width?null:0);for(let i=0;i<t.height;i++){const l=i*t.width+s;if(s>0&&s<t.width&&t.map[l-1]==t.map[l]){const a=t.map[l],c=r.nodeAt(a);e.setNodeMarkup(e.mapping.map(n+a),null,ls(c.attrs,s-t.colCount(a))),i+=c.attrs.rowspan-1}else{const a=o==null?V(r.type.schema).cell:r.nodeAt(t.map[l+o]).type,c=t.positionAt(i,s,r);e.insert(e.mapping.map(n+c),a.createAndFill())}}return e}function Al(e,t){if(!ie(e))return!1;if(t){const n=de(e);t(ds(e.tr,n,n.left))}return!0}function xl(e,t){if(!ie(e))return!1;if(t){const n=de(e);t(ds(e.tr,n,n.right))}return!0}function Tl(e,{map:t,table:n,tableStart:r},s){const o=e.mapping.maps.length;for(let i=0;i<t.height;){const l=i*t.width+s,a=t.map[l],c=n.nodeAt(a),d=c.attrs;if(s>0&&t.map[l-1]==a||s<t.width-1&&t.map[l+1]==a)e.setNodeMarkup(e.mapping.slice(o).map(r+a),null,Oe(d,s-t.colCount(a)));else{const u=e.mapping.slice(o).map(r+a);e.delete(u,u+c.nodeSize)}i+=d.rowspan}}function Ll(e,t){if(!ie(e))return!1;if(t){const n=de(e),r=e.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let s=n.right-1;Tl(r,n,s),s!=n.left;s--){const o=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!o)throw new RangeError("No table found");n.table=o,n.map=D.get(o)}t(r)}return!0}function Sl(e,t,n){var r;const s=V(t.type.schema).header_cell;for(let o=0;o<e.width;o++)if(((r=t.nodeAt(e.map[o+n*e.width]))===null||r===void 0?void 0:r.type)!=s)return!1;return!0}function ps(e,{map:t,tableStart:n,table:r},s){let o=n;for(let c=0;c<s;c++)o+=r.child(c).nodeSize;const i=[];let l=s>0?-1:0;Sl(t,r,s+l)&&(l=s==0||s==t.height?null:0);for(let c=0,d=t.width*s;c<t.width;c++,d++)if(s>0&&s<t.height&&t.map[d]==t.map[d-t.width]){const u=t.map[d],p=r.nodeAt(u).attrs;e.setNodeMarkup(n+u,null,I(R({},p),{rowspan:p.rowspan+1})),c+=p.colspan-1}else{var a;const u=l==null?V(r.type.schema).cell:(a=r.nodeAt(t.map[d+l*t.width]))===null||a===void 0?void 0:a.type,p=u==null?void 0:u.createAndFill();p&&i.push(p)}return e.insert(o,V(r.type.schema).row.create(null,i)),e}function Ml(e,t){if(!ie(e))return!1;if(t){const n=de(e);t(ps(e.tr,n,n.top))}return!0}function El(e,t){if(!ie(e))return!1;if(t){const n=de(e);t(ps(e.tr,n,n.bottom))}return!0}function Rl(e,{map:t,table:n,tableStart:r},s){let o=0;for(let c=0;c<s;c++)o+=n.child(c).nodeSize;const i=o+n.child(s).nodeSize,l=e.mapping.maps.length;e.delete(o+r,i+r);const a=new Set;for(let c=0,d=s*t.width;c<t.width;c++,d++){const u=t.map[d];if(!a.has(u)){if(a.add(u),s>0&&u==t.map[d-t.width]){const p=n.nodeAt(u).attrs;e.setNodeMarkup(e.mapping.slice(l).map(u+r),null,I(R({},p),{rowspan:p.rowspan-1})),c+=p.colspan-1}else if(s<t.height&&u==t.map[d+t.width]){const p=n.nodeAt(u),f=p.attrs,h=p.type.create(I(R({},f),{rowspan:p.attrs.rowspan-1}),p.content),m=t.positionAt(s+1,c,n);e.insert(e.mapping.slice(l).map(r+m),h),c+=f.colspan-1}}}}function Il(e,t){if(!ie(e))return!1;if(t){const n=de(e),r=e.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let s=n.bottom-1;Rl(r,n,s),s!=n.top;s--){const o=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc;if(!o)throw new RangeError("No table found");n.table=o,n.map=D.get(n.table)}t(r)}return!0}function ar(e){const t=e.content;return t.childCount==1&&t.child(0).isTextblock&&t.child(0).childCount==0}function Hl({width:e,height:t,map:n},r){let s=r.top*e+r.left,o=s,i=(r.bottom-1)*e+r.left,l=s+(r.right-r.left-1);for(let a=r.top;a<r.bottom;a++){if(r.left>0&&n[o]==n[o-1]||r.right<e&&n[l]==n[l+1])return!0;o+=e,l+=e}for(let a=r.left;a<r.right;a++){if(r.top>0&&n[s]==n[s-e]||r.bottom<t&&n[i]==n[i+e])return!0;s++,i++}return!1}function cr(e,t){const n=e.selection;if(!(n instanceof N)||n.$anchorCell.pos==n.$headCell.pos)return!1;const r=de(e),{map:s}=r;if(Hl(s,r))return!1;if(t){const o=e.tr,i={};let l=re.empty,a,c;for(let d=r.top;d<r.bottom;d++)for(let u=r.left;u<r.right;u++){const p=s.map[d*s.width+u],f=r.table.nodeAt(p);if(!(i[p]||!f))if(i[p]=!0,a==null)a=p,c=f;else{ar(f)||(l=l.append(f.content));const h=o.mapping.map(p+r.tableStart);o.delete(h,h+f.nodeSize)}}if(a==null||c==null)return!0;if(o.setNodeMarkup(a+r.tableStart,null,I(R({},ls(c.attrs,c.attrs.colspan,r.right-r.left-c.attrs.colspan)),{rowspan:r.bottom-r.top})),l.size>0){const d=a+1+c.content.size,u=ar(c)?a+1:d;o.replaceWith(u+r.tableStart,d+r.tableStart,l)}o.setSelection(new N(o.doc.resolve(a+r.tableStart))),t(o)}return!0}function ur(e,t){const n=V(e.schema);return Nl(({node:r})=>n[r.type.spec.tableRole])(e,t)}function Nl(e){return(t,n)=>{const r=t.selection;let s,o;if(r instanceof N){if(r.$anchorCell.pos!=r.$headCell.pos)return!1;s=r.$anchorCell.nodeAfter,o=r.$anchorCell.pos}else{var i;if(s=pl(r.$from),!s)return!1;o=(i=Ne(r.$from))===null||i===void 0?void 0:i.pos}if(s==null||o==null||s.attrs.colspan==1&&s.attrs.rowspan==1)return!1;if(n){let l=s.attrs;const a=[],c=l.colwidth;l.rowspan>1&&(l=I(R({},l),{rowspan:1})),l.colspan>1&&(l=I(R({},l),{colspan:1}));const d=de(t),u=t.tr;for(let f=0;f<d.right-d.left;f++)a.push(c?I(R({},l),{colwidth:c&&c[f]?[c[f]]:null}):l);let p;for(let f=d.top;f<d.bottom;f++){let h=d.map.positionAt(f,d.left,d.table);f==d.top&&(h+=s.nodeSize);for(let m=d.left,g=0;m<d.right;m++,g++)m==d.left&&f==d.top||u.insert(p=u.mapping.map(h+d.tableStart,1),e({node:s,row:f,col:m}).createAndFill(a[g]))}u.setNodeMarkup(o,e({node:s,row:d.top,col:d.left}),a[0]),r instanceof N&&u.setSelection(new N(u.doc.resolve(r.$anchorCell.pos),p?u.doc.resolve(p):void 0)),n(u)}return!0}}function Ol(e,t){return function(n,r){if(!ie(n))return!1;const s=Xt(n);if(s.nodeAfter.attrs[e]===t)return!1;if(r){const o=n.tr;n.selection instanceof N?n.selection.forEachCell((i,l)=>{i.attrs[e]!==t&&o.setNodeMarkup(l,null,I(R({},i.attrs),{[e]:t}))}):o.setNodeMarkup(s.pos,null,I(R({},s.nodeAfter.attrs),{[e]:t})),r(o)}return!0}}function Pl(e){return function(t,n){if(!ie(t))return!1;if(n){const r=V(t.schema),s=de(t),o=t.tr,i=s.map.cellsInRect(e=="column"?{left:s.left,top:0,right:s.right,bottom:s.map.height}:e=="row"?{left:0,top:s.top,right:s.map.width,bottom:s.bottom}:s),l=i.map(a=>s.table.nodeAt(a));for(let a=0;a<i.length;a++)l[a].type==r.header_cell&&o.setNodeMarkup(s.tableStart+i[a],r.cell,l[a].attrs);if(o.steps.length===0)for(let a=0;a<i.length;a++)o.setNodeMarkup(s.tableStart+i[a],r.header_cell,l[a].attrs);n(o)}return!0}}function dr(e,t,n){const r=t.map.cellsInRect({left:0,top:0,right:e=="row"?t.map.width:1,bottom:e=="column"?t.map.height:1});for(let s=0;s<r.length;s++){const o=t.table.nodeAt(r[s]);if(o&&o.type!==n.header_cell)return!1}return!0}function Qe(e,t){return t=t||{useDeprecatedLogic:!1},t.useDeprecatedLogic?Pl(e):function(n,r){if(!ie(n))return!1;if(r){const s=V(n.schema),o=de(n),i=n.tr,l=dr("row",o,s),a=dr("column",o,s),c=(e==="column"?l:e==="row"&&a)?1:0,d=e=="column"?{left:0,top:c,right:1,bottom:o.map.height}:e=="row"?{left:c,top:0,right:o.map.width,bottom:1}:o,u=e=="column"?a?s.cell:s.header_cell:e=="row"?l?s.cell:s.header_cell:s.cell;o.map.cellsInRect(d).forEach(p=>{const f=p+o.tableStart,h=i.doc.nodeAt(f);h&&i.setNodeMarkup(f,u,h.attrs)}),r(i)}return!0}}Qe("row",{useDeprecatedLogic:!0});Qe("column",{useDeprecatedLogic:!0});const $l=Qe("cell",{useDeprecatedLogic:!0});function zl(e,t){if(t<0){const n=e.nodeBefore;if(n)return e.pos-n.nodeSize;for(let r=e.index(-1)-1,s=e.before();r>=0;r--){const o=e.node(-1).child(r),i=o.lastChild;if(i)return s-1-i.nodeSize;s-=o.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;const n=e.node(-1);for(let r=e.indexAfter(-1),s=e.after();r<n.childCount;r++){const o=n.child(r);if(o.childCount)return s+1;s+=o.nodeSize}}return null}function pr(e){return function(t,n){if(!ie(t))return!1;const r=zl(Xt(t),e);if(r==null)return!1;if(n){const s=t.doc.resolve(r);n(t.tr.setSelection(q.between(s,hl(s))).scrollIntoView())}return!0}}function Dl(e,t){const n=e.selection.$anchor;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="table")return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}function lt(e,t){const n=e.selection;if(!(n instanceof N))return!1;if(t){const r=e.tr,s=V(e.schema).cell.createAndFill().content;n.forEachCell((o,i)=>{o.content.eq(s)||r.replace(r.mapping.map(i+1),r.mapping.map(i+o.nodeSize-1),new ue(s,0,0))}),r.docChanged&&t(r)}return!0}function Bl(e){if(e.size===0)return null;let{content:t,openStart:n,openEnd:r}=e;for(;t.childCount==1&&(n>0&&r>0||t.child(0).type.spec.tableRole=="table");)n--,r--,t=t.child(0).content;const s=t.child(0),o=s.type.spec.tableRole,i=s.type.schema,l=[];if(o=="row")for(let a=0;a<t.childCount;a++){let c=t.child(a).content;const d=a?0:Math.max(0,n-1),u=a<t.childCount-1?0:Math.max(0,r-1);(d||u)&&(c=Tn(V(i).row,new ue(c,d,u)).content),l.push(c)}else if(o=="cell"||o=="header_cell")l.push(n||r?Tn(V(i).row,new ue(t,n,r)).content:t);else return null;return jl(i,l)}function jl(e,t){const n=[];for(let s=0;s<t.length;s++){const o=t[s];for(let i=o.childCount-1;i>=0;i--){const{rowspan:l,colspan:a}=o.child(i).attrs;for(let c=s;c<s+l;c++)n[c]=(n[c]||0)+a}}let r=0;for(let s=0;s<n.length;s++)r=Math.max(r,n[s]);for(let s=0;s<n.length;s++)if(s>=t.length&&t.push(re.empty),n[s]<r){const o=V(e).cell.createAndFill(),i=[];for(let l=n[s];l<r;l++)i.push(o);t[s]=t[s].append(re.from(i))}return{height:t.length,width:r,rows:t}}function Tn(e,t){const n=e.createAndFill();return new zs(n).replace(0,n.content.size,t).doc}function _l({width:e,height:t,rows:n},r,s){if(e!=r){const o=[],i=[];for(let l=0;l<n.length;l++){const a=n[l],c=[];for(let d=o[l]||0,u=0;d<r;u++){let p=a.child(u%a.childCount);d+p.attrs.colspan>r&&(p=p.type.createChecked(Oe(p.attrs,p.attrs.colspan,d+p.attrs.colspan-r),p.content)),c.push(p),d+=p.attrs.colspan;for(let f=1;f<p.attrs.rowspan;f++)o[l+f]=(o[l+f]||0)+p.attrs.colspan}i.push(re.from(c))}n=i,e=r}if(t!=s){const o=[];for(let i=0,l=0;i<s;i++,l++){const a=[],c=n[l%t];for(let d=0;d<c.childCount;d++){let u=c.child(d);i+u.attrs.rowspan>s&&(u=u.type.create(I(R({},u.attrs),{rowspan:Math.max(1,s-u.attrs.rowspan)}),u.content)),a.push(u)}o.push(re.from(a))}n=o,t=s}return{width:e,height:t,rows:n}}function Fl(e,t,n,r,s,o,i){const l=e.doc.type.schema,a=V(l);let c,d;if(s>t.width)for(let u=0,p=0;u<t.height;u++){const f=n.child(u);p+=f.nodeSize;const h=[];let m;f.lastChild==null||f.lastChild.type==a.cell?m=c||(c=a.cell.createAndFill()):m=d||(d=a.header_cell.createAndFill());for(let g=t.width;g<s;g++)h.push(m);e.insert(e.mapping.slice(i).map(p-1+r),h)}if(o>t.height){const u=[];for(let h=0,m=(t.height-1)*t.width;h<Math.max(t.width,s);h++){const g=h>=t.width?!1:n.nodeAt(t.map[m+h]).type==a.header_cell;u.push(g?d||(d=a.header_cell.createAndFill()):c||(c=a.cell.createAndFill()))}const p=a.row.create(null,re.from(u)),f=[];for(let h=t.height;h<o;h++)f.push(p);e.insert(e.mapping.slice(i).map(r+n.nodeSize-2),f)}return!!(c||d)}function fr(e,t,n,r,s,o,i,l){if(i==0||i==t.height)return!1;let a=!1;for(let c=s;c<o;c++){const d=i*t.width+c,u=t.map[d];if(t.map[d-t.width]==u){a=!0;const p=n.nodeAt(u),{top:f,left:h}=t.findCell(u);e.setNodeMarkup(e.mapping.slice(l).map(u+r),null,I(R({},p.attrs),{rowspan:i-f})),e.insert(e.mapping.slice(l).map(t.positionAt(i,h,n)),p.type.createAndFill(I(R({},p.attrs),{rowspan:f+p.attrs.rowspan-i}))),c+=p.attrs.colspan-1}}return a}function hr(e,t,n,r,s,o,i,l){if(i==0||i==t.width)return!1;let a=!1;for(let c=s;c<o;c++){const d=c*t.width+i,u=t.map[d];if(t.map[d-1]==u){a=!0;const p=n.nodeAt(u),f=t.colCount(u),h=e.mapping.slice(l).map(u+r);e.setNodeMarkup(h,null,Oe(p.attrs,i-f,p.attrs.colspan-(i-f))),e.insert(h+p.nodeSize,p.type.createAndFill(Oe(p.attrs,0,i-f))),c+=p.attrs.rowspan-1}}return a}function mr(e,t,n,r,s){let o=n?e.doc.nodeAt(n-1):e.doc;if(!o)throw new Error("No table found");let i=D.get(o);const{top:l,left:a}=r,c=a+s.width,d=l+s.height,u=e.tr;let p=0;function f(){if(o=n?u.doc.nodeAt(n-1):u.doc,!o)throw new Error("No table found");i=D.get(o),p=u.mapping.maps.length}Fl(u,i,o,n,c,d,p)&&f(),fr(u,i,o,n,a,c,l,p)&&f(),fr(u,i,o,n,a,c,d,p)&&f(),hr(u,i,o,n,l,d,a,p)&&f(),hr(u,i,o,n,l,d,c,p)&&f();for(let h=l;h<d;h++){const m=i.positionAt(h,a,o),g=i.positionAt(h,c,o);u.replace(u.mapping.slice(p).map(m+n),u.mapping.slice(p).map(g+n),new ue(s.rows[h-l],0,0))}f(),u.setSelection(new N(u.doc.resolve(n+i.positionAt(l,a,o)),u.doc.resolve(n+i.positionAt(d-1,c-1,o)))),t(u)}const Wl=Lr({ArrowLeft:at("horiz",-1),ArrowRight:at("horiz",1),ArrowUp:at("vert",-1),ArrowDown:at("vert",1),"Shift-ArrowLeft":ct("horiz",-1),"Shift-ArrowRight":ct("horiz",1),"Shift-ArrowUp":ct("vert",-1),"Shift-ArrowDown":ct("vert",1),Backspace:lt,"Mod-Backspace":lt,Delete:lt,"Mod-Delete":lt});function gt(e,t,n){return n.eq(e.selection)?!1:(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function at(e,t){return(n,r,s)=>{if(!s)return!1;const o=n.selection;if(o instanceof N)return gt(n,r,J.near(o.$headCell,t));if(e!="horiz"&&!o.empty)return!1;const i=fs(s,e,t);if(i==null)return!1;if(e=="horiz")return gt(n,r,J.near(n.doc.resolve(o.head+t),t));{const l=n.doc.resolve(i),a=is(l,e,t);let c;return a?c=J.near(a,1):t<0?c=J.near(n.doc.resolve(l.before(-1)),-1):c=J.near(n.doc.resolve(l.after(-1)),1),gt(n,r,c)}}}function ct(e,t){return(n,r,s)=>{if(!s)return!1;const o=n.selection;let i;if(o instanceof N)i=o;else{const a=fs(s,e,t);if(a==null)return!1;i=new N(n.doc.resolve(a))}const l=is(i.$headCell,e,t);return l?gt(n,r,new N(i.$anchorCell,l)):!1}}function Ul(e,t){const n=e.state.doc,r=Ne(n.resolve(t));return r?(e.dispatch(e.state.tr.setSelection(new N(r))),!0):!1}function Kl(e,t,n){if(!ie(e.state))return!1;let r=Bl(n);const s=e.state.selection;if(s instanceof N){r||(r={width:1,height:1,rows:[re.from(Tn(V(e.state.schema).cell,n))]});const o=s.$anchorCell.node(-1),i=s.$anchorCell.start(-1),l=D.get(o).rectBetween(s.$anchorCell.pos-i,s.$headCell.pos-i);return r=_l(r,l.right-l.left,l.bottom-l.top),mr(e.state,e.dispatch,i,l,r),!0}else if(r){const o=Xt(e.state),i=o.start(-1);return mr(e.state,e.dispatch,i,D.get(o.node(-1)).findCell(o.pos-i),r),!0}else return!1}function Vl(e,t){var n;if(t.button!=0||t.ctrlKey||t.metaKey)return;const r=gr(e,t.target);let s;if(t.shiftKey&&e.state.selection instanceof N)o(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&r&&(s=Ne(e.state.selection.$anchor))!=null&&((n=ln(e,t))===null||n===void 0?void 0:n.pos)!=s.pos)o(s,t),t.preventDefault();else if(!r)return;function o(a,c){let d=ln(e,c);const u=Ae.getState(e.state)==null;if(!d||!Bn(a,d))if(u)d=a;else return;const p=new N(a,d);if(u||!e.state.selection.eq(p)){const f=e.state.tr.setSelection(p);u&&f.setMeta(Ae,a.pos),e.dispatch(f)}}function i(){e.root.removeEventListener("mouseup",i),e.root.removeEventListener("dragstart",i),e.root.removeEventListener("mousemove",l),Ae.getState(e.state)!=null&&e.dispatch(e.state.tr.setMeta(Ae,-1))}function l(a){const c=a,d=Ae.getState(e.state);let u;if(d!=null)u=e.state.doc.resolve(d);else if(gr(e,c.target)!=r&&(u=ln(e,t),!u))return i();u&&o(u,c)}e.root.addEventListener("mouseup",i),e.root.addEventListener("dragstart",i),e.root.addEventListener("mousemove",l)}function fs(e,t,n){if(!(e.state.selection instanceof q))return null;const{$head:r}=e.state.selection;for(let s=r.depth-1;s>=0;s--){const o=r.node(s);if((n<0?r.index(s):r.indexAfter(s))!=(n<0?0:o.childCount))return null;if(o.type.spec.tableRole=="cell"||o.type.spec.tableRole=="header_cell"){const i=r.before(s),l=t=="vert"?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(l)?i:null}}return null}function gr(e,t){for(;t&&t!=e.dom;t=t.parentNode)if(t.nodeName=="TD"||t.nodeName=="TH")return t;return null}function ln(e,t){const n=e.posAtCoords({left:t.clientX,top:t.clientY});if(!n)return null;let{inside:r,pos:s}=n;return r>=0&&Ne(e.state.doc.resolve(r))||Ne(e.state.doc.resolve(s))}var Gl=class{constructor(t,n){this.node=t,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${n}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Ln(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!=this.node.type?!1:(this.node=t,Ln(t,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(t){return t.type=="attributes"&&(t.target==this.table||this.colgroup.contains(t.target))}};function Ln(e,t,n,r,s,o){let i=0,l=!0,a=t.firstChild;const c=e.firstChild;if(c){for(let u=0,p=0;u<c.childCount;u++){const{colspan:f,colwidth:h}=c.child(u).attrs;for(let m=0;m<f;m++,p++){const g=s==p?o:h&&h[m],v=g?g+"px":"";if(i+=g||r,g||(l=!1),a)a.style.width!=v&&(a.style.width=v),a=a.nextSibling;else{const S=document.createElement("col");S.style.width=v,t.appendChild(S)}}}for(;a;){var d;const u=a.nextSibling;(d=a.parentNode)===null||d===void 0||d.removeChild(a),a=u}l?(n.style.width=i+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=i+"px")}}const ee=new Q("tableColumnResizing");function ql({handleWidth:e=5,cellMinWidth:t=25,defaultCellMinWidth:n=100,View:r=Gl,lastColumnResizable:s=!0}={}){const o=new Y({key:ee,state:{init(i,l){var a;const c=(a=o.spec)===null||a===void 0||(a=a.props)===null||a===void 0?void 0:a.nodeViews,d=V(l.schema).table.name;return r&&c&&(c[d]=(u,p)=>new r(u,n,p)),new Xl(-1,!1)},apply(i,l){return l.apply(i)}},props:{attributes:i=>{const l=ee.getState(i);return l&&l.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(i,l)=>{Jl(i,l,e,s)},mouseleave:i=>{Yl(i)},mousedown:(i,l)=>{Ql(i,l,t,n)}},decorations:i=>{const l=ee.getState(i);if(l&&l.activeHandle>-1)return ra(i,l.activeHandle)},nodeViews:{}}});return o}var Xl=class bt{constructor(t,n){this.activeHandle=t,this.dragging=n}apply(t){const n=this,r=t.getMeta(ee);if(r&&r.setHandle!=null)return new bt(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new bt(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&t.docChanged){let s=t.mapping.map(n.activeHandle,-1);return xn(t.doc.resolve(s))||(s=-1),new bt(s,n.dragging)}return n}};function Jl(e,t,n,r){if(!e.editable)return;const s=ee.getState(e.state);if(s&&!s.dragging){const o=ea(t.target);let i=-1;if(o){const{left:l,right:a}=o.getBoundingClientRect();t.clientX-l<=n?i=br(e,t,"left",n):a-t.clientX<=n&&(i=br(e,t,"right",n))}if(i!=s.activeHandle){if(!r&&i!==-1){const l=e.state.doc.resolve(i),a=l.node(-1),c=D.get(a),d=l.start(-1);if(c.colCount(l.pos-d)+l.nodeAfter.attrs.colspan-1==c.width-1)return}hs(e,i)}}}function Yl(e){if(!e.editable)return;const t=ee.getState(e.state);t&&t.activeHandle>-1&&!t.dragging&&hs(e,-1)}function Ql(e,t,n,r){var s;if(!e.editable)return!1;const o=(s=e.dom.ownerDocument.defaultView)!==null&&s!==void 0?s:window,i=ee.getState(e.state);if(!i||i.activeHandle==-1||i.dragging)return!1;const l=e.state.doc.nodeAt(i.activeHandle),a=Zl(e,i.activeHandle,l.attrs);e.dispatch(e.state.tr.setMeta(ee,{setDragging:{startX:t.clientX,startWidth:a}}));function c(u){o.removeEventListener("mouseup",c),o.removeEventListener("mousemove",d);const p=ee.getState(e.state);p!=null&&p.dragging&&(ta(e,p.activeHandle,yr(p.dragging,u,n)),e.dispatch(e.state.tr.setMeta(ee,{setDragging:null})))}function d(u){if(!u.which)return c(u);const p=ee.getState(e.state);if(p&&p.dragging){const f=yr(p.dragging,u,n);vr(e,p.activeHandle,f,r)}}return vr(e,i.activeHandle,a,r),o.addEventListener("mouseup",c),o.addEventListener("mousemove",d),t.preventDefault(),!0}function Zl(e,t,{colspan:n,colwidth:r}){const s=r&&r[r.length-1];if(s)return s;const o=e.domAtPos(t);let i=o.node.childNodes[o.offset].offsetWidth,l=n;if(r)for(let a=0;a<n;a++)r[a]&&(i-=r[a],l--);return i/l}function ea(e){for(;e&&e.nodeName!="TD"&&e.nodeName!="TH";)e=e.classList&&e.classList.contains("ProseMirror")?null:e.parentNode;return e}function br(e,t,n,r){const s=n=="right"?-r:r,o=e.posAtCoords({left:t.clientX+s,top:t.clientY});if(!o)return-1;const{pos:i}=o,l=Ne(e.state.doc.resolve(i));if(!l)return-1;if(n=="right")return l.pos;const a=D.get(l.node(-1)),c=l.start(-1),d=a.map.indexOf(l.pos-c);return d%a.width==0?-1:c+a.map[d-1]}function yr(e,t,n){const r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function hs(e,t){e.dispatch(e.state.tr.setMeta(ee,{setHandle:t}))}function ta(e,t,n){const r=e.state.doc.resolve(t),s=r.node(-1),o=D.get(s),i=r.start(-1),l=o.colCount(r.pos-i)+r.nodeAfter.attrs.colspan-1,a=e.state.tr;for(let c=0;c<o.height;c++){const d=c*o.width+l;if(c&&o.map[d]==o.map[d-o.width])continue;const u=o.map[d],p=s.nodeAt(u).attrs,f=p.colspan==1?0:l-o.colCount(u);if(p.colwidth&&p.colwidth[f]==n)continue;const h=p.colwidth?p.colwidth.slice():na(p.colspan);h[f]=n,a.setNodeMarkup(i+u,null,I(R({},p),{colwidth:h}))}a.docChanged&&e.dispatch(a)}function vr(e,t,n,r){const s=e.state.doc.resolve(t),o=s.node(-1),i=s.start(-1),l=D.get(o).colCount(s.pos-i)+s.nodeAfter.attrs.colspan-1;let a=e.domAtPos(s.start(-1)).node;for(;a&&a.nodeName!="TABLE";)a=a.parentNode;a&&Ln(o,a.firstChild,a,r,l,n)}function na(e){return Array(e).fill(0)}function ra(e,t){const n=[],r=e.doc.resolve(t),s=r.node(-1);if(!s)return Te.empty;const o=D.get(s),i=r.start(-1),l=o.colCount(r.pos-i)+r.nodeAfter.attrs.colspan-1;for(let c=0;c<o.height;c++){const d=l+c*o.width;if((l==o.width-1||o.map[d]!=o.map[d+1])&&(c==0||o.map[d]!=o.map[d-o.width])){var a;const u=o.map[d],p=i+u+s.nodeAt(u).nodeSize-1,f=document.createElement("div");f.className="column-resize-handle",!((a=ee.getState(e))===null||a===void 0)&&a.dragging&&n.push(He.node(i+u,i+u+s.nodeAt(u).nodeSize,{class:"column-resize-dragging"})),n.push(He.widget(p,f))}}return Te.create(e.doc,n)}function sa({allowTableNodeSelection:e=!1}={}){return new Y({key:Ae,state:{init(){return null},apply(t,n){const r=t.getMeta(Ae);if(r!=null)return r==-1?null:r;if(n==null||!t.docChanged)return n;const{deleted:s,pos:o}=t.mapping.mapResult(n);return s?null:o}},props:{decorations:bl,handleDOMEvents:{mousedown:Vl},createSelectionBetween(t){return Ae.getState(t.state)!=null?t.state.selection:null},handleTripleClick:Ul,handleKeyDown:Wl,handlePaste:Kl},appendTransaction(t,n,r){return wl(r,us(r,n),e)}})}var ms=F.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{var t,n;const r=e.getAttribute("colwidth"),s=r?r.split(",").map(o=>parseInt(o,10)):null;if(!s){const o=(t=e.closest("table"))==null?void 0:t.querySelectorAll("colgroup > col"),i=Array.from(((n=e.parentElement)==null?void 0:n.children)||[]).indexOf(e);if(i&&i>-1&&o&&o[i]){const l=o[i].getAttribute("width");return l?[parseInt(l,10)]:null}}return s}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",H(this.options.HTMLAttributes,e),0]}}),gs=F.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",H(this.options.HTMLAttributes,e),0]}}),bs=F.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",H(this.options.HTMLAttributes,e),0]}});function Sn(e,t){return t?["width",`${Math.max(t,e)}px`]:["min-width",`${e}px`]}function wr(e,t,n,r,s,o){var i;let l=0,a=!0,c=t.firstChild;const d=e.firstChild;if(d!==null)for(let p=0,f=0;p<d.childCount;p+=1){const{colspan:h,colwidth:m}=d.child(p).attrs;for(let g=0;g<h;g+=1,f+=1){const v=s===f?o:m&&m[g],S=v?`${v}px`:"";if(l+=v||r,v||(a=!1),c){if(c.style.width!==S){const[P,B]=Sn(r,v);c.style.setProperty(P,B)}c=c.nextSibling}else{const P=document.createElement("col"),[B,w]=Sn(r,v);P.style.setProperty(B,w),t.appendChild(P)}}}for(;c;){const p=c.nextSibling;(i=c.parentNode)==null||i.removeChild(c),c=p}const u=e.attrs.style&&typeof e.attrs.style=="string"&&/\bwidth\s*:/i.test(e.attrs.style);a&&!u?(n.style.width=`${l}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${l}px`)}var oa=class{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),e.attrs.style&&(this.table.style.cssText=e.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),wr(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!==this.node.type?!1:(this.node=e,wr(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){const t=e.target,n=this.dom.contains(t),r=this.contentDOM.contains(t);return!!(n&&!r&&(e.type==="attributes"||e.type==="childList"||e.type==="characterData"))}};function ia(e,t,n,r){let s=0,o=!0;const i=[],l=e.firstChild;if(!l)return{};for(let u=0,p=0;u<l.childCount;u+=1){const{colspan:f,colwidth:h}=l.child(u).attrs;for(let m=0;m<f;m+=1,p+=1){const g=n===p?r:h&&h[m];s+=g||t,g||(o=!1);const[v,S]=Sn(t,g);i.push(["col",{style:`${v}: ${S}`}])}}const a=o?`${s}px`:"",c=o?"":`${s}px`;return{colgroup:["colgroup",{},...i],tableWidth:a,tableMinWidth:c}}function kr(e,t){return e.createAndFill()}function la(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const r=e.nodes[n];r.spec.tableRole&&(t[r.spec.tableRole]=r)}),e.cached.tableNodeTypes=t,t}function aa(e,t,n,r,s){const o=la(e),i=[],l=[];for(let c=0;c<n;c+=1){const d=kr(o.cell);if(d&&l.push(d),r){const u=kr(o.header_cell);u&&i.push(u)}}const a=[];for(let c=0;c<t;c+=1)a.push(o.row.createChecked(null,r&&c===0?i:l));return o.table.createChecked(null,a)}function ca(e){return e instanceof N}var ut=({editor:e})=>{const{selection:t}=e.state;if(!ca(t))return!1;let n=0;const r=Ds(t.ranges[0].$from,o=>o.type.name==="table");return r==null||r.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(n+=1)}),n===t.ranges.length?(e.commands.deleteTable(),!0):!1},ua="";function da(e){return(e||"").replace(/\s+/g," ").trim()}function pa(e,t,n={}){var r;const s=(r=n.cellLineSeparator)!=null?r:ua;if(!e||!e.content||e.content.length===0)return"";const o=[];e.content.forEach(h=>{const m=[];h.content&&h.content.forEach(g=>{let v="";g.content&&Array.isArray(g.content)&&g.content.length>1?v=g.content.map(w=>t.renderChildren(w)).join(s):v=g.content?t.renderChildren(g.content):"";const S=da(v),P=g.type==="tableHeader";m.push({text:S,isHeader:P})}),o.push(m)});const i=o.reduce((h,m)=>Math.max(h,m.length),0);if(i===0)return"";const l=new Array(i).fill(0);o.forEach(h=>{var m;for(let g=0;g<i;g+=1){const S=(((m=h[g])==null?void 0:m.text)||"").length;S>l[g]&&(l[g]=S),l[g]<3&&(l[g]=3)}});const a=(h,m)=>h+" ".repeat(Math.max(0,m-h.length)),c=o[0],d=c.some(h=>h.isHeader);let u=`
`;const p=new Array(i).fill(0).map((h,m)=>d&&c[m]&&c[m].text||"");return u+=`| ${p.map((h,m)=>a(h,l[m])).join(" | ")} |
`,u+=`| ${l.map(h=>"-".repeat(Math.max(3,h))).join(" | ")} |
`,(d?o.slice(1):o).forEach(h=>{u+=`| ${new Array(i).fill(0).map((m,g)=>a(h[g]&&h[g].text||"",l[g])).join(" | ")} |
`}),u}var fa=pa,ys=F.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:oa,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:e,HTMLAttributes:t}){const{colgroup:n,tableWidth:r,tableMinWidth:s}=ia(e,this.options.cellMinWidth),o=t.style;function i(){return o||(r?`width: ${r}`:`min-width: ${s}`)}const l=["table",H(this.options.HTMLAttributes,t,{style:i()}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},l]:l},parseMarkdown:(e,t)=>{const n=[];if(e.header){const r=[];e.header.forEach(s=>{r.push(t.createNode("tableHeader",{},[{type:"paragraph",content:t.parseInline(s.tokens)}]))}),n.push(t.createNode("tableRow",{},r))}return e.rows&&e.rows.forEach(r=>{const s=[];r.forEach(o=>{s.push(t.createNode("tableCell",{},[{type:"paragraph",content:t.parseInline(o.tokens)}]))}),n.push(t.createNode("tableRow",{},s))}),t.createNode("table",void 0,n)},renderMarkdown:(e,t)=>fa(e,t),addCommands(){return{insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:s,editor:o})=>{const i=aa(o.schema,e,t,n);if(s){const l=r.selection.from+1;r.replaceSelectionWith(i).scrollIntoView().setSelection(q.near(r.doc.resolve(l)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>Al(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>xl(e,t),deleteColumn:()=>({state:e,dispatch:t})=>Ll(e,t),addRowBefore:()=>({state:e,dispatch:t})=>Ml(e,t),addRowAfter:()=>({state:e,dispatch:t})=>El(e,t),deleteRow:()=>({state:e,dispatch:t})=>Il(e,t),deleteTable:()=>({state:e,dispatch:t})=>Dl(e,t),mergeCells:()=>({state:e,dispatch:t})=>cr(e,t),splitCell:()=>({state:e,dispatch:t})=>ur(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>Qe("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>Qe("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>$l(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>cr(e,t)?!0:ur(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:r})=>Ol(e,t)(n,r),goToNextCell:()=>({state:e,dispatch:t})=>pr(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>pr(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&us(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){const r=N.create(t.doc,e.anchorCell,e.headCell);t.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:ut,"Mod-Backspace":ut,Delete:ut,"Mod-Delete":ut}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[ql({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],sa({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:Sr(Mr(e,"tableRole",t))}}});j.create({name:"tableKit",addExtensions(){const e=[];return this.options.table!==!1&&e.push(ys.configure(this.options.table)),this.options.tableCell!==!1&&e.push(ms.configure(this.options.tableCell)),this.options.tableHeader!==!1&&e.push(gs.configure(this.options.tableHeader)),this.options.tableRow!==!1&&e.push(bs.configure(this.options.tableRow)),e}});const ha=F.create({name:"variable",group:"inline",inline:!0,atom:!0,selectable:!0,draggable:!1,addAttributes(){return{name:{default:""}}},parseHTML(){return[{tag:"span[data-variable]",getAttrs:e=>({name:e.getAttribute("data-variable")})}]},renderHTML({node:e,HTMLAttributes:t}){return["span",H(t,{"data-variable":e.attrs.name,class:"variable-chip",contenteditable:"false"}),`{{${e.attrs.name}}}`]},addNodeView(){return({node:e})=>{const t=document.createElement("span");return t.className="variable-chip",t.setAttribute("data-variable",e.attrs.name),t.setAttribute("contenteditable","false"),t.textContent=`{{${e.attrs.name}}}`,{dom:t}}},addInputRules(){return[new Bs({find:/\{\{([a-zA-Z0-9_]+)\}\}(\s?)$/,handler:({state:e,range:t,match:n})=>{const r=n[1];if(!r)return null;const{tr:s}=e;return s.replaceWith(t.from,t.to,this.type.create({name:r})),s}})]},addCommands(){return{insertVariable:e=>({chain:t})=>t().insertContent({type:this.name,attrs:{name:e}}).run()}}}),ma=j.create({name:"fontSize",addGlobalAttributes(){return[{types:["textStyle"],attributes:{fontSize:{default:null,parseHTML:e=>{var t;return((t=e.style.fontSize)==null?void 0:t.replace("pt",""))||null},renderHTML:e=>e.fontSize?{style:`font-size: ${e.fontSize}pt`}:{}}}}]},addCommands(){return{setFontSize:e=>({chain:t})=>t().setMark("textStyle",{fontSize:String(e)}).run(),unsetFontSize:()=>({chain:e})=>e().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),ga=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},ba={class:"toolbar bg-white border-b border-gray-200 px-3 py-1.5 flex items-center flex-wrap gap-1 select-none"},ya={class:"toolbar-group"},va=["value"],wa=["value"],ka=["value"],Ca=["value"],Aa=["value"],xa={class:"relative",title:"Text color"},Ta={class:"flex flex-col items-center gap-0.5"},La={key:0,class:"color-picker-popup"},Sa={class:"grid grid-cols-8 gap-1 p-2"},Ma=["onClick"],Ea={class:"relative",title:"Highlight"},Ra={class:"flex flex-col items-center gap-0.5"},Ia={key:0,class:"color-picker-popup"},Ha={class:"grid grid-cols-5 gap-1 p-2"},Na=["onClick"],Oa={class:"relative"},Pa={class:"flex flex-wrap gap-1 mb-2"},$a=["onClick"],za={class:"flex gap-1"},Da={__name:"TemplateToolbar",props:{editor:{type:Object,required:!0},variables:{type:Array,default:()=>[]}},emits:["add-variable"],setup(e,{emit:t}){const n=so({props:{active:Boolean,disabled:Boolean,title:String},emits:["click"],setup(T,{slots:y,emit:A}){return()=>{var se;return oo("button",{title:T.title,disabled:T.disabled,onClick:Se=>{Se.preventDefault(),A("click")},class:["toolbar-btn",T.active?"toolbar-btn-active":"",T.disabled?"opacity-40 cursor-not-allowed":""].join(" ")},(se=y.default)==null?void 0:se.call(y))}}}),r=e,s=t,o=Z(!1),i=Z(!1),l=Z(!1),a=Z(""),c=Z("#000000"),d=Z("#fef08a"),u=[{label:"Arial",value:"Arial, sans-serif"},{label:"Times New Roman",value:"'Times New Roman', serif"},{label:"Calibri",value:"Calibri, sans-serif"},{label:"Georgia",value:"Georgia, serif"},{label:"Courier New",value:"'Courier New', monospace"},{label:"Helvetica",value:"Helvetica, sans-serif"}],p=[8,9,10,11,12,14,16,18,20,24,28,32,36,48,72],f=["#000000","#1a1a1a","#374151","#6B7280","#9CA3AF","#D1D5DB","#F3F4F6","#ffffff","#dc2626","#ea580c","#d97706","#16a34a","#0284c7","#7c3aed","#db2777","#0f766e","#fca5a5","#fdba74","#fde68a","#86efac","#93c5fd","#c4b5fd","#f9a8d4","#99f6e4"],h=["#fef08a","#bbf7d0","#bfdbfe","#fecaca","#e9d5ff","#fed7aa","#f0fdf4","#fffbeb"],m=ft(()=>{for(let T=1;T<=3;T++)if(r.editor.isActive("heading",{level:T}))return String(T);return"paragraph"}),g=ft(()=>r.editor.getAttributes("textStyle").fontFamily||"Arial, sans-serif"),v=ft(()=>r.editor.getAttributes("textStyle").fontSize||"12");function S(T){T==="paragraph"?r.editor.chain().focus().setParagraph().run():r.editor.chain().focus().toggleHeading({level:parseInt(T)}).run()}function P(T){c.value=T,r.editor.chain().focus().setColor(T).run(),o.value=!1}function B(T){d.value=T,r.editor.chain().focus().setHighlight({color:T}).run(),i.value=!1}function w(){r.editor.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run()}function k(){const T=document.createElement("input");T.type="file",T.accept="image/*",T.onchange=y=>_e(this,null,function*(){const A=y.target.files[0];if(!A)return;const se=new FileReader;se.onload=Se=>{r.editor.chain().focus().setImage({src:Se.target.result}).run()},se.readAsDataURL(A)}),T.click()}function M(T){T=T==null?void 0:T.trim().replace(/[^a-zA-Z0-9_]/g,"_"),T&&(r.editor.chain().focus().insertVariable(T).run(),s("add-variable",T),a.value="",l.value=!1)}function G(T){return"{{"+T+"}}"}function pe(T){T.target.closest(".toolbar")||(o.value=!1,i.value=!1,l.value=!1)}return Er(()=>document.addEventListener("click",pe)),js(()=>document.removeEventListener("click",pe)),(T,y)=>(_(),U("div",ba,[C("div",ya,[E(x(n),{title:"Undo (Ctrl+Z)",disabled:!e.editor.can().undo(),onClick:y[0]||(y[0]=A=>e.editor.chain().focus().undo().run())},{default:K(()=>[E(x(_s),{class:"w-4 h-4"})]),_:1},8,["disabled"]),E(x(n),{title:"Redo (Ctrl+Y)",disabled:!e.editor.can().redo(),onClick:y[1]||(y[1]=A=>e.editor.chain().focus().redo().run())},{default:K(()=>[E(x(Fs),{class:"w-4 h-4"})]),_:1},8,["disabled"])]),y[28]||(y[28]=C("div",{class:"toolbar-sep"},null,-1)),C("select",{value:m.value,onChange:y[2]||(y[2]=A=>S(A.target.value)),class:"toolbar-select w-28",title:"Paragraph style"},[...y[25]||(y[25]=[C("option",{value:"paragraph"},"Normal",-1),C("option",{value:"1"},"Heading 1",-1),C("option",{value:"2"},"Heading 2",-1),C("option",{value:"3"},"Heading 3",-1)])],40,va),y[29]||(y[29]=C("div",{class:"toolbar-sep"},null,-1)),C("select",{value:g.value,onChange:y[3]||(y[3]=A=>e.editor.chain().focus().setFontFamily(A.target.value).run()),class:"toolbar-select w-32",title:"Font family"},[(_(),U($e,null,ze(u,A=>C("option",{key:A.value,value:A.value},be(A.label),9,ka)),64))],40,wa),C("select",{value:v.value,onChange:y[4]||(y[4]=A=>e.editor.chain().focus().setFontSize(A.target.value).run()),class:"toolbar-select w-14",title:"Font size"},[(_(),U($e,null,ze(p,A=>C("option",{key:A,value:A},be(A),9,Aa)),64))],40,Ca),y[30]||(y[30]=C("div",{class:"toolbar-sep"},null,-1)),E(x(n),{title:"Bold (Ctrl+B)",active:e.editor.isActive("bold"),onClick:y[5]||(y[5]=A=>e.editor.chain().focus().toggleBold().run())},{default:K(()=>[E(x(Ws),{class:"w-4 h-4"})]),_:1},8,["active"]),E(x(n),{title:"Italic (Ctrl+I)",active:e.editor.isActive("italic"),onClick:y[6]||(y[6]=A=>e.editor.chain().focus().toggleItalic().run())},{default:K(()=>[E(x(Us),{class:"w-4 h-4"})]),_:1},8,["active"]),E(x(n),{title:"Underline (Ctrl+U)",active:e.editor.isActive("underline"),onClick:y[7]||(y[7]=A=>e.editor.chain().focus().toggleUnderline().run())},{default:K(()=>[E(x(Ks),{class:"w-4 h-4"})]),_:1},8,["active"]),E(x(n),{title:"Strikethrough",active:e.editor.isActive("strike"),onClick:y[8]||(y[8]=A=>e.editor.chain().focus().toggleStrike().run())},{default:K(()=>[E(x(Vs),{class:"w-4 h-4"})]),_:1},8,["active"]),y[31]||(y[31]=C("div",{class:"toolbar-sep"},null,-1)),C("div",xa,[E(x(n),{class:"relative",onClick:y[9]||(y[9]=A=>o.value=!o.value)},{default:K(()=>[C("span",Ta,[E(x(Gs),{class:"w-4 h-4"}),C("span",{class:"w-4 h-1 rounded-sm",style:nt({background:c.value})},null,4)])]),_:1}),o.value?(_(),U("div",La,[C("div",Sa,[(_(),U($e,null,ze(f,A=>C("button",{key:A,class:"w-5 h-5 rounded border border-gray-200 hover:scale-110 transition-transform",style:nt({background:A}),onClick:se=>P(A)},null,12,Ma)),64))]),C("button",{class:"w-full text-xs text-center py-1 border-t border-gray-100 text-gray-500 hover:text-gray-700",onClick:y[10]||(y[10]=A=>{e.editor.chain().focus().unsetColor().run(),o.value=!1})},"Remove color")])):ye("",!0)]),C("div",Ea,[E(x(n),{active:e.editor.isActive("highlight"),onClick:y[11]||(y[11]=A=>i.value=!i.value)},{default:K(()=>[C("span",Ra,[E(x(qs),{class:"w-4 h-4"}),C("span",{class:"w-4 h-1 rounded-sm",style:nt({background:d.value})},null,4)])]),_:1},8,["active"]),i.value?(_(),U("div",Ia,[C("div",Ha,[(_(),U($e,null,ze(h,A=>C("button",{key:A,class:"w-6 h-6 rounded border border-gray-200 hover:scale-110 transition-transform",style:nt({background:A}),onClick:se=>B(A)},null,12,Na)),64))]),C("button",{class:"w-full text-xs text-center py-1 border-t border-gray-100 text-gray-500 hover:text-gray-700",onClick:y[12]||(y[12]=A=>{e.editor.chain().focus().unsetHighlight().run(),i.value=!1})},"Remove highlight")])):ye("",!0)]),y[32]||(y[32]=C("div",{class:"toolbar-sep"},null,-1)),E(x(n),{title:"Align left",active:e.editor.isActive({textAlign:"left"}),onClick:y[13]||(y[13]=A=>e.editor.chain().focus().setTextAlign("left").run())},{default:K(()=>[E(x(Xs),{class:"w-4 h-4"})]),_:1},8,["active"]),E(x(n),{title:"Align center",active:e.editor.isActive({textAlign:"center"}),onClick:y[14]||(y[14]=A=>e.editor.chain().focus().setTextAlign("center").run())},{default:K(()=>[E(x(Js),{class:"w-4 h-4"})]),_:1},8,["active"]),E(x(n),{title:"Align right",active:e.editor.isActive({textAlign:"right"}),onClick:y[15]||(y[15]=A=>e.editor.chain().focus().setTextAlign("right").run())},{default:K(()=>[E(x(Ys),{class:"w-4 h-4"})]),_:1},8,["active"]),E(x(n),{title:"Justify",active:e.editor.isActive({textAlign:"justify"}),onClick:y[16]||(y[16]=A=>e.editor.chain().focus().setTextAlign("justify").run())},{default:K(()=>[E(x(Qs),{class:"w-4 h-4"})]),_:1},8,["active"]),y[33]||(y[33]=C("div",{class:"toolbar-sep"},null,-1)),E(x(n),{title:"Bullet list",active:e.editor.isActive("bulletList"),onClick:y[17]||(y[17]=A=>e.editor.chain().focus().toggleBulletList().run())},{default:K(()=>[E(x(Zs),{class:"w-4 h-4"})]),_:1},8,["active"]),E(x(n),{title:"Numbered list",active:e.editor.isActive("orderedList"),onClick:y[18]||(y[18]=A=>e.editor.chain().focus().toggleOrderedList().run())},{default:K(()=>[E(x(eo),{class:"w-4 h-4"})]),_:1},8,["active"]),y[34]||(y[34]=C("div",{class:"toolbar-sep"},null,-1)),E(x(n),{title:"Insert table",onClick:w},{default:K(()=>[E(x(to),{class:"w-4 h-4"})]),_:1}),E(x(n),{title:"Insert image",onClick:k},{default:K(()=>[E(x(no),{class:"w-4 h-4"})]),_:1}),y[35]||(y[35]=C("div",{class:"toolbar-sep"},null,-1)),C("div",Oa,[C("button",{class:"flex items-center gap-1.5 px-2 py-1 text-xs font-medium bg-orange-50 text-orange-700 border border-orange-200 rounded hover:bg-orange-100 transition-colors",onClick:y[19]||(y[19]=A=>l.value=!l.value),title:"Insert variable"},[E(x(ro),{class:"w-3.5 h-3.5"}),y[26]||(y[26]=dt(" Insert Variable ",-1))]),l.value?(_(),U("div",{key:0,class:"var-popup",onKeydown:y[24]||(y[24]=pt(A=>l.value=!1,["esc"]))},[y[27]||(y[27]=C("p",{class:"text-xs text-gray-500 mb-2"},"Select or type a variable name",-1)),C("div",Pa,[(_(!0),U($e,null,ze(e.variables,A=>(_(),U("button",{key:A,class:"px-2 py-0.5 text-xs bg-orange-100 text-orange-800 rounded-full hover:bg-orange-200",onClick:se=>M(A)},be(G(A)),9,$a))),128))]),C("div",za,[un(C("input",{"onUpdate:modelValue":y[20]||(y[20]=A=>a.value=A),type:"text",placeholder:"variable_name",class:"flex-1 text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-orange-400",onKeydown:[y[21]||(y[21]=pt(A=>M(a.value),["enter"])),y[22]||(y[22]=pt(A=>l.value=!1,["esc"]))]},null,544),[[dn,a.value]]),C("button",{class:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600",onClick:y[23]||(y[23]=A=>M(a.value))},"Insert")])],32)):ye("",!0)])]))}},Ba=ga(Da,[["__scopeId","data-v-1286d806"]]),ja={class:"flex flex-col h-screen overflow-hidden bg-gray-100"},_a={class:"flex items-center gap-3 px-4 py-2 bg-white border-b border-gray-200 flex-shrink-0 shadow-sm"},Fa={key:0,class:"text-xs text-gray-400"},Wa=["disabled"],Ua=["disabled","title"],Ka={class:"flex flex-1 overflow-hidden"},Va={class:"w-52 bg-white border-r border-gray-200 flex flex-col flex-shrink-0"},Ga={class:"flex-1 overflow-y-auto p-3 space-y-1.5"},qa=["onClick","title"],Xa={key:0,class:"text-xs text-gray-400 text-center py-4"},Ja={class:"p-3 border-t border-gray-100"},Ya={class:"flex gap-1"},Qa={class:"flex-1 overflow-auto bg-[#d9d9d9] py-8 px-6"},Za={class:"relative mx-auto bg-white shadow-2xl",style:{width:"794px","min-height":"1123px"}},ec=["src"],tc={class:"w-44 bg-white border-l border-gray-200 p-3 flex-shrink-0 space-y-4"},nc={class:"border-t border-gray-100 pt-3"},rc={class:"border-t border-gray-100 pt-3"},sc={class:"text-xs text-gray-400"},oc={class:"text-xs text-gray-400 mt-0.5"},uc={__name:"TemplateEditor",setup(e){const t=ho(),n=fo(),r=mo(),s=Z("Untitled Template"),o=Z([]),i=Z(""),l=Z(""),a=Z(!1),c=Z(""),d=Z(""),u=io({extensions:[Ji.configure({codeBlock:!1}),rs,ss,Jr,nl.configure({types:["heading","paragraph"]}),os,ol.configure({multicolor:!0}),ll.configure({inline:!1,allowBase64:!0}),ys.configure({resizable:!0}),bs,ms,gs,Br.configure({openOnClick:!1}),ha,ma],content:"<p>Start typing your template here…</p>"}),p=ft(()=>{if(!u.value)return 0;const w=u.value.getText();return w.trim()?w.trim().split(/\s+/).length:0});Er(()=>_e(this,null,function*(){const w=n.params.name;w&&w!=="new"&&(d.value=w,yield f(w))})),lo(()=>{var w;(w=u.value)==null||w.destroy()});function f(w){return _e(this,null,function*(){var G;const k=yield r.getTemplate(w);if(!(k!=null&&k.success))return;const M=k.data.schema||{};s.value=k.data.template_name||w,M.type==="tiptap"&&(o.value=M.variables||[],l.value=M.background_image||"",M.html&&((G=u.value)==null||G.commands.setContent(M.html)))})}function h(){return _e(this,null,function*(){var k;const w=s.value.trim();if(w){a.value=!0;try{const G={type:"tiptap",html:((k=u.value)==null?void 0:k.getHTML())||"",variables:o.value,background_image:l.value},pe=yield r.saveTemplate(w,G,"","");pe!=null&&pe.success&&(d.value=pe.data.template_name,c.value=new Date().toLocaleTimeString())}finally{a.value=!1}}})}function m(w){var k;(k=u.value)==null||k.chain().focus().insertVariable(w).run()}function g(w){if(w=w==null?void 0:w.trim().replace(/[^a-zA-Z0-9_]/g,"_"),!w||o.value.includes(w)){i.value="";return}o.value.push(w),m(w),i.value=""}function v(w){w&&!o.value.includes(w)&&o.value.push(w)}function S(){t.push({name:"template-generate",params:{name:d.value}})}function P(w){return"{{"+w+"}}"}function B(w){const k=w.target.files[0];if(!k)return;const M=new FileReader;M.onload=G=>{l.value=G.target.result},M.readAsDataURL(k)}return(w,k)=>(_(),U("div",ja,[C("div",_a,[C("button",{class:"flex items-center gap-1.5 text-sm text-gray-600 hover:text-gray-900 transition-colors",onClick:k[0]||(k[0]=M=>w.$router.push("/templates"))},[E(x(ao),{class:"w-4 h-4"}),k[7]||(k[7]=dt(" Templates ",-1))]),k[9]||(k[9]=C("div",{class:"w-px h-5 bg-gray-200"},null,-1)),un(C("input",{"onUpdate:modelValue":k[1]||(k[1]=M=>s.value=M),type:"text",placeholder:"Template Name",class:"flex-1 text-base font-semibold text-gray-900 border-none outline-none bg-transparent max-w-xs placeholder-gray-400"},null,512),[[dn,s.value]]),k[10]||(k[10]=C("div",{class:"flex-1"},null,-1)),c.value?(_(),U("span",Fa,"Saved "+be(c.value),1)):ye("",!0),C("button",{class:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",onClick:h,disabled:a.value},[E(x(co),{class:"w-4 h-4"}),dt(" "+be(a.value?"Saving…":"Save"),1)],8,Wa),C("button",{class:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors disabled:opacity-50",onClick:S,disabled:!d.value,title:d.value?"Generate PDF from this template":"Save first"},[E(x(uo),{class:"w-4 h-4"}),k[8]||(k[8]=dt(" Generate PDF ",-1))],8,Ua)]),x(u)?(_(),Un(Ba,{key:0,editor:x(u),variables:o.value,onAddVariable:v,class:"flex-shrink-0"},null,8,["editor","variables"])):ye("",!0),C("div",Ka,[C("div",Va,[k[12]||(k[12]=C("div",{class:"px-3 py-2.5 border-b border-gray-100"},[C("p",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide"},"Variables"),C("p",{class:"text-xs text-gray-400 mt-0.5"},"Click to insert at cursor")],-1)),C("div",Ga,[(_(!0),U($e,null,ze(o.value,M=>(_(),U("button",{key:M,class:"w-full text-left px-2.5 py-1 text-xs bg-orange-50 text-orange-700 border border-orange-200 rounded-full hover:bg-orange-100 truncate transition-colors",onClick:G=>m(M),title:"Insert "+P(M)},be(P(M)),9,qa))),128)),o.value.length===0?(_(),U("p",Xa," No variables yet ")):ye("",!0)]),C("div",Ja,[k[11]||(k[11]=C("p",{class:"text-xs text-gray-500 mb-1.5"},"Add variable",-1)),C("div",Ya,[un(C("input",{"onUpdate:modelValue":k[2]||(k[2]=M=>i.value=M),type:"text",placeholder:"var_name",class:"flex-1 text-xs border border-gray-200 rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-orange-400 min-w-0",onKeydown:k[3]||(k[3]=pt(M=>g(i.value),["enter"]))},null,544),[[dn,i.value]]),C("button",{class:"px-2.5 py-1.5 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 transition-colors flex-shrink-0",onClick:k[4]||(k[4]=M=>g(i.value))},"+")])])]),C("div",Qa,[C("div",Za,[l.value?(_(),U("img",{key:0,src:l.value,class:"absolute inset-0 w-full h-full object-cover pointer-events-none select-none",style:{opacity:"0.12"},alt:""},null,8,ec)):ye("",!0),x(u)?(_(),Un(x(po),{key:1,editor:x(u),class:"template-paper relative z-10",style:{padding:"80px","min-height":"1123px"}},null,8,["editor"])):ye("",!0)])]),C("div",tc,[k[14]||(k[14]=C("div",null,[C("p",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2"},"Page"),C("p",{class:"text-xs text-gray-600"},"A4 · 794 × 1123 px")],-1)),C("div",nc,[k[13]||(k[13]=C("p",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2"},"Background",-1)),C("button",{class:"w-full text-xs px-2 py-2 border border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-orange-400 hover:text-orange-600 text-center transition-colors",onClick:k[5]||(k[5]=M=>w.$refs.bgFileInput.click())},be(l.value?"Change image":"+ Upload image"),1),C("input",{ref:"bgFileInput",type:"file",accept:"image/*",class:"hidden",onChange:B},null,544),l.value?(_(),U("button",{key:0,onClick:k[6]||(k[6]=M=>l.value=""),class:"mt-1.5 w-full text-xs text-red-500 hover:underline text-center"},"Remove")):ye("",!0)]),C("div",rc,[C("p",sc,"Variables: "+be(o.value.length),1),C("p",oc,"Words: "+be(p.value),1)])])])]))}};export{uc as default};
//# sourceMappingURL=TemplateEditor-t25vjGyE.js.map
