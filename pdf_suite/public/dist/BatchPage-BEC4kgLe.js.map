{"version":3,"file":"BatchPage-BEC4kgLe.js","sources":["../../../frontend/src/pages/BatchPage.vue"],"sourcesContent":["<template>\r\n  <div class=\"max-w-3xl mx-auto px-6 py-12\">\r\n    <h1 class=\"text-2xl font-bold text-gray-900 mb-2\">Batch Operations</h1>\r\n    <p class=\"text-gray-600 mb-8\">Process multiple PDF files at once.</p>\r\n\r\n    <!-- Operation selector -->\r\n    <div class=\"mb-6\">\r\n      <label class=\"block text-sm font-medium text-gray-700 mb-2\">Operation</label>\r\n      <div class=\"flex flex-wrap gap-2\">\r\n        <button\r\n          v-for=\"op in operations\"\r\n          :key=\"op.value\"\r\n          @click=\"operation = op.value\"\r\n          class=\"px-4 py-2 rounded-lg text-sm border\"\r\n          :class=\"operation === op.value ? 'bg-brand-50 border-brand-300 text-brand-700' : 'border-gray-300'\"\r\n        >\r\n          {{ op.label }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Files -->\r\n    <div v-if=\"files.length > 0\" class=\"space-y-2 mb-4\">\r\n      <div\r\n        v-for=\"(file, i) in files\"\r\n        :key=\"i\"\r\n        class=\"flex items-center gap-3 bg-white border border-gray-200 rounded-lg px-4 py-2 text-sm\"\r\n      >\r\n        <FileText class=\"w-4 h-4 text-brand-500\" />\r\n        <span class=\"flex-1 truncate\">{{ file.name }}</span>\r\n        <button @click=\"files.splice(i, 1)\" class=\"text-gray-400 hover:text-red-500\">\r\n          <X class=\"w-4 h-4\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <FileDropZone\r\n      accept=\".pdf\"\r\n      :multiple=\"true\"\r\n      label=\"Add PDF files for batch processing\"\r\n      @files-selected=\"addFiles\"\r\n      class=\"mb-6\"\r\n    />\r\n\r\n    <!-- Options per operation -->\r\n    <div v-if=\"operation === 'compress'\" class=\"mb-6\">\r\n      <label class=\"block text-sm font-medium text-gray-700 mb-1\">Quality</label>\r\n      <select v-model=\"options.quality\" class=\"px-3 py-2 border border-gray-300 rounded-lg text-sm\">\r\n        <option value=\"high\">Low compression</option>\r\n        <option value=\"medium\">Medium</option>\r\n        <option value=\"low\">Max compression</option>\r\n      </select>\r\n    </div>\r\n\r\n    <div v-if=\"operation === 'watermark'\" class=\"mb-6\">\r\n      <label class=\"block text-sm font-medium text-gray-700 mb-1\">Watermark text</label>\r\n      <input v-model=\"options.text\" type=\"text\" class=\"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm\" placeholder=\"CONFIDENTIAL\" />\r\n    </div>\r\n\r\n    <div v-if=\"operation === 'ocr'\" class=\"mb-6\">\r\n      <label class=\"block text-sm font-medium text-gray-700 mb-1\">Language</label>\r\n      <select v-model=\"options.language\" class=\"px-3 py-2 border border-gray-300 rounded-lg text-sm\">\r\n        <option value=\"eng\">English</option>\r\n        <option value=\"ara\">Arabic</option>\r\n        <option value=\"eng+ara\">English + Arabic</option>\r\n      </select>\r\n    </div>\r\n\r\n    <!-- Start -->\r\n    <button\r\n      @click=\"startBatch\"\r\n      :disabled=\"files.length === 0 || processing\"\r\n      class=\"px-6 py-2.5 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50 font-medium text-sm\"\r\n    >\r\n      {{ processing ? 'Processing...' : `Process ${files.length} files` }}\r\n    </button>\r\n\r\n    <p v-if=\"error\" class=\"mt-3 text-sm text-red-600\">{{ error }}</p>\r\n\r\n    <!-- Progress -->\r\n    <div v-if=\"batchName\" class=\"mt-8 bg-white border border-gray-200 rounded-lg p-5\">\r\n      <div class=\"flex items-center justify-between mb-2\">\r\n        <span class=\"text-sm font-medium\">{{ batchStatus }}</span>\r\n        <span class=\"text-sm text-gray-500\">{{ processedFiles }} / {{ totalFiles }}</span>\r\n      </div>\r\n      <div class=\"w-full bg-gray-200 rounded-full h-2\">\r\n        <div\r\n          class=\"bg-brand-600 h-2 rounded-full transition-all\"\r\n          :style=\"{ width: `${progress}%` }\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from 'vue'\r\nimport { FileText, X } from 'lucide-vue-next'\r\nimport FileDropZone from '@/components/shared/FileDropZone.vue'\r\nimport { usePdfApi } from '@/composables/usePdfApi'\r\n\r\nconst api = usePdfApi()\r\nconst operation = ref('compress')\r\nconst files = ref([])\r\nconst options = ref({ quality: 'medium', text: 'CONFIDENTIAL', language: 'eng' })\r\nconst processing = ref(false)\r\nconst error = ref('')\r\nconst batchName = ref('')\r\nconst batchStatus = ref('')\r\nconst totalFiles = ref(0)\r\nconst processedFiles = ref(0)\r\n\r\nconst operations = [\r\n  { value: 'compress', label: 'Compress' },\r\n  { value: 'watermark', label: 'Watermark' },\r\n  { value: 'ocr', label: 'OCR' },\r\n  { value: 'merge', label: 'Merge All' },\r\n]\r\n\r\nconst progress = computed(() => totalFiles.value ? (processedFiles.value / totalFiles.value) * 100 : 0)\r\n\r\nfunction addFiles(newFiles) {\r\n  files.value.push(...newFiles)\r\n}\r\n\r\nasync function startBatch() {\r\n  if (files.value.length === 0) return\r\n  processing.value = true\r\n  error.value = ''\r\n\r\n  try {\r\n    // Upload all files\r\n    const urls = []\r\n    for (const file of files.value) {\r\n      const upload = await api.uploadFile(file)\r\n      if (!upload.success) { error.value = `Upload failed: ${upload.error}`; return }\r\n      urls.push(upload.data.file_url)\r\n    }\r\n\r\n    // Start batch\r\n    const res = await api.startBatch(operation.value, urls, options.value)\r\n    if (res.success) {\r\n      batchName.value = res.data.batch_name\r\n      batchStatus.value = 'Queued'\r\n      totalFiles.value = files.value.length\r\n      processedFiles.value = 0\r\n\r\n      // Poll for status\r\n      pollStatus()\r\n    } else {\r\n      error.value = res.error\r\n    }\r\n  } catch (e) {\r\n    error.value = e.message\r\n  } finally {\r\n    processing.value = false\r\n  }\r\n}\r\n\r\nasync function pollStatus() {\r\n  const interval = setInterval(async () => {\r\n    const res = await api.getBatchStatus(batchName.value)\r\n    if (res?.success) {\r\n      batchStatus.value = res.data.status\r\n      processedFiles.value = res.data.processed_files\r\n\r\n      if (res.data.status === 'Completed' || res.data.status === 'Failed') {\r\n        clearInterval(interval)\r\n        if (res.data.status === 'Failed') {\r\n          error.value = res.data.error || 'Batch failed'\r\n        }\r\n      }\r\n    }\r\n  }, 2000)\r\n}\r\n</script>\r\n"],"names":["api","usePdfApi","operation","ref","files","options","processing","error","batchName","batchStatus","totalFiles","processedFiles","operations","progress","computed","addFiles","newFiles","startBatch","__async","urls","file","upload","res","pollStatus","e","interval","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_hoisted_3","_Fragment","_renderList","op","$event","_toDisplayString","_hoisted_4","_hoisted_5","i","_createVNode","_unref","FileText","_hoisted_6","X","FileDropZone","_hoisted_8","_vModelSelect","_hoisted_9","_vModelText","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17"],"mappings":"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"}