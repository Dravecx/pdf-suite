{"version":3,"file":"TemplateEditor-t25vjGyE.js","sources":["../../../frontend/node_modules/@tiptap/core/dist/jsx-runtime/jsx-runtime.js","../../../frontend/node_modules/@tiptap/extension-blockquote/dist/index.js","../../../frontend/node_modules/@tiptap/extension-bold/dist/index.js","../../../frontend/node_modules/@tiptap/extension-code/dist/index.js","../../../frontend/node_modules/@tiptap/extension-code-block/dist/index.js","../../../frontend/node_modules/@tiptap/extension-document/dist/index.js","../../../frontend/node_modules/@tiptap/extension-hard-break/dist/index.js","../../../frontend/node_modules/@tiptap/extension-heading/dist/index.js","../../../frontend/node_modules/@tiptap/extension-horizontal-rule/dist/index.js","../../../frontend/node_modules/@tiptap/extension-italic/dist/index.js","../../../frontend/node_modules/linkifyjs/dist/linkify.mjs","../../../frontend/node_modules/@tiptap/extension-link/dist/index.js","../../../frontend/node_modules/@tiptap/extension-list/dist/index.js","../../../frontend/node_modules/@tiptap/extension-paragraph/dist/index.js","../../../frontend/node_modules/@tiptap/extension-strike/dist/index.js","../../../frontend/node_modules/@tiptap/extension-text/dist/index.js","../../../frontend/node_modules/@tiptap/extension-underline/dist/index.js","../../../frontend/node_modules/prosemirror-dropcursor/dist/index.js","../../../frontend/node_modules/prosemirror-gapcursor/dist/index.js","../../../frontend/node_modules/rope-sequence/dist/index.js","../../../frontend/node_modules/prosemirror-history/dist/index.js","../../../frontend/node_modules/@tiptap/extensions/dist/index.js","../../../frontend/node_modules/@tiptap/starter-kit/dist/index.js","../../../frontend/node_modules/@tiptap/extension-text-style/dist/index.js","../../../frontend/node_modules/@tiptap/extension-text-align/dist/index.js","../../../frontend/node_modules/@tiptap/extension-highlight/dist/index.js","../../../frontend/node_modules/@tiptap/extension-image/dist/index.js","../../../frontend/node_modules/prosemirror-tables/dist/index.js","../../../frontend/node_modules/@tiptap/extension-table/dist/index.js","../../../frontend/src/components/template/VariableNode.js","../../../frontend/src/components/template/FontSizeExtension.js","../../../frontend/src/components/template/TemplateToolbar.vue","../../../frontend/src/components/template/TemplateEditor.vue"],"sourcesContent":["// src/jsx-runtime.ts\nfunction Fragment(props) {\n  return props.children;\n}\nvar h = (tag, attributes) => {\n  if (tag === \"slot\") {\n    return 0;\n  }\n  if (tag instanceof Function) {\n    return tag(attributes);\n  }\n  const { children, ...rest } = attributes != null ? attributes : {};\n  if (tag === \"svg\") {\n    throw new Error(\"SVG elements are not supported in the JSX syntax, use the array syntax instead\");\n  }\n  return [tag, rest, children];\n};\nexport {\n  Fragment,\n  h as createElement,\n  h,\n  h as jsx,\n  h as jsxDEV,\n  h as jsxs\n};\n//# sourceMappingURL=jsx-runtime.js.map","// src/blockquote.tsx\nimport { mergeAttributes, Node, wrappingInputRule } from \"@tiptap/core\";\nimport { jsx } from \"@tiptap/core/jsx-runtime\";\nvar inputRegex = /^\\s*>\\s$/;\nvar Blockquote = Node.create({\n  name: \"blockquote\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  content: \"block+\",\n  group: \"block\",\n  defining: true,\n  parseHTML() {\n    return [{ tag: \"blockquote\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return /* @__PURE__ */ jsx(\"blockquote\", { ...mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), children: /* @__PURE__ */ jsx(\"slot\", {}) });\n  },\n  parseMarkdown: (token, helpers) => {\n    return helpers.createNode(\"blockquote\", void 0, helpers.parseChildren(token.tokens || []));\n  },\n  renderMarkdown: (node, h) => {\n    if (!node.content) {\n      return \"\";\n    }\n    const prefix = \">\";\n    const result = [];\n    node.content.forEach((child) => {\n      const childContent = h.renderChildren([child]);\n      const lines = childContent.split(\"\\n\");\n      const linesWithPrefix = lines.map((line) => {\n        if (line.trim() === \"\") {\n          return prefix;\n        }\n        return `${prefix} ${line}`;\n      });\n      result.push(linesWithPrefix.join(\"\\n\"));\n    });\n    return result.join(`\n${prefix}\n`);\n  },\n  addCommands() {\n    return {\n      setBlockquote: () => ({ commands }) => {\n        return commands.wrapIn(this.name);\n      },\n      toggleBlockquote: () => ({ commands }) => {\n        return commands.toggleWrap(this.name);\n      },\n      unsetBlockquote: () => ({ commands }) => {\n        return commands.lift(this.name);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Shift-b\": () => this.editor.commands.toggleBlockquote()\n    };\n  },\n  addInputRules() {\n    return [\n      wrappingInputRule({\n        find: inputRegex,\n        type: this.type\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = Blockquote;\nexport {\n  Blockquote,\n  index_default as default,\n  inputRegex\n};\n//# sourceMappingURL=index.js.map","// src/bold.tsx\nimport { Mark, markInputRule, markPasteRule, mergeAttributes } from \"@tiptap/core\";\nimport { jsx } from \"@tiptap/core/jsx-runtime\";\nvar starInputRegex = /(?:^|\\s)(\\*\\*(?!\\s+\\*\\*)((?:[^*]+))\\*\\*(?!\\s+\\*\\*))$/;\nvar starPasteRegex = /(?:^|\\s)(\\*\\*(?!\\s+\\*\\*)((?:[^*]+))\\*\\*(?!\\s+\\*\\*))/g;\nvar underscoreInputRegex = /(?:^|\\s)(__(?!\\s+__)((?:[^_]+))__(?!\\s+__))$/;\nvar underscorePasteRegex = /(?:^|\\s)(__(?!\\s+__)((?:[^_]+))__(?!\\s+__))/g;\nvar Bold = Mark.create({\n  name: \"bold\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"strong\"\n      },\n      {\n        tag: \"b\",\n        getAttrs: (node) => node.style.fontWeight !== \"normal\" && null\n      },\n      {\n        style: \"font-weight=400\",\n        clearMark: (mark) => mark.type.name === this.name\n      },\n      {\n        style: \"font-weight\",\n        getAttrs: (value) => /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return /* @__PURE__ */ jsx(\"strong\", { ...mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), children: /* @__PURE__ */ jsx(\"slot\", {}) });\n  },\n  markdownTokenName: \"strong\",\n  parseMarkdown: (token, helpers) => {\n    return helpers.applyMark(\"bold\", helpers.parseInline(token.tokens || []));\n  },\n  renderMarkdown: (node, h) => {\n    return `**${h.renderChildren(node)}**`;\n  },\n  addCommands() {\n    return {\n      setBold: () => ({ commands }) => {\n        return commands.setMark(this.name);\n      },\n      toggleBold: () => ({ commands }) => {\n        return commands.toggleMark(this.name);\n      },\n      unsetBold: () => ({ commands }) => {\n        return commands.unsetMark(this.name);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-b\": () => this.editor.commands.toggleBold(),\n      \"Mod-B\": () => this.editor.commands.toggleBold()\n    };\n  },\n  addInputRules() {\n    return [\n      markInputRule({\n        find: starInputRegex,\n        type: this.type\n      }),\n      markInputRule({\n        find: underscoreInputRegex,\n        type: this.type\n      })\n    ];\n  },\n  addPasteRules() {\n    return [\n      markPasteRule({\n        find: starPasteRegex,\n        type: this.type\n      }),\n      markPasteRule({\n        find: underscorePasteRegex,\n        type: this.type\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = Bold;\nexport {\n  Bold,\n  index_default as default,\n  starInputRegex,\n  starPasteRegex,\n  underscoreInputRegex,\n  underscorePasteRegex\n};\n//# sourceMappingURL=index.js.map","// src/code.ts\nimport { Mark, markInputRule, markPasteRule, mergeAttributes } from \"@tiptap/core\";\nvar inputRegex = /(^|[^`])`([^`]+)`(?!`)$/;\nvar pasteRegex = /(^|[^`])`([^`]+)`(?!`)/g;\nvar Code = Mark.create({\n  name: \"code\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  excludes: \"_\",\n  code: true,\n  exitable: true,\n  parseHTML() {\n    return [{ tag: \"code\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"code\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  markdownTokenName: \"codespan\",\n  parseMarkdown: (token, helpers) => {\n    return helpers.applyMark(\"code\", [{ type: \"text\", text: token.text || \"\" }]);\n  },\n  renderMarkdown: (node, h) => {\n    if (!node.content) {\n      return \"\";\n    }\n    return `\\`${h.renderChildren(node.content)}\\``;\n  },\n  addCommands() {\n    return {\n      setCode: () => ({ commands }) => {\n        return commands.setMark(this.name);\n      },\n      toggleCode: () => ({ commands }) => {\n        return commands.toggleMark(this.name);\n      },\n      unsetCode: () => ({ commands }) => {\n        return commands.unsetMark(this.name);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-e\": () => this.editor.commands.toggleCode()\n    };\n  },\n  addInputRules() {\n    return [\n      markInputRule({\n        find: inputRegex,\n        type: this.type\n      })\n    ];\n  },\n  addPasteRules() {\n    return [\n      markPasteRule({\n        find: pasteRegex,\n        type: this.type\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = Code;\nexport {\n  Code,\n  index_default as default,\n  inputRegex,\n  pasteRegex\n};\n//# sourceMappingURL=index.js.map","// src/code-block.ts\nimport { mergeAttributes, Node, textblockTypeInputRule } from \"@tiptap/core\";\nimport { Plugin, PluginKey, Selection, TextSelection } from \"@tiptap/pm/state\";\nvar DEFAULT_TAB_SIZE = 4;\nvar backtickInputRegex = /^```([a-z]+)?[\\s\\n]$/;\nvar tildeInputRegex = /^~~~([a-z]+)?[\\s\\n]$/;\nvar CodeBlock = Node.create({\n  name: \"codeBlock\",\n  addOptions() {\n    return {\n      languageClassPrefix: \"language-\",\n      exitOnTripleEnter: true,\n      exitOnArrowDown: true,\n      defaultLanguage: null,\n      enableTabIndentation: false,\n      tabSize: DEFAULT_TAB_SIZE,\n      HTMLAttributes: {}\n    };\n  },\n  content: \"text*\",\n  marks: \"\",\n  group: \"block\",\n  code: true,\n  defining: true,\n  addAttributes() {\n    return {\n      language: {\n        default: this.options.defaultLanguage,\n        parseHTML: (element) => {\n          var _a;\n          const { languageClassPrefix } = this.options;\n          if (!languageClassPrefix) {\n            return null;\n          }\n          const classNames = [...((_a = element.firstElementChild) == null ? void 0 : _a.classList) || []];\n          const languages = classNames.filter((className) => className.startsWith(languageClassPrefix)).map((className) => className.replace(languageClassPrefix, \"\"));\n          const language = languages[0];\n          if (!language) {\n            return null;\n          }\n          return language;\n        },\n        rendered: false\n      }\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"pre\",\n        preserveWhitespace: \"full\"\n      }\n    ];\n  },\n  renderHTML({ node, HTMLAttributes }) {\n    return [\n      \"pre\",\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n      [\n        \"code\",\n        {\n          class: node.attrs.language ? this.options.languageClassPrefix + node.attrs.language : null\n        },\n        0\n      ]\n    ];\n  },\n  markdownTokenName: \"code\",\n  parseMarkdown: (token, helpers) => {\n    var _a;\n    if (((_a = token.raw) == null ? void 0 : _a.startsWith(\"```\")) === false && token.codeBlockStyle !== \"indented\") {\n      return [];\n    }\n    return helpers.createNode(\n      \"codeBlock\",\n      { language: token.lang || null },\n      token.text ? [helpers.createTextNode(token.text)] : []\n    );\n  },\n  renderMarkdown: (node, h) => {\n    var _a;\n    let output = \"\";\n    const language = ((_a = node.attrs) == null ? void 0 : _a.language) || \"\";\n    if (!node.content) {\n      output = `\\`\\`\\`${language}\n\n\\`\\`\\``;\n    } else {\n      const lines = [`\\`\\`\\`${language}`, h.renderChildren(node.content), \"```\"];\n      output = lines.join(\"\\n\");\n    }\n    return output;\n  },\n  addCommands() {\n    return {\n      setCodeBlock: (attributes) => ({ commands }) => {\n        return commands.setNode(this.name, attributes);\n      },\n      toggleCodeBlock: (attributes) => ({ commands }) => {\n        return commands.toggleNode(this.name, \"paragraph\", attributes);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Alt-c\": () => this.editor.commands.toggleCodeBlock(),\n      // remove code block when at start of document or code block is empty\n      Backspace: () => {\n        const { empty, $anchor } = this.editor.state.selection;\n        const isAtStart = $anchor.pos === 1;\n        if (!empty || $anchor.parent.type.name !== this.name) {\n          return false;\n        }\n        if (isAtStart || !$anchor.parent.textContent.length) {\n          return this.editor.commands.clearNodes();\n        }\n        return false;\n      },\n      // handle tab indentation\n      Tab: ({ editor }) => {\n        var _a;\n        if (!this.options.enableTabIndentation) {\n          return false;\n        }\n        const tabSize = (_a = this.options.tabSize) != null ? _a : DEFAULT_TAB_SIZE;\n        const { state } = editor;\n        const { selection } = state;\n        const { $from, empty } = selection;\n        if ($from.parent.type !== this.type) {\n          return false;\n        }\n        const indent = \" \".repeat(tabSize);\n        if (empty) {\n          return editor.commands.insertContent(indent);\n        }\n        return editor.commands.command(({ tr }) => {\n          const { from, to } = selection;\n          const text = state.doc.textBetween(from, to, \"\\n\", \"\\n\");\n          const lines = text.split(\"\\n\");\n          const indentedText = lines.map((line) => indent + line).join(\"\\n\");\n          tr.replaceWith(from, to, state.schema.text(indentedText));\n          return true;\n        });\n      },\n      // handle shift+tab reverse indentation\n      \"Shift-Tab\": ({ editor }) => {\n        var _a;\n        if (!this.options.enableTabIndentation) {\n          return false;\n        }\n        const tabSize = (_a = this.options.tabSize) != null ? _a : DEFAULT_TAB_SIZE;\n        const { state } = editor;\n        const { selection } = state;\n        const { $from, empty } = selection;\n        if ($from.parent.type !== this.type) {\n          return false;\n        }\n        if (empty) {\n          return editor.commands.command(({ tr }) => {\n            var _a2;\n            const { pos } = $from;\n            const codeBlockStart = $from.start();\n            const codeBlockEnd = $from.end();\n            const allText = state.doc.textBetween(codeBlockStart, codeBlockEnd, \"\\n\", \"\\n\");\n            const lines = allText.split(\"\\n\");\n            let currentLineIndex = 0;\n            let charCount = 0;\n            const relativeCursorPos = pos - codeBlockStart;\n            for (let i = 0; i < lines.length; i += 1) {\n              if (charCount + lines[i].length >= relativeCursorPos) {\n                currentLineIndex = i;\n                break;\n              }\n              charCount += lines[i].length + 1;\n            }\n            const currentLine = lines[currentLineIndex];\n            const leadingSpaces = ((_a2 = currentLine.match(/^ */)) == null ? void 0 : _a2[0]) || \"\";\n            const spacesToRemove = Math.min(leadingSpaces.length, tabSize);\n            if (spacesToRemove === 0) {\n              return true;\n            }\n            let lineStartPos = codeBlockStart;\n            for (let i = 0; i < currentLineIndex; i += 1) {\n              lineStartPos += lines[i].length + 1;\n            }\n            tr.delete(lineStartPos, lineStartPos + spacesToRemove);\n            const cursorPosInLine = pos - lineStartPos;\n            if (cursorPosInLine <= spacesToRemove) {\n              tr.setSelection(TextSelection.create(tr.doc, lineStartPos));\n            }\n            return true;\n          });\n        }\n        return editor.commands.command(({ tr }) => {\n          const { from, to } = selection;\n          const text = state.doc.textBetween(from, to, \"\\n\", \"\\n\");\n          const lines = text.split(\"\\n\");\n          const reverseIndentText = lines.map((line) => {\n            var _a2;\n            const leadingSpaces = ((_a2 = line.match(/^ */)) == null ? void 0 : _a2[0]) || \"\";\n            const spacesToRemove = Math.min(leadingSpaces.length, tabSize);\n            return line.slice(spacesToRemove);\n          }).join(\"\\n\");\n          tr.replaceWith(from, to, state.schema.text(reverseIndentText));\n          return true;\n        });\n      },\n      // exit node on triple enter\n      Enter: ({ editor }) => {\n        if (!this.options.exitOnTripleEnter) {\n          return false;\n        }\n        const { state } = editor;\n        const { selection } = state;\n        const { $from, empty } = selection;\n        if (!empty || $from.parent.type !== this.type) {\n          return false;\n        }\n        const isAtEnd = $from.parentOffset === $from.parent.nodeSize - 2;\n        const endsWithDoubleNewline = $from.parent.textContent.endsWith(\"\\n\\n\");\n        if (!isAtEnd || !endsWithDoubleNewline) {\n          return false;\n        }\n        return editor.chain().command(({ tr }) => {\n          tr.delete($from.pos - 2, $from.pos);\n          return true;\n        }).exitCode().run();\n      },\n      // exit node on arrow down\n      ArrowDown: ({ editor }) => {\n        if (!this.options.exitOnArrowDown) {\n          return false;\n        }\n        const { state } = editor;\n        const { selection, doc } = state;\n        const { $from, empty } = selection;\n        if (!empty || $from.parent.type !== this.type) {\n          return false;\n        }\n        const isAtEnd = $from.parentOffset === $from.parent.nodeSize - 2;\n        if (!isAtEnd) {\n          return false;\n        }\n        const after = $from.after();\n        if (after === void 0) {\n          return false;\n        }\n        const nodeAfter = doc.nodeAt(after);\n        if (nodeAfter) {\n          return editor.commands.command(({ tr }) => {\n            tr.setSelection(Selection.near(doc.resolve(after)));\n            return true;\n          });\n        }\n        return editor.commands.exitCode();\n      }\n    };\n  },\n  addInputRules() {\n    return [\n      textblockTypeInputRule({\n        find: backtickInputRegex,\n        type: this.type,\n        getAttributes: (match) => ({\n          language: match[1]\n        })\n      }),\n      textblockTypeInputRule({\n        find: tildeInputRegex,\n        type: this.type,\n        getAttributes: (match) => ({\n          language: match[1]\n        })\n      })\n    ];\n  },\n  addProseMirrorPlugins() {\n    return [\n      // this plugin creates a code block for pasted content from VS Code\n      // we can also detect the copied code language\n      new Plugin({\n        key: new PluginKey(\"codeBlockVSCodeHandler\"),\n        props: {\n          handlePaste: (view, event) => {\n            if (!event.clipboardData) {\n              return false;\n            }\n            if (this.editor.isActive(this.type.name)) {\n              return false;\n            }\n            const text = event.clipboardData.getData(\"text/plain\");\n            const vscode = event.clipboardData.getData(\"vscode-editor-data\");\n            const vscodeData = vscode ? JSON.parse(vscode) : void 0;\n            const language = vscodeData == null ? void 0 : vscodeData.mode;\n            if (!text || !language) {\n              return false;\n            }\n            const { tr, schema } = view.state;\n            const textNode = schema.text(text.replace(/\\r\\n?/g, \"\\n\"));\n            tr.replaceSelectionWith(this.type.create({ language }, textNode));\n            if (tr.selection.$from.parent.type !== this.type) {\n              tr.setSelection(TextSelection.near(tr.doc.resolve(Math.max(0, tr.selection.from - 2))));\n            }\n            tr.setMeta(\"paste\", true);\n            view.dispatch(tr);\n            return true;\n          }\n        }\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = CodeBlock;\nexport {\n  CodeBlock,\n  backtickInputRegex,\n  index_default as default,\n  tildeInputRegex\n};\n//# sourceMappingURL=index.js.map","// src/document.ts\nimport { Node } from \"@tiptap/core\";\nvar Document = Node.create({\n  name: \"doc\",\n  topNode: true,\n  content: \"block+\",\n  renderMarkdown: (node, h) => {\n    if (!node.content) {\n      return \"\";\n    }\n    return h.renderChildren(node.content, \"\\n\\n\");\n  }\n});\n\n// src/index.ts\nvar index_default = Document;\nexport {\n  Document,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","// src/hard-break.ts\nimport { mergeAttributes, Node } from \"@tiptap/core\";\nvar HardBreak = Node.create({\n  name: \"hardBreak\",\n  markdownTokenName: \"br\",\n  addOptions() {\n    return {\n      keepMarks: true,\n      HTMLAttributes: {}\n    };\n  },\n  inline: true,\n  group: \"inline\",\n  selectable: false,\n  linebreakReplacement: true,\n  parseHTML() {\n    return [{ tag: \"br\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"br\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes)];\n  },\n  renderText() {\n    return \"\\n\";\n  },\n  renderMarkdown: () => `  \n`,\n  parseMarkdown: () => {\n    return {\n      type: \"hardBreak\"\n    };\n  },\n  addCommands() {\n    return {\n      setHardBreak: () => ({ commands, chain, state, editor }) => {\n        return commands.first([\n          () => commands.exitCode(),\n          () => commands.command(() => {\n            const { selection, storedMarks } = state;\n            if (selection.$from.parent.type.spec.isolating) {\n              return false;\n            }\n            const { keepMarks } = this.options;\n            const { splittableMarks } = editor.extensionManager;\n            const marks = storedMarks || selection.$to.parentOffset && selection.$from.marks();\n            return chain().insertContent({ type: this.name }).command(({ tr, dispatch }) => {\n              if (dispatch && marks && keepMarks) {\n                const filteredMarks = marks.filter((mark) => splittableMarks.includes(mark.type.name));\n                tr.ensureMarks(filteredMarks);\n              }\n              return true;\n            }).run();\n          })\n        ]);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Enter\": () => this.editor.commands.setHardBreak(),\n      \"Shift-Enter\": () => this.editor.commands.setHardBreak()\n    };\n  }\n});\n\n// src/index.ts\nvar index_default = HardBreak;\nexport {\n  HardBreak,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","// src/heading.ts\nimport { mergeAttributes, Node, textblockTypeInputRule } from \"@tiptap/core\";\nvar Heading = Node.create({\n  name: \"heading\",\n  addOptions() {\n    return {\n      levels: [1, 2, 3, 4, 5, 6],\n      HTMLAttributes: {}\n    };\n  },\n  content: \"inline*\",\n  group: \"block\",\n  defining: true,\n  addAttributes() {\n    return {\n      level: {\n        default: 1,\n        rendered: false\n      }\n    };\n  },\n  parseHTML() {\n    return this.options.levels.map((level) => ({\n      tag: `h${level}`,\n      attrs: { level }\n    }));\n  },\n  renderHTML({ node, HTMLAttributes }) {\n    const hasLevel = this.options.levels.includes(node.attrs.level);\n    const level = hasLevel ? node.attrs.level : this.options.levels[0];\n    return [`h${level}`, mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  parseMarkdown: (token, helpers) => {\n    return helpers.createNode(\"heading\", { level: token.depth || 1 }, helpers.parseInline(token.tokens || []));\n  },\n  renderMarkdown: (node, h) => {\n    var _a;\n    const level = ((_a = node.attrs) == null ? void 0 : _a.level) ? parseInt(node.attrs.level, 10) : 1;\n    const headingChars = \"#\".repeat(level);\n    if (!node.content) {\n      return \"\";\n    }\n    return `${headingChars} ${h.renderChildren(node.content)}`;\n  },\n  addCommands() {\n    return {\n      setHeading: (attributes) => ({ commands }) => {\n        if (!this.options.levels.includes(attributes.level)) {\n          return false;\n        }\n        return commands.setNode(this.name, attributes);\n      },\n      toggleHeading: (attributes) => ({ commands }) => {\n        if (!this.options.levels.includes(attributes.level)) {\n          return false;\n        }\n        return commands.toggleNode(this.name, \"paragraph\", attributes);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return this.options.levels.reduce(\n      (items, level) => ({\n        ...items,\n        ...{\n          [`Mod-Alt-${level}`]: () => this.editor.commands.toggleHeading({ level })\n        }\n      }),\n      {}\n    );\n  },\n  addInputRules() {\n    return this.options.levels.map((level) => {\n      return textblockTypeInputRule({\n        find: new RegExp(`^(#{${Math.min(...this.options.levels)},${level}})\\\\s$`),\n        type: this.type,\n        getAttributes: {\n          level\n        }\n      });\n    });\n  }\n});\n\n// src/index.ts\nvar index_default = Heading;\nexport {\n  Heading,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","// src/horizontal-rule.ts\nimport { canInsertNode, isNodeSelection, mergeAttributes, Node, nodeInputRule } from \"@tiptap/core\";\nimport { NodeSelection, TextSelection } from \"@tiptap/pm/state\";\nvar HorizontalRule = Node.create({\n  name: \"horizontalRule\",\n  addOptions() {\n    return {\n      HTMLAttributes: {},\n      nextNodeType: \"paragraph\"\n    };\n  },\n  group: \"block\",\n  parseHTML() {\n    return [{ tag: \"hr\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"hr\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes)];\n  },\n  markdownTokenName: \"hr\",\n  parseMarkdown: (token, helpers) => {\n    return helpers.createNode(\"horizontalRule\");\n  },\n  renderMarkdown: () => {\n    return \"---\";\n  },\n  addCommands() {\n    return {\n      setHorizontalRule: () => ({ chain, state }) => {\n        if (!canInsertNode(state, state.schema.nodes[this.name])) {\n          return false;\n        }\n        const { selection } = state;\n        const { $to: $originTo } = selection;\n        const currentChain = chain();\n        if (isNodeSelection(selection)) {\n          currentChain.insertContentAt($originTo.pos, {\n            type: this.name\n          });\n        } else {\n          currentChain.insertContent({ type: this.name });\n        }\n        return currentChain.command(({ state: chainState, tr, dispatch }) => {\n          if (dispatch) {\n            const { $to } = tr.selection;\n            const posAfter = $to.end();\n            if ($to.nodeAfter) {\n              if ($to.nodeAfter.isTextblock) {\n                tr.setSelection(TextSelection.create(tr.doc, $to.pos + 1));\n              } else if ($to.nodeAfter.isBlock) {\n                tr.setSelection(NodeSelection.create(tr.doc, $to.pos));\n              } else {\n                tr.setSelection(TextSelection.create(tr.doc, $to.pos));\n              }\n            } else {\n              const nodeType = chainState.schema.nodes[this.options.nextNodeType] || $to.parent.type.contentMatch.defaultType;\n              const node = nodeType == null ? void 0 : nodeType.create();\n              if (node) {\n                tr.insert(posAfter, node);\n                tr.setSelection(TextSelection.create(tr.doc, posAfter + 1));\n              }\n            }\n            tr.scrollIntoView();\n          }\n          return true;\n        }).run();\n      }\n    };\n  },\n  addInputRules() {\n    return [\n      nodeInputRule({\n        find: /^(?:---|—-|___\\s|\\*\\*\\*\\s)$/,\n        type: this.type\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = HorizontalRule;\nexport {\n  HorizontalRule,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","// src/italic.ts\nimport { Mark, markInputRule, markPasteRule, mergeAttributes } from \"@tiptap/core\";\nvar starInputRegex = /(?:^|\\s)(\\*(?!\\s+\\*)((?:[^*]+))\\*(?!\\s+\\*))$/;\nvar starPasteRegex = /(?:^|\\s)(\\*(?!\\s+\\*)((?:[^*]+))\\*(?!\\s+\\*))/g;\nvar underscoreInputRegex = /(?:^|\\s)(_(?!\\s+_)((?:[^_]+))_(?!\\s+_))$/;\nvar underscorePasteRegex = /(?:^|\\s)(_(?!\\s+_)((?:[^_]+))_(?!\\s+_))/g;\nvar Italic = Mark.create({\n  name: \"italic\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"em\"\n      },\n      {\n        tag: \"i\",\n        getAttrs: (node) => node.style.fontStyle !== \"normal\" && null\n      },\n      {\n        style: \"font-style=normal\",\n        clearMark: (mark) => mark.type.name === this.name\n      },\n      {\n        style: \"font-style=italic\"\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"em\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  addCommands() {\n    return {\n      setItalic: () => ({ commands }) => {\n        return commands.setMark(this.name);\n      },\n      toggleItalic: () => ({ commands }) => {\n        return commands.toggleMark(this.name);\n      },\n      unsetItalic: () => ({ commands }) => {\n        return commands.unsetMark(this.name);\n      }\n    };\n  },\n  markdownTokenName: \"em\",\n  parseMarkdown: (token, helpers) => {\n    return helpers.applyMark(\"italic\", helpers.parseInline(token.tokens || []));\n  },\n  renderMarkdown: (node, h) => {\n    return `*${h.renderChildren(node)}*`;\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-i\": () => this.editor.commands.toggleItalic(),\n      \"Mod-I\": () => this.editor.commands.toggleItalic()\n    };\n  },\n  addInputRules() {\n    return [\n      markInputRule({\n        find: starInputRegex,\n        type: this.type\n      }),\n      markInputRule({\n        find: underscoreInputRegex,\n        type: this.type\n      })\n    ];\n  },\n  addPasteRules() {\n    return [\n      markPasteRule({\n        find: starPasteRegex,\n        type: this.type\n      }),\n      markPasteRule({\n        find: underscorePasteRegex,\n        type: this.type\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = Italic;\nexport {\n  Italic,\n  index_default as default,\n  starInputRegex,\n  starPasteRegex,\n  underscoreInputRegex,\n  underscorePasteRegex\n};\n//# sourceMappingURL=index.js.map","// THIS FILE IS AUTOMATICALLY GENERATED DO NOT EDIT DIRECTLY\n// See update-tlds.js for encoding/decoding format\n// https://data.iana.org/TLD/tlds-alpha-by-domain.txt\nconst encodedTlds = 'aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2';\n// Internationalized domain names containing non-ASCII\nconst encodedUtlds = 'ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2';\n\n/**\n * Finite State Machine generation utilities\n */\n\n/**\n * @template T\n * @typedef {{ [group: string]: T[] }} Collections\n */\n\n/**\n * @typedef {{ [group: string]: true }} Flags\n */\n\n// Keys in scanner Collections instances\nconst numeric = 'numeric';\nconst ascii = 'ascii';\nconst alpha = 'alpha';\nconst asciinumeric = 'asciinumeric';\nconst alphanumeric = 'alphanumeric';\nconst domain = 'domain';\nconst emoji = 'emoji';\nconst scheme = 'scheme';\nconst slashscheme = 'slashscheme';\nconst whitespace = 'whitespace';\n\n/**\n * @template T\n * @param {string} name\n * @param {Collections<T>} groups to register in\n * @returns {T[]} Current list of tokens in the given collection\n */\nfunction registerGroup(name, groups) {\n  if (!(name in groups)) {\n    groups[name] = [];\n  }\n  return groups[name];\n}\n\n/**\n * @template T\n * @param {T} t token to add\n * @param {Collections<T>} groups\n * @param {Flags} flags\n */\nfunction addToGroups(t, flags, groups) {\n  if (flags[numeric]) {\n    flags[asciinumeric] = true;\n    flags[alphanumeric] = true;\n  }\n  if (flags[ascii]) {\n    flags[asciinumeric] = true;\n    flags[alpha] = true;\n  }\n  if (flags[asciinumeric]) {\n    flags[alphanumeric] = true;\n  }\n  if (flags[alpha]) {\n    flags[alphanumeric] = true;\n  }\n  if (flags[alphanumeric]) {\n    flags[domain] = true;\n  }\n  if (flags[emoji]) {\n    flags[domain] = true;\n  }\n  for (const k in flags) {\n    const group = registerGroup(k, groups);\n    if (group.indexOf(t) < 0) {\n      group.push(t);\n    }\n  }\n}\n\n/**\n * @template T\n * @param {T} t token to check\n * @param {Collections<T>} groups\n * @returns {Flags} group flags that contain this token\n */\nfunction flagsForToken(t, groups) {\n  const result = {};\n  for (const c in groups) {\n    if (groups[c].indexOf(t) >= 0) {\n      result[c] = true;\n    }\n  }\n  return result;\n}\n\n/**\n * @template T\n * @typedef {null | T } Transition\n */\n\n/**\n * Define a basic state machine state. j is the list of character transitions,\n * jr is the list of regex-match transitions, jd is the default state to\n * transition to t is the accepting token type, if any. If this is the terminal\n * state, then it does not emit a token.\n *\n * The template type T represents the type of the token this state accepts. This\n * should be a string (such as of the token exports in `text.js`) or a\n * MultiToken subclass (from `multi.js`)\n *\n * @template T\n * @param {T} [token] Token that this state emits\n */\nfunction State(token = null) {\n  // this.n = null; // DEBUG: State name\n  /** @type {{ [input: string]: State<T> }} j */\n  this.j = {}; // IMPLEMENTATION 1\n  // this.j = []; // IMPLEMENTATION 2\n  /** @type {[RegExp, State<T>][]} jr */\n  this.jr = [];\n  /** @type {?State<T>} jd */\n  this.jd = null;\n  /** @type {?T} t */\n  this.t = token;\n}\n\n/**\n * Scanner token groups\n * @type Collections<string>\n */\nState.groups = {};\nState.prototype = {\n  accepts() {\n    return !!this.t;\n  },\n  /**\n   * Follow an existing transition from the given input to the next state.\n   * Does not mutate.\n   * @param {string} input character or token type to transition on\n   * @returns {?State<T>} the next state, if any\n   */\n  go(input) {\n    const state = this;\n    const nextState = state.j[input];\n    if (nextState) {\n      return nextState;\n    }\n    for (let i = 0; i < state.jr.length; i++) {\n      const regex = state.jr[i][0];\n      const nextState = state.jr[i][1]; // note: might be empty to prevent default jump\n      if (nextState && regex.test(input)) {\n        return nextState;\n      }\n    }\n    // Nowhere left to jump! Return default, if any\n    return state.jd;\n  },\n  /**\n   * Whether the state has a transition for the given input. Set the second\n   * argument to true to only look for an exact match (and not a default or\n   * regular-expression-based transition)\n   * @param {string} input\n   * @param {boolean} exactOnly\n   */\n  has(input, exactOnly = false) {\n    return exactOnly ? input in this.j : !!this.go(input);\n  },\n  /**\n   * Short for \"transition all\"; create a transition from the array of items\n   * in the given list to the same final resulting state.\n   * @param {string | string[]} inputs Group of inputs to transition on\n   * @param {Transition<T> | State<T>} [next] Transition options\n   * @param {Flags} [flags] Collections flags to add token to\n   * @param {Collections<T>} [groups] Master list of token groups\n   */\n  ta(inputs, next, flags, groups) {\n    for (let i = 0; i < inputs.length; i++) {\n      this.tt(inputs[i], next, flags, groups);\n    }\n  },\n  /**\n   * Short for \"take regexp transition\"; defines a transition for this state\n   * when it encounters a token which matches the given regular expression\n   * @param {RegExp} regexp Regular expression transition (populate first)\n   * @param {T | State<T>} [next] Transition options\n   * @param {Flags} [flags] Collections flags to add token to\n   * @param {Collections<T>} [groups] Master list of token groups\n   * @returns {State<T>} taken after the given input\n   */\n  tr(regexp, next, flags, groups) {\n    groups = groups || State.groups;\n    let nextState;\n    if (next && next.j) {\n      nextState = next;\n    } else {\n      // Token with maybe token groups\n      nextState = new State(next);\n      if (flags && groups) {\n        addToGroups(next, flags, groups);\n      }\n    }\n    this.jr.push([regexp, nextState]);\n    return nextState;\n  },\n  /**\n   * Short for \"take transitions\", will take as many sequential transitions as\n   * the length of the given input and returns the\n   * resulting final state.\n   * @param {string | string[]} input\n   * @param {T | State<T>} [next] Transition options\n   * @param {Flags} [flags] Collections flags to add token to\n   * @param {Collections<T>} [groups] Master list of token groups\n   * @returns {State<T>} taken after the given input\n   */\n  ts(input, next, flags, groups) {\n    let state = this;\n    const len = input.length;\n    if (!len) {\n      return state;\n    }\n    for (let i = 0; i < len - 1; i++) {\n      state = state.tt(input[i]);\n    }\n    return state.tt(input[len - 1], next, flags, groups);\n  },\n  /**\n   * Short for \"take transition\", this is a method for building/working with\n   * state machines.\n   *\n   * If a state already exists for the given input, returns it.\n   *\n   * If a token is specified, that state will emit that token when reached by\n   * the linkify engine.\n   *\n   * If no state exists, it will be initialized with some default transitions\n   * that resemble existing default transitions.\n   *\n   * If a state is given for the second argument, that state will be\n   * transitioned to on the given input regardless of what that input\n   * previously did.\n   *\n   * Specify a token group flags to define groups that this token belongs to.\n   * The token will be added to corresponding entires in the given groups\n   * object.\n   *\n   * @param {string} input character, token type to transition on\n   * @param {T | State<T>} [next] Transition options\n   * @param {Flags} [flags] Collections flags to add token to\n   * @param {Collections<T>} [groups] Master list of groups\n   * @returns {State<T>} taken after the given input\n   */\n  tt(input, next, flags, groups) {\n    groups = groups || State.groups;\n    const state = this;\n\n    // Check if existing state given, just a basic transition\n    if (next && next.j) {\n      state.j[input] = next;\n      return next;\n    }\n    const t = next;\n\n    // Take the transition with the usual default mechanisms and use that as\n    // a template for creating the next state\n    let nextState,\n      templateState = state.go(input);\n    if (templateState) {\n      nextState = new State();\n      Object.assign(nextState.j, templateState.j);\n      nextState.jr.push.apply(nextState.jr, templateState.jr);\n      nextState.jd = templateState.jd;\n      nextState.t = templateState.t;\n    } else {\n      nextState = new State();\n    }\n    if (t) {\n      // Ensure newly token is in the same groups as the old token\n      if (groups) {\n        if (nextState.t && typeof nextState.t === 'string') {\n          const allFlags = Object.assign(flagsForToken(nextState.t, groups), flags);\n          addToGroups(t, allFlags, groups);\n        } else if (flags) {\n          addToGroups(t, flags, groups);\n        }\n      }\n      nextState.t = t; // overwrite anything that was previously there\n    }\n    state.j[input] = nextState;\n    return nextState;\n  }\n};\n\n// Helper functions to improve minification (not exported outside linkifyjs module)\n\n/**\n * @template T\n * @param {State<T>} state\n * @param {string | string[]} input\n * @param {Flags} [flags]\n * @param {Collections<T>} [groups]\n */\nconst ta = (state, input, next, flags, groups) => state.ta(input, next, flags, groups);\n\n/**\n * @template T\n * @param {State<T>} state\n * @param {RegExp} regexp\n * @param {T | State<T>} [next]\n * @param {Flags} [flags]\n * @param {Collections<T>} [groups]\n */\nconst tr = (state, regexp, next, flags, groups) => state.tr(regexp, next, flags, groups);\n\n/**\n * @template T\n * @param {State<T>} state\n * @param {string | string[]} input\n * @param {T | State<T>} [next]\n * @param {Flags} [flags]\n * @param {Collections<T>} [groups]\n */\nconst ts = (state, input, next, flags, groups) => state.ts(input, next, flags, groups);\n\n/**\n * @template T\n * @param {State<T>} state\n * @param {string} input\n * @param {T | State<T>} [next]\n * @param {Collections<T>} [groups]\n * @param {Flags} [flags]\n */\nconst tt = (state, input, next, flags, groups) => state.tt(input, next, flags, groups);\n\n/******************************************************************************\nText Tokens\nIdentifiers for token outputs from the regexp scanner\n******************************************************************************/\n\n// A valid web domain token\nconst WORD = 'WORD'; // only contains a-z\nconst UWORD = 'UWORD'; // contains letters other than a-z, used for IDN\nconst ASCIINUMERICAL = 'ASCIINUMERICAL'; // contains a-z, 0-9\nconst ALPHANUMERICAL = 'ALPHANUMERICAL'; // contains numbers and letters other than a-z, used for IDN\n\n// Special case of word\nconst LOCALHOST = 'LOCALHOST';\n\n// Valid top-level domain, special case of WORD (see tlds.js)\nconst TLD = 'TLD';\n\n// Valid IDN TLD, special case of UWORD (see tlds.js)\nconst UTLD = 'UTLD';\n\n// The scheme portion of a web URI protocol. Supported types include: `mailto`,\n// `file`, and user-defined custom protocols. Limited to schemes that contain\n// only letters\nconst SCHEME = 'SCHEME';\n\n// Similar to SCHEME, except makes distinction for schemes that must always be\n// followed by `://`, not just `:`. Supported types include `http`, `https`,\n// `ftp`, `ftps`\nconst SLASH_SCHEME = 'SLASH_SCHEME';\n\n// Any sequence of digits 0-9\nconst NUM = 'NUM';\n\n// Any number of consecutive whitespace characters that are not newline\nconst WS = 'WS';\n\n// New line (unix style)\nconst NL = 'NL'; // \\n\n\n// Opening/closing bracket classes\n// TODO: Rename OPEN -> LEFT and CLOSE -> RIGHT in v5 to fit with Unicode names\n// Also rename angle brackes to LESSTHAN and GREATER THAN\nconst OPENBRACE = 'OPENBRACE'; // {\nconst CLOSEBRACE = 'CLOSEBRACE'; // }\nconst OPENBRACKET = 'OPENBRACKET'; // [\nconst CLOSEBRACKET = 'CLOSEBRACKET'; // ]\nconst OPENPAREN = 'OPENPAREN'; // (\nconst CLOSEPAREN = 'CLOSEPAREN'; // )\nconst OPENANGLEBRACKET = 'OPENANGLEBRACKET'; // <\nconst CLOSEANGLEBRACKET = 'CLOSEANGLEBRACKET'; // >\nconst FULLWIDTHLEFTPAREN = 'FULLWIDTHLEFTPAREN'; // （\nconst FULLWIDTHRIGHTPAREN = 'FULLWIDTHRIGHTPAREN'; // ）\nconst LEFTCORNERBRACKET = 'LEFTCORNERBRACKET'; // 「\nconst RIGHTCORNERBRACKET = 'RIGHTCORNERBRACKET'; // 」\nconst LEFTWHITECORNERBRACKET = 'LEFTWHITECORNERBRACKET'; // 『\nconst RIGHTWHITECORNERBRACKET = 'RIGHTWHITECORNERBRACKET'; // 』\nconst FULLWIDTHLESSTHAN = 'FULLWIDTHLESSTHAN'; // ＜\nconst FULLWIDTHGREATERTHAN = 'FULLWIDTHGREATERTHAN'; // ＞\n\n// Various symbols\nconst AMPERSAND = 'AMPERSAND'; // &\nconst APOSTROPHE = 'APOSTROPHE'; // '\nconst ASTERISK = 'ASTERISK'; // *\nconst AT = 'AT'; // @\nconst BACKSLASH = 'BACKSLASH'; // \\\nconst BACKTICK = 'BACKTICK'; // `\nconst CARET = 'CARET'; // ^\nconst COLON = 'COLON'; // :\nconst COMMA = 'COMMA'; // ,\nconst DOLLAR = 'DOLLAR'; // $\nconst DOT = 'DOT'; // .\nconst EQUALS = 'EQUALS'; // =\nconst EXCLAMATION = 'EXCLAMATION'; // !\nconst HYPHEN = 'HYPHEN'; // -\nconst PERCENT = 'PERCENT'; // %\nconst PIPE = 'PIPE'; // |\nconst PLUS = 'PLUS'; // +\nconst POUND = 'POUND'; // #\nconst QUERY = 'QUERY'; // ?\nconst QUOTE = 'QUOTE'; // \"\nconst FULLWIDTHMIDDLEDOT = 'FULLWIDTHMIDDLEDOT'; // ・\n\nconst SEMI = 'SEMI'; // ;\nconst SLASH = 'SLASH'; // /\nconst TILDE = 'TILDE'; // ~\nconst UNDERSCORE = 'UNDERSCORE'; // _\n\n// Emoji symbol\nconst EMOJI$1 = 'EMOJI';\n\n// Default token - anything that is not one of the above\nconst SYM = 'SYM';\n\nvar tk = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tALPHANUMERICAL: ALPHANUMERICAL,\n\tAMPERSAND: AMPERSAND,\n\tAPOSTROPHE: APOSTROPHE,\n\tASCIINUMERICAL: ASCIINUMERICAL,\n\tASTERISK: ASTERISK,\n\tAT: AT,\n\tBACKSLASH: BACKSLASH,\n\tBACKTICK: BACKTICK,\n\tCARET: CARET,\n\tCLOSEANGLEBRACKET: CLOSEANGLEBRACKET,\n\tCLOSEBRACE: CLOSEBRACE,\n\tCLOSEBRACKET: CLOSEBRACKET,\n\tCLOSEPAREN: CLOSEPAREN,\n\tCOLON: COLON,\n\tCOMMA: COMMA,\n\tDOLLAR: DOLLAR,\n\tDOT: DOT,\n\tEMOJI: EMOJI$1,\n\tEQUALS: EQUALS,\n\tEXCLAMATION: EXCLAMATION,\n\tFULLWIDTHGREATERTHAN: FULLWIDTHGREATERTHAN,\n\tFULLWIDTHLEFTPAREN: FULLWIDTHLEFTPAREN,\n\tFULLWIDTHLESSTHAN: FULLWIDTHLESSTHAN,\n\tFULLWIDTHMIDDLEDOT: FULLWIDTHMIDDLEDOT,\n\tFULLWIDTHRIGHTPAREN: FULLWIDTHRIGHTPAREN,\n\tHYPHEN: HYPHEN,\n\tLEFTCORNERBRACKET: LEFTCORNERBRACKET,\n\tLEFTWHITECORNERBRACKET: LEFTWHITECORNERBRACKET,\n\tLOCALHOST: LOCALHOST,\n\tNL: NL,\n\tNUM: NUM,\n\tOPENANGLEBRACKET: OPENANGLEBRACKET,\n\tOPENBRACE: OPENBRACE,\n\tOPENBRACKET: OPENBRACKET,\n\tOPENPAREN: OPENPAREN,\n\tPERCENT: PERCENT,\n\tPIPE: PIPE,\n\tPLUS: PLUS,\n\tPOUND: POUND,\n\tQUERY: QUERY,\n\tQUOTE: QUOTE,\n\tRIGHTCORNERBRACKET: RIGHTCORNERBRACKET,\n\tRIGHTWHITECORNERBRACKET: RIGHTWHITECORNERBRACKET,\n\tSCHEME: SCHEME,\n\tSEMI: SEMI,\n\tSLASH: SLASH,\n\tSLASH_SCHEME: SLASH_SCHEME,\n\tSYM: SYM,\n\tTILDE: TILDE,\n\tTLD: TLD,\n\tUNDERSCORE: UNDERSCORE,\n\tUTLD: UTLD,\n\tUWORD: UWORD,\n\tWORD: WORD,\n\tWS: WS\n});\n\n// Note that these two Unicode ones expand into a really big one with Babel\nconst ASCII_LETTER = /[a-z]/;\nconst LETTER = /\\p{L}/u; // Any Unicode character with letter data type\nconst EMOJI = /\\p{Emoji}/u; // Any Unicode emoji character\nconst EMOJI_VARIATION$1 = /\\ufe0f/;\nconst DIGIT = /\\d/;\nconst SPACE = /\\s/;\n\nvar regexp = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tASCII_LETTER: ASCII_LETTER,\n\tDIGIT: DIGIT,\n\tEMOJI: EMOJI,\n\tEMOJI_VARIATION: EMOJI_VARIATION$1,\n\tLETTER: LETTER,\n\tSPACE: SPACE\n});\n\n/**\n\tThe scanner provides an interface that takes a string of text as input, and\n\toutputs an array of tokens instances that can be used for easy URL parsing.\n*/\n\nconst CR = '\\r'; // carriage-return character\nconst LF = '\\n'; // line-feed character\nconst EMOJI_VARIATION = '\\ufe0f'; // Variation selector, follows heart and others\nconst EMOJI_JOINER = '\\u200d'; // zero-width joiner\nconst OBJECT_REPLACEMENT = '\\ufffc'; // whitespace placeholder that sometimes appears in rich text editors\n\nlet tlds = null,\n  utlds = null; // don't change so only have to be computed once\n\n/**\n * Scanner output token:\n * - `t` is the token name (e.g., 'NUM', 'EMOJI', 'TLD')\n * - `v` is the value of the token (e.g., '123', '❤️', 'com')\n * - `s` is the start index of the token in the original string\n * - `e` is the end index of the token in the original string\n * @typedef {{t: string, v: string, s: number, e: number}} Token\n */\n\n/**\n * @template T\n * @typedef {{ [collection: string]: T[] }} Collections\n */\n\n/**\n * Initialize the scanner character-based state machine for the given start\n * state\n * @param {[string, boolean][]} customSchemes List of custom schemes, where each\n * item is a length-2 tuple with the first element set to the string scheme, and\n * the second element set to `true` if the `://` after the scheme is optional\n */\nfunction init$2(customSchemes = []) {\n  // Frequently used states (name argument removed during minification)\n  /** @type Collections<string> */\n  const groups = {}; // of tokens\n  State.groups = groups;\n  /** @type State<string> */\n  const Start = new State();\n  if (tlds == null) {\n    tlds = decodeTlds(encodedTlds);\n  }\n  if (utlds == null) {\n    utlds = decodeTlds(encodedUtlds);\n  }\n\n  // States for special URL symbols that accept immediately after start\n  tt(Start, \"'\", APOSTROPHE);\n  tt(Start, '{', OPENBRACE);\n  tt(Start, '}', CLOSEBRACE);\n  tt(Start, '[', OPENBRACKET);\n  tt(Start, ']', CLOSEBRACKET);\n  tt(Start, '(', OPENPAREN);\n  tt(Start, ')', CLOSEPAREN);\n  tt(Start, '<', OPENANGLEBRACKET);\n  tt(Start, '>', CLOSEANGLEBRACKET);\n  tt(Start, '（', FULLWIDTHLEFTPAREN);\n  tt(Start, '）', FULLWIDTHRIGHTPAREN);\n  tt(Start, '「', LEFTCORNERBRACKET);\n  tt(Start, '」', RIGHTCORNERBRACKET);\n  tt(Start, '『', LEFTWHITECORNERBRACKET);\n  tt(Start, '』', RIGHTWHITECORNERBRACKET);\n  tt(Start, '＜', FULLWIDTHLESSTHAN);\n  tt(Start, '＞', FULLWIDTHGREATERTHAN);\n  tt(Start, '&', AMPERSAND);\n  tt(Start, '*', ASTERISK);\n  tt(Start, '@', AT);\n  tt(Start, '`', BACKTICK);\n  tt(Start, '^', CARET);\n  tt(Start, ':', COLON);\n  tt(Start, ',', COMMA);\n  tt(Start, '$', DOLLAR);\n  tt(Start, '.', DOT);\n  tt(Start, '=', EQUALS);\n  tt(Start, '!', EXCLAMATION);\n  tt(Start, '-', HYPHEN);\n  tt(Start, '%', PERCENT);\n  tt(Start, '|', PIPE);\n  tt(Start, '+', PLUS);\n  tt(Start, '#', POUND);\n  tt(Start, '?', QUERY);\n  tt(Start, '\"', QUOTE);\n  tt(Start, '/', SLASH);\n  tt(Start, ';', SEMI);\n  tt(Start, '~', TILDE);\n  tt(Start, '_', UNDERSCORE);\n  tt(Start, '\\\\', BACKSLASH);\n  tt(Start, '・', FULLWIDTHMIDDLEDOT);\n  const Num = tr(Start, DIGIT, NUM, {\n    [numeric]: true\n  });\n  tr(Num, DIGIT, Num);\n  const Asciinumeric = tr(Num, ASCII_LETTER, ASCIINUMERICAL, {\n    [asciinumeric]: true\n  });\n  const Alphanumeric = tr(Num, LETTER, ALPHANUMERICAL, {\n    [alphanumeric]: true\n  });\n\n  // State which emits a word token\n  const Word = tr(Start, ASCII_LETTER, WORD, {\n    [ascii]: true\n  });\n  tr(Word, DIGIT, Asciinumeric);\n  tr(Word, ASCII_LETTER, Word);\n  tr(Asciinumeric, DIGIT, Asciinumeric);\n  tr(Asciinumeric, ASCII_LETTER, Asciinumeric);\n\n  // Same as previous, but specific to non-fsm.ascii alphabet words\n  const UWord = tr(Start, LETTER, UWORD, {\n    [alpha]: true\n  });\n  tr(UWord, ASCII_LETTER); // Non-accepting\n  tr(UWord, DIGIT, Alphanumeric);\n  tr(UWord, LETTER, UWord);\n  tr(Alphanumeric, DIGIT, Alphanumeric);\n  tr(Alphanumeric, ASCII_LETTER); // Non-accepting\n  tr(Alphanumeric, LETTER, Alphanumeric); // Non-accepting\n\n  // Whitespace jumps\n  // Tokens of only non-newline whitespace are arbitrarily long\n  // If any whitespace except newline, more whitespace!\n  const Nl = tt(Start, LF, NL, {\n    [whitespace]: true\n  });\n  const Cr = tt(Start, CR, WS, {\n    [whitespace]: true\n  });\n  const Ws = tr(Start, SPACE, WS, {\n    [whitespace]: true\n  });\n  tt(Start, OBJECT_REPLACEMENT, Ws);\n  tt(Cr, LF, Nl); // \\r\\n\n  tt(Cr, OBJECT_REPLACEMENT, Ws);\n  tr(Cr, SPACE, Ws);\n  tt(Ws, CR); // non-accepting state to avoid mixing whitespaces\n  tt(Ws, LF); // non-accepting state to avoid mixing whitespaces\n  tr(Ws, SPACE, Ws);\n  tt(Ws, OBJECT_REPLACEMENT, Ws);\n\n  // Emoji tokens. They are not grouped by the scanner except in cases where a\n  // zero-width joiner is present\n  const Emoji = tr(Start, EMOJI, EMOJI$1, {\n    [emoji]: true\n  });\n  tt(Emoji, '#'); // no transition, emoji regex seems to match #\n  tr(Emoji, EMOJI, Emoji);\n  tt(Emoji, EMOJI_VARIATION, Emoji);\n  // tt(Start, EMOJI_VARIATION, Emoji); // This one is sketchy\n\n  const EmojiJoiner = tt(Emoji, EMOJI_JOINER);\n  tt(EmojiJoiner, '#');\n  tr(EmojiJoiner, EMOJI, Emoji);\n  // tt(EmojiJoiner, EMOJI_VARIATION, Emoji); // also sketchy\n\n  // Generates states for top-level domains\n  // Note that this is most accurate when tlds are in alphabetical order\n  const wordjr = [[ASCII_LETTER, Word], [DIGIT, Asciinumeric]];\n  const uwordjr = [[ASCII_LETTER, null], [LETTER, UWord], [DIGIT, Alphanumeric]];\n  for (let i = 0; i < tlds.length; i++) {\n    fastts(Start, tlds[i], TLD, WORD, wordjr);\n  }\n  for (let i = 0; i < utlds.length; i++) {\n    fastts(Start, utlds[i], UTLD, UWORD, uwordjr);\n  }\n  addToGroups(TLD, {\n    tld: true,\n    ascii: true\n  }, groups);\n  addToGroups(UTLD, {\n    utld: true,\n    alpha: true\n  }, groups);\n\n  // Collect the states generated by different protocols. NOTE: If any new TLDs\n  // get added that are also protocols, set the token to be the same as the\n  // protocol to ensure parsing works as expected.\n  fastts(Start, 'file', SCHEME, WORD, wordjr);\n  fastts(Start, 'mailto', SCHEME, WORD, wordjr);\n  fastts(Start, 'http', SLASH_SCHEME, WORD, wordjr);\n  fastts(Start, 'https', SLASH_SCHEME, WORD, wordjr);\n  fastts(Start, 'ftp', SLASH_SCHEME, WORD, wordjr);\n  fastts(Start, 'ftps', SLASH_SCHEME, WORD, wordjr);\n  addToGroups(SCHEME, {\n    scheme: true,\n    ascii: true\n  }, groups);\n  addToGroups(SLASH_SCHEME, {\n    slashscheme: true,\n    ascii: true\n  }, groups);\n\n  // Register custom schemes. Assumes each scheme is asciinumeric with hyphens\n  customSchemes = customSchemes.sort((a, b) => a[0] > b[0] ? 1 : -1);\n  for (let i = 0; i < customSchemes.length; i++) {\n    const sch = customSchemes[i][0];\n    const optionalSlashSlash = customSchemes[i][1];\n    const flags = optionalSlashSlash ? {\n      [scheme]: true\n    } : {\n      [slashscheme]: true\n    };\n    if (sch.indexOf('-') >= 0) {\n      flags[domain] = true;\n    } else if (!ASCII_LETTER.test(sch)) {\n      flags[numeric] = true; // numbers only\n    } else if (DIGIT.test(sch)) {\n      flags[asciinumeric] = true;\n    } else {\n      flags[ascii] = true;\n    }\n    ts(Start, sch, sch, flags);\n  }\n\n  // Localhost token\n  ts(Start, 'localhost', LOCALHOST, {\n    ascii: true\n  });\n\n  // Set default transition for start state (some symbol)\n  Start.jd = new State(SYM);\n  return {\n    start: Start,\n    tokens: Object.assign({\n      groups\n    }, tk)\n  };\n}\n\n/**\n\tGiven a string, returns an array of TOKEN instances representing the\n\tcomposition of that string.\n\n\t@method run\n\t@param {State<string>} start scanner starting state\n\t@param {string} str input string to scan\n\t@return {Token[]} list of tokens, each with a type and value\n*/\nfunction run$1(start, str) {\n  // State machine is not case sensitive, so input is tokenized in lowercased\n  // form (still returns regular case). Uses selective `toLowerCase` because\n  // lowercasing the entire string causes the length and character position to\n  // vary in some non-English strings with V8-based runtimes.\n  const iterable = stringToArray(str.replace(/[A-Z]/g, c => c.toLowerCase()));\n  const charCount = iterable.length; // <= len if there are emojis, etc\n  const tokens = []; // return value\n\n  // cursor through the string itself, accounting for characters that have\n  // width with length 2 such as emojis\n  let cursor = 0;\n\n  // Cursor through the array-representation of the string\n  let charCursor = 0;\n\n  // Tokenize the string\n  while (charCursor < charCount) {\n    let state = start;\n    let nextState = null;\n    let tokenLength = 0;\n    let latestAccepting = null;\n    let sinceAccepts = -1;\n    let charsSinceAccepts = -1;\n    while (charCursor < charCount && (nextState = state.go(iterable[charCursor]))) {\n      state = nextState;\n\n      // Keep track of the latest accepting state\n      if (state.accepts()) {\n        sinceAccepts = 0;\n        charsSinceAccepts = 0;\n        latestAccepting = state;\n      } else if (sinceAccepts >= 0) {\n        sinceAccepts += iterable[charCursor].length;\n        charsSinceAccepts++;\n      }\n      tokenLength += iterable[charCursor].length;\n      cursor += iterable[charCursor].length;\n      charCursor++;\n    }\n\n    // Roll back to the latest accepting state\n    cursor -= sinceAccepts;\n    charCursor -= charsSinceAccepts;\n    tokenLength -= sinceAccepts;\n\n    // No more jumps, just make a new token from the last accepting one\n    tokens.push({\n      t: latestAccepting.t,\n      // token type/name\n      v: str.slice(cursor - tokenLength, cursor),\n      // string value\n      s: cursor - tokenLength,\n      // start index\n      e: cursor // end index (excluding)\n    });\n  }\n  return tokens;\n}\n\n/**\n * Convert a String to an Array of characters, taking into account that some\n * characters like emojis take up two string indexes.\n *\n * Adapted from core-js (MIT license)\n * https://github.com/zloirock/core-js/blob/2d69cf5f99ab3ea3463c395df81e5a15b68f49d9/packages/core-js/internals/string-multibyte.js\n *\n * @function stringToArray\n * @param {string} str\n * @returns {string[]}\n */\nfunction stringToArray(str) {\n  const result = [];\n  const len = str.length;\n  let index = 0;\n  while (index < len) {\n    let first = str.charCodeAt(index);\n    let second;\n    let char = first < 0xd800 || first > 0xdbff || index + 1 === len || (second = str.charCodeAt(index + 1)) < 0xdc00 || second > 0xdfff ? str[index] // single character\n    : str.slice(index, index + 2); // two-index characters\n    result.push(char);\n    index += char.length;\n  }\n  return result;\n}\n\n/**\n * Fast version of ts function for when transition defaults are well known\n * @param {State<string>} state\n * @param {string} input\n * @param {string} t\n * @param {string} defaultt\n * @param {[RegExp, State<string>][]} jr\n * @returns {State<string>}\n */\nfunction fastts(state, input, t, defaultt, jr) {\n  let next;\n  const len = input.length;\n  for (let i = 0; i < len - 1; i++) {\n    const char = input[i];\n    if (state.j[char]) {\n      next = state.j[char];\n    } else {\n      next = new State(defaultt);\n      next.jr = jr.slice();\n      state.j[char] = next;\n    }\n    state = next;\n  }\n  next = new State(t);\n  next.jr = jr.slice();\n  state.j[input[len - 1]] = next;\n  return next;\n}\n\n/**\n * Converts a string of Top-Level Domain names encoded in update-tlds.js back\n * into a list of strings.\n * @param {str} encoded encoded TLDs string\n * @returns {str[]} original TLDs list\n */\nfunction decodeTlds(encoded) {\n  const words = [];\n  const stack = [];\n  let i = 0;\n  let digits = '0123456789';\n  while (i < encoded.length) {\n    let popDigitCount = 0;\n    while (digits.indexOf(encoded[i + popDigitCount]) >= 0) {\n      popDigitCount++; // encountered some digits, have to pop to go one level up trie\n    }\n    if (popDigitCount > 0) {\n      words.push(stack.join('')); // whatever preceded the pop digits must be a word\n      for (let popCount = parseInt(encoded.substring(i, i + popDigitCount), 10); popCount > 0; popCount--) {\n        stack.pop();\n      }\n      i += popDigitCount;\n    } else {\n      stack.push(encoded[i]); // drop down a level into the trie\n      i++;\n    }\n  }\n  return words;\n}\n\n/**\n * An object where each key is a valid DOM Event Name such as `click` or `focus`\n * and each value is an event handler function.\n *\n * https://developer.mozilla.org/en-US/docs/Web/API/Element#events\n * @typedef {?{ [event: string]: Function }} EventListeners\n */\n\n/**\n * All formatted properties required to render a link, including `tagName`,\n * `attributes`, `content` and `eventListeners`.\n * @typedef {{ tagName: any, attributes: {[attr: string]: any}, content: string,\n * eventListeners: EventListeners }} IntermediateRepresentation\n */\n\n/**\n * Specify either an object described by the template type `O` or a function.\n *\n * The function takes a string value (usually the link's href attribute), the\n * link type (`'url'`, `'hashtag`', etc.) and an internal token representation\n * of the link. It should return an object of the template type `O`\n * @template O\n * @typedef {O | ((value: string, type: string, token: MultiToken) => O)} OptObj\n */\n\n/**\n * Specify either a function described by template type `F` or an object.\n *\n * Each key in the object should be a link type (`'url'`, `'hashtag`', etc.). Each\n * value should be a function with template type `F` that is called when the\n * corresponding link type is encountered.\n * @template F\n * @typedef {F | { [type: string]: F}} OptFn\n */\n\n/**\n * Specify either a value with template type `V`, a function that returns `V` or\n * an object where each value resolves to `V`.\n *\n * The function takes a string value (usually the link's href attribute), the\n * link type (`'url'`, `'hashtag`', etc.) and an internal token representation\n * of the link. It should return an object of the template type `V`\n *\n * For the object, each key should be a link type (`'url'`, `'hashtag`', etc.).\n * Each value should either have type `V` or a function that returns V. This\n * function similarly takes a string value and a token.\n *\n * Example valid types for `Opt<string>`:\n *\n * ```js\n * 'hello'\n * (value, type, token) => 'world'\n * { url: 'hello', email: (value, token) => 'world'}\n * ```\n * @template V\n * @typedef {V | ((value: string, type: string, token: MultiToken) => V) | { [type: string]: V | ((value: string, token: MultiToken) => V) }} Opt\n */\n\n/**\n * See available options: https://linkify.js.org/docs/options.html\n * @typedef {{\n * \tdefaultProtocol?: string,\n *  events?: OptObj<EventListeners>,\n * \tformat?: Opt<string>,\n * \tformatHref?: Opt<string>,\n * \tnl2br?: boolean,\n * \ttagName?: Opt<any>,\n * \ttarget?: Opt<string>,\n * \trel?: Opt<string>,\n * \tvalidate?: Opt<boolean>,\n * \ttruncate?: Opt<number>,\n * \tclassName?: Opt<string>,\n * \tattributes?: OptObj<({ [attr: string]: any })>,\n *  ignoreTags?: string[],\n * \trender?: OptFn<((ir: IntermediateRepresentation) => any)>\n * }} Opts\n */\n\n/**\n * @type Required<Opts>\n */\nconst defaults = {\n  defaultProtocol: 'http',\n  events: null,\n  format: noop,\n  formatHref: noop,\n  nl2br: false,\n  tagName: 'a',\n  target: null,\n  rel: null,\n  validate: true,\n  truncate: Infinity,\n  className: null,\n  attributes: null,\n  ignoreTags: [],\n  render: null\n};\n\n/**\n * Utility class for linkify interfaces to apply specified\n * {@link Opts formatting and rendering options}.\n *\n * @param {Opts | Options} [opts] Option value overrides.\n * @param {(ir: IntermediateRepresentation) => any} [defaultRender] (For\n *   internal use) default render function that determines how to generate an\n *   HTML element based on a link token's derived tagName, attributes and HTML.\n *   Similar to render option\n */\nfunction Options(opts, defaultRender = null) {\n  let o = Object.assign({}, defaults);\n  if (opts) {\n    o = Object.assign(o, opts instanceof Options ? opts.o : opts);\n  }\n\n  // Ensure all ignored tags are uppercase\n  const ignoredTags = o.ignoreTags;\n  const uppercaseIgnoredTags = [];\n  for (let i = 0; i < ignoredTags.length; i++) {\n    uppercaseIgnoredTags.push(ignoredTags[i].toUpperCase());\n  }\n  /** @protected */\n  this.o = o;\n  if (defaultRender) {\n    this.defaultRender = defaultRender;\n  }\n  this.ignoreTags = uppercaseIgnoredTags;\n}\nOptions.prototype = {\n  o: defaults,\n  /**\n   * @type string[]\n   */\n  ignoreTags: [],\n  /**\n   * @param {IntermediateRepresentation} ir\n   * @returns {any}\n   */\n  defaultRender(ir) {\n    return ir;\n  },\n  /**\n   * Returns true or false based on whether a token should be displayed as a\n   * link based on the user options.\n   * @param {MultiToken} token\n   * @returns {boolean}\n   */\n  check(token) {\n    return this.get('validate', token.toString(), token);\n  },\n  // Private methods\n\n  /**\n   * Resolve an option's value based on the value of the option and the given\n   * params. If operator and token are specified and the target option is\n   * callable, automatically calls the function with the given argument.\n   * @template {keyof Opts} K\n   * @param {K} key Name of option to use\n   * @param {string} [operator] will be passed to the target option if it's a\n   * function. If not specified, RAW function value gets returned\n   * @param {MultiToken} [token] The token from linkify.tokenize\n   * @returns {Opts[K] | any}\n   */\n  get(key, operator, token) {\n    const isCallable = operator != null;\n    let option = this.o[key];\n    if (!option) {\n      return option;\n    }\n    if (typeof option === 'object') {\n      option = token.t in option ? option[token.t] : defaults[key];\n      if (typeof option === 'function' && isCallable) {\n        option = option(operator, token);\n      }\n    } else if (typeof option === 'function' && isCallable) {\n      option = option(operator, token.t, token);\n    }\n    return option;\n  },\n  /**\n   * @template {keyof Opts} L\n   * @param {L} key Name of options object to use\n   * @param {string} [operator]\n   * @param {MultiToken} [token]\n   * @returns {Opts[L] | any}\n   */\n  getObj(key, operator, token) {\n    let obj = this.o[key];\n    if (typeof obj === 'function' && operator != null) {\n      obj = obj(operator, token.t, token);\n    }\n    return obj;\n  },\n  /**\n   * Convert the given token to a rendered element that may be added to the\n   * calling-interface's DOM\n   * @param {MultiToken} token Token to render to an HTML element\n   * @returns {any} Render result; e.g., HTML string, DOM element, React\n   *   Component, etc.\n   */\n  render(token) {\n    const ir = token.render(this); // intermediate representation\n    const renderFn = this.get('render', null, token) || this.defaultRender;\n    return renderFn(ir, token.t, token);\n  }\n};\nfunction noop(val) {\n  return val;\n}\n\nvar options = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tOptions: Options,\n\tdefaults: defaults\n});\n\n/******************************************************************************\n\tMulti-Tokens\n\tTokens composed of arrays of TextTokens\n******************************************************************************/\n\n/**\n * @param {string} value\n * @param {Token[]} tokens\n */\nfunction MultiToken(value, tokens) {\n  this.t = 'token';\n  this.v = value;\n  this.tk = tokens;\n}\n\n/**\n * Abstract class used for manufacturing tokens of text tokens. That is rather\n * than the value for a token being a small string of text, it's value an array\n * of text tokens.\n *\n * Used for grouping together URLs, emails, hashtags, and other potential\n * creations.\n * @class MultiToken\n * @property {string} t\n * @property {string} v\n * @property {Token[]} tk\n * @abstract\n */\nMultiToken.prototype = {\n  isLink: false,\n  /**\n   * Return the string this token represents.\n   * @return {string}\n   */\n  toString() {\n    return this.v;\n  },\n  /**\n   * What should the value for this token be in the `href` HTML attribute?\n   * Returns the `.toString` value by default.\n   * @param {string} [scheme]\n   * @return {string}\n   */\n  toHref(scheme) {\n    return this.toString();\n  },\n  /**\n   * @param {Options} options Formatting options\n   * @returns {string}\n   */\n  toFormattedString(options) {\n    const val = this.toString();\n    const truncate = options.get('truncate', val, this);\n    const formatted = options.get('format', val, this);\n    return truncate && formatted.length > truncate ? formatted.substring(0, truncate) + '…' : formatted;\n  },\n  /**\n   *\n   * @param {Options} options\n   * @returns {string}\n   */\n  toFormattedHref(options) {\n    return options.get('formatHref', this.toHref(options.get('defaultProtocol')), this);\n  },\n  /**\n   * The start index of this token in the original input string\n   * @returns {number}\n   */\n  startIndex() {\n    return this.tk[0].s;\n  },\n  /**\n   * The end index of this token in the original input string (up to this\n   * index but not including it)\n   * @returns {number}\n   */\n  endIndex() {\n    return this.tk[this.tk.length - 1].e;\n  },\n  /**\n  \tReturns an object  of relevant values for this token, which includes keys\n  \t* type - Kind of token ('url', 'email', etc.)\n  \t* value - Original text\n  \t* href - The value that should be added to the anchor tag's href\n  \t\tattribute\n  \t\t@method toObject\n  \t@param {string} [protocol] `'http'` by default\n  */\n  toObject(protocol = defaults.defaultProtocol) {\n    return {\n      type: this.t,\n      value: this.toString(),\n      isLink: this.isLink,\n      href: this.toHref(protocol),\n      start: this.startIndex(),\n      end: this.endIndex()\n    };\n  },\n  /**\n   *\n   * @param {Options} options Formatting option\n   */\n  toFormattedObject(options) {\n    return {\n      type: this.t,\n      value: this.toFormattedString(options),\n      isLink: this.isLink,\n      href: this.toFormattedHref(options),\n      start: this.startIndex(),\n      end: this.endIndex()\n    };\n  },\n  /**\n   * Whether this token should be rendered as a link according to the given options\n   * @param {Options} options\n   * @returns {boolean}\n   */\n  validate(options) {\n    return options.get('validate', this.toString(), this);\n  },\n  /**\n   * Return an object that represents how this link should be rendered.\n   * @param {Options} options Formattinng options\n   */\n  render(options) {\n    const token = this;\n    const href = this.toHref(options.get('defaultProtocol'));\n    const formattedHref = options.get('formatHref', href, this);\n    const tagName = options.get('tagName', href, token);\n    const content = this.toFormattedString(options);\n    const attributes = {};\n    const className = options.get('className', href, token);\n    const target = options.get('target', href, token);\n    const rel = options.get('rel', href, token);\n    const attrs = options.getObj('attributes', href, token);\n    const eventListeners = options.getObj('events', href, token);\n    attributes.href = formattedHref;\n    if (className) {\n      attributes.class = className;\n    }\n    if (target) {\n      attributes.target = target;\n    }\n    if (rel) {\n      attributes.rel = rel;\n    }\n    if (attrs) {\n      Object.assign(attributes, attrs);\n    }\n    return {\n      tagName,\n      attributes,\n      content,\n      eventListeners\n    };\n  }\n};\n\n/**\n * Create a new token that can be emitted by the parser state machine\n * @param {string} type readable type of the token\n * @param {object} props properties to assign or override, including isLink = true or false\n * @returns {new (value: string, tokens: Token[]) => MultiToken} new token class\n */\nfunction createTokenClass(type, props) {\n  class Token extends MultiToken {\n    constructor(value, tokens) {\n      super(value, tokens);\n      this.t = type;\n    }\n  }\n  for (const p in props) {\n    Token.prototype[p] = props[p];\n  }\n  Token.t = type;\n  return Token;\n}\n\n/**\n\tRepresents a list of tokens making up a valid email address\n*/\nconst Email = createTokenClass('email', {\n  isLink: true,\n  toHref() {\n    return 'mailto:' + this.toString();\n  }\n});\n\n/**\n\tRepresents some plain text\n*/\nconst Text = createTokenClass('text');\n\n/**\n\tMulti-linebreak token - represents a line break\n\t@class Nl\n*/\nconst Nl = createTokenClass('nl');\n\n/**\n\tRepresents a list of text tokens making up a valid URL\n\t@class Url\n*/\nconst Url = createTokenClass('url', {\n  isLink: true,\n  /**\n  \tLowercases relevant parts of the domain and adds the protocol if\n  \trequired. Note that this will not escape unsafe HTML characters in the\n  \tURL.\n  \t\t@param {string} [scheme] default scheme (e.g., 'https')\n  \t@return {string} the full href\n  */\n  toHref(scheme = defaults.defaultProtocol) {\n    // Check if already has a prefix scheme\n    return this.hasProtocol() ? this.v : `${scheme}://${this.v}`;\n  },\n  /**\n   * Check whether this URL token has a protocol\n   * @return {boolean}\n   */\n  hasProtocol() {\n    const tokens = this.tk;\n    return tokens.length >= 2 && tokens[0].t !== LOCALHOST && tokens[1].t === COLON;\n  }\n});\n\nvar multi = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tBase: MultiToken,\n\tEmail: Email,\n\tMultiToken: MultiToken,\n\tNl: Nl,\n\tText: Text,\n\tUrl: Url,\n\tcreateTokenClass: createTokenClass\n});\n\n/**\n\tNot exactly parser, more like the second-stage scanner (although we can\n\ttheoretically hotswap the code here with a real parser in the future... but\n\tfor a little URL-finding utility abstract syntax trees may be a little\n\toverkill).\n\n\tURL format: http://en.wikipedia.org/wiki/URI_scheme\n\tEmail format: http://en.wikipedia.org/wiki/EmailAddress (links to RFC in\n\treference)\n\n\t@module linkify\n\t@submodule parser\n\t@main run\n*/\n\nconst makeState = arg => new State(arg);\n\n/**\n * Generate the parser multi token-based state machine\n * @param {{ groups: Collections<string> }} tokens\n */\nfunction init$1({\n  groups\n}) {\n  // Types of characters the URL can definitely end in\n  const qsAccepting = groups.domain.concat([AMPERSAND, ASTERISK, AT, BACKSLASH, BACKTICK, CARET, DOLLAR, EQUALS, HYPHEN, NUM, PERCENT, PIPE, PLUS, POUND, SLASH, SYM, TILDE, UNDERSCORE]);\n\n  // Types of tokens that can follow a URL and be part of the query string\n  // but cannot be the very last characters\n  // Characters that cannot appear in the URL at all should be excluded\n  const qsNonAccepting = [APOSTROPHE, COLON, COMMA, DOT, EXCLAMATION, PERCENT, QUERY, QUOTE, SEMI, OPENANGLEBRACKET, CLOSEANGLEBRACKET, OPENBRACE, CLOSEBRACE, CLOSEBRACKET, OPENBRACKET, OPENPAREN, CLOSEPAREN, FULLWIDTHLEFTPAREN, FULLWIDTHRIGHTPAREN, LEFTCORNERBRACKET, RIGHTCORNERBRACKET, LEFTWHITECORNERBRACKET, RIGHTWHITECORNERBRACKET, FULLWIDTHLESSTHAN, FULLWIDTHGREATERTHAN];\n\n  // For addresses without the mailto prefix\n  // Tokens allowed in the localpart of the email\n  const localpartAccepting = [AMPERSAND, APOSTROPHE, ASTERISK, BACKSLASH, BACKTICK, CARET, DOLLAR, EQUALS, HYPHEN, OPENBRACE, CLOSEBRACE, PERCENT, PIPE, PLUS, POUND, QUERY, SLASH, SYM, TILDE, UNDERSCORE];\n\n  // The universal starting state.\n  /**\n   * @type State<Token>\n   */\n  const Start = makeState();\n  const Localpart = tt(Start, TILDE); // Local part of the email address\n  ta(Localpart, localpartAccepting, Localpart);\n  ta(Localpart, groups.domain, Localpart);\n  const Domain = makeState(),\n    Scheme = makeState(),\n    SlashScheme = makeState();\n  ta(Start, groups.domain, Domain); // parsed string ends with a potential domain name (A)\n  ta(Start, groups.scheme, Scheme); // e.g., 'mailto'\n  ta(Start, groups.slashscheme, SlashScheme); // e.g., 'http'\n\n  ta(Domain, localpartAccepting, Localpart);\n  ta(Domain, groups.domain, Domain);\n  const LocalpartAt = tt(Domain, AT); // Local part of the email address plus @\n\n  tt(Localpart, AT, LocalpartAt); // close to an email address now\n\n  // Local part of an email address can be e.g. 'http' or 'mailto'\n  tt(Scheme, AT, LocalpartAt);\n  tt(SlashScheme, AT, LocalpartAt);\n  const LocalpartDot = tt(Localpart, DOT); // Local part of the email address plus '.' (localpart cannot end in .)\n  ta(LocalpartDot, localpartAccepting, Localpart);\n  ta(LocalpartDot, groups.domain, Localpart);\n  const EmailDomain = makeState();\n  ta(LocalpartAt, groups.domain, EmailDomain); // parsed string starts with local email info + @ with a potential domain name\n  ta(EmailDomain, groups.domain, EmailDomain);\n  const EmailDomainDot = tt(EmailDomain, DOT); // domain followed by DOT\n  ta(EmailDomainDot, groups.domain, EmailDomain);\n  const Email$1 = makeState(Email); // Possible email address (could have more tlds)\n  ta(EmailDomainDot, groups.tld, Email$1);\n  ta(EmailDomainDot, groups.utld, Email$1);\n  tt(LocalpartAt, LOCALHOST, Email$1);\n\n  // Hyphen can jump back to a domain name\n  const EmailDomainHyphen = tt(EmailDomain, HYPHEN); // parsed string starts with local email info + @ with a potential domain name\n  tt(EmailDomainHyphen, HYPHEN, EmailDomainHyphen);\n  ta(EmailDomainHyphen, groups.domain, EmailDomain);\n  ta(Email$1, groups.domain, EmailDomain);\n  tt(Email$1, DOT, EmailDomainDot);\n  tt(Email$1, HYPHEN, EmailDomainHyphen);\n\n  // Final possible email states\n  const EmailColon = tt(Email$1, COLON); // URL followed by colon (potential port number here)\n  /*const EmailColonPort = */\n  ta(EmailColon, groups.numeric, Email); // URL followed by colon and port number\n\n  // Account for dots and hyphens. Hyphens are usually parts of domain names\n  // (but not TLDs)\n  const DomainHyphen = tt(Domain, HYPHEN); // domain followed by hyphen\n  const DomainDot = tt(Domain, DOT); // domain followed by DOT\n  tt(DomainHyphen, HYPHEN, DomainHyphen);\n  ta(DomainHyphen, groups.domain, Domain);\n  ta(DomainDot, localpartAccepting, Localpart);\n  ta(DomainDot, groups.domain, Domain);\n  const DomainDotTld = makeState(Url); // Simplest possible URL with no query string\n  ta(DomainDot, groups.tld, DomainDotTld);\n  ta(DomainDot, groups.utld, DomainDotTld);\n  ta(DomainDotTld, groups.domain, Domain);\n  ta(DomainDotTld, localpartAccepting, Localpart);\n  tt(DomainDotTld, DOT, DomainDot);\n  tt(DomainDotTld, HYPHEN, DomainHyphen);\n  tt(DomainDotTld, AT, LocalpartAt);\n  const DomainDotTldColon = tt(DomainDotTld, COLON); // URL followed by colon (potential port number here)\n  const DomainDotTldColonPort = makeState(Url); // TLD followed by a port number\n  ta(DomainDotTldColon, groups.numeric, DomainDotTldColonPort);\n\n  // Long URL with optional port and maybe query string\n  const Url$1 = makeState(Url);\n\n  // URL with extra symbols at the end, followed by an opening bracket\n  const UrlNonaccept = makeState(); // URL followed by some symbols (will not be part of the final URL)\n\n  // Query strings\n  ta(Url$1, qsAccepting, Url$1);\n  ta(Url$1, qsNonAccepting, UrlNonaccept);\n  ta(UrlNonaccept, qsAccepting, Url$1);\n  ta(UrlNonaccept, qsNonAccepting, UrlNonaccept);\n\n  // Become real URLs after `SLASH` or `COLON NUM SLASH`\n  // Here works with or without scheme:// prefix\n  tt(DomainDotTld, SLASH, Url$1);\n  tt(DomainDotTldColonPort, SLASH, Url$1);\n\n  // Note that domains that begin with schemes are treated slighly differently\n  const SchemeColon = tt(Scheme, COLON); // e.g., 'mailto:'\n  const SlashSchemeColon = tt(SlashScheme, COLON); // e.g., 'http:'\n  const SlashSchemeColonSlash = tt(SlashSchemeColon, SLASH); // e.g., 'http:/'\n\n  const UriPrefix = tt(SlashSchemeColonSlash, SLASH); // e.g., 'http://'\n\n  // Scheme states can transition to domain states\n  ta(Scheme, groups.domain, Domain);\n  tt(Scheme, DOT, DomainDot);\n  tt(Scheme, HYPHEN, DomainHyphen);\n  ta(SlashScheme, groups.domain, Domain);\n  tt(SlashScheme, DOT, DomainDot);\n  tt(SlashScheme, HYPHEN, DomainHyphen);\n\n  // Force URL with scheme prefix followed by anything sane\n  ta(SchemeColon, groups.domain, Url$1);\n  tt(SchemeColon, SLASH, Url$1);\n  tt(SchemeColon, QUERY, Url$1);\n  ta(UriPrefix, groups.domain, Url$1);\n  ta(UriPrefix, qsAccepting, Url$1);\n  tt(UriPrefix, SLASH, Url$1);\n  const bracketPairs = [[OPENBRACE, CLOSEBRACE],\n  // {}\n  [OPENBRACKET, CLOSEBRACKET],\n  // []\n  [OPENPAREN, CLOSEPAREN],\n  // ()\n  [OPENANGLEBRACKET, CLOSEANGLEBRACKET],\n  // <>\n  [FULLWIDTHLEFTPAREN, FULLWIDTHRIGHTPAREN],\n  // （）\n  [LEFTCORNERBRACKET, RIGHTCORNERBRACKET],\n  // 「」\n  [LEFTWHITECORNERBRACKET, RIGHTWHITECORNERBRACKET],\n  // 『』\n  [FULLWIDTHLESSTHAN, FULLWIDTHGREATERTHAN] // ＜＞\n  ];\n  for (let i = 0; i < bracketPairs.length; i++) {\n    const [OPEN, CLOSE] = bracketPairs[i];\n    const UrlOpen = tt(Url$1, OPEN); // URL followed by open bracket\n\n    // Continue not accepting for open brackets\n    tt(UrlNonaccept, OPEN, UrlOpen);\n\n    // Closing bracket component. This character WILL be included in the URL\n    tt(UrlOpen, CLOSE, Url$1);\n\n    // URL that beings with an opening bracket, followed by a symbols.\n    // Note that the final state can still be `UrlOpen` (if the URL has a\n    // single opening bracket for some reason).\n    const UrlOpenQ = makeState(Url);\n    ta(UrlOpen, qsAccepting, UrlOpenQ);\n    const UrlOpenSyms = makeState(); // UrlOpen followed by some symbols it cannot end it\n    ta(UrlOpen, qsNonAccepting);\n\n    // URL that begins with an opening bracket, followed by some symbols\n    ta(UrlOpenQ, qsAccepting, UrlOpenQ);\n    ta(UrlOpenQ, qsNonAccepting, UrlOpenSyms);\n    ta(UrlOpenSyms, qsAccepting, UrlOpenQ);\n    ta(UrlOpenSyms, qsNonAccepting, UrlOpenSyms);\n\n    // Close brace/bracket to become regular URL\n    tt(UrlOpenQ, CLOSE, Url$1);\n    tt(UrlOpenSyms, CLOSE, Url$1);\n  }\n  tt(Start, LOCALHOST, DomainDotTld); // localhost is a valid URL state\n  tt(Start, NL, Nl); // single new line\n\n  return {\n    start: Start,\n    tokens: tk\n  };\n}\n\n/**\n * Run the parser state machine on a list of scanned string-based tokens to\n * create a list of multi tokens, each of which represents a URL, email address,\n * plain text, etc.\n *\n * @param {State<MultiToken>} start parser start state\n * @param {string} input the original input used to generate the given tokens\n * @param {Token[]} tokens list of scanned tokens\n * @returns {MultiToken[]}\n */\nfunction run(start, input, tokens) {\n  let len = tokens.length;\n  let cursor = 0;\n  let multis = [];\n  let textTokens = [];\n  while (cursor < len) {\n    let state = start;\n    let secondState = null;\n    let nextState = null;\n    let multiLength = 0;\n    let latestAccepting = null;\n    let sinceAccepts = -1;\n    while (cursor < len && !(secondState = state.go(tokens[cursor].t))) {\n      // Starting tokens with nowhere to jump to.\n      // Consider these to be just plain text\n      textTokens.push(tokens[cursor++]);\n    }\n    while (cursor < len && (nextState = secondState || state.go(tokens[cursor].t))) {\n      // Get the next state\n      secondState = null;\n      state = nextState;\n\n      // Keep track of the latest accepting state\n      if (state.accepts()) {\n        sinceAccepts = 0;\n        latestAccepting = state;\n      } else if (sinceAccepts >= 0) {\n        sinceAccepts++;\n      }\n      cursor++;\n      multiLength++;\n    }\n    if (sinceAccepts < 0) {\n      // No accepting state was found, part of a regular text token add\n      // the first text token to the text tokens array and try again from\n      // the next\n      cursor -= multiLength;\n      if (cursor < len) {\n        textTokens.push(tokens[cursor]);\n        cursor++;\n      }\n    } else {\n      // Accepting state!\n      // First close off the textTokens (if available)\n      if (textTokens.length > 0) {\n        multis.push(initMultiToken(Text, input, textTokens));\n        textTokens = [];\n      }\n\n      // Roll back to the latest accepting state\n      cursor -= sinceAccepts;\n      multiLength -= sinceAccepts;\n\n      // Create a new multitoken\n      const Multi = latestAccepting.t;\n      const subtokens = tokens.slice(cursor - multiLength, cursor);\n      multis.push(initMultiToken(Multi, input, subtokens));\n    }\n  }\n\n  // Finally close off the textTokens (if available)\n  if (textTokens.length > 0) {\n    multis.push(initMultiToken(Text, input, textTokens));\n  }\n  return multis;\n}\n\n/**\n * Utility function for instantiating a new multitoken with all the relevant\n * fields during parsing.\n * @param {new (value: string, tokens: Token[]) => MultiToken} Multi class to instantiate\n * @param {string} input original input string\n * @param {Token[]} tokens consecutive tokens scanned from input string\n * @returns {MultiToken}\n */\nfunction initMultiToken(Multi, input, tokens) {\n  const startIdx = tokens[0].s;\n  const endIdx = tokens[tokens.length - 1].e;\n  const value = input.slice(startIdx, endIdx);\n  return new Multi(value, tokens);\n}\n\nconst warn = typeof console !== 'undefined' && console && console.warn || (() => {});\nconst warnAdvice = 'until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.';\n\n// Side-effect initialization state\nconst INIT = {\n  scanner: null,\n  parser: null,\n  tokenQueue: [],\n  pluginQueue: [],\n  customSchemes: [],\n  initialized: false\n};\n\n/**\n * @typedef {{\n * \tstart: State<string>,\n * \ttokens: { groups: Collections<string> } & typeof tk\n * }} ScannerInit\n */\n\n/**\n * @typedef {{\n * \tstart: State<MultiToken>,\n * \ttokens: typeof multi\n * }} ParserInit\n */\n\n/**\n * @typedef {(arg: { scanner: ScannerInit }) => void} TokenPlugin\n */\n\n/**\n * @typedef {(arg: { scanner: ScannerInit, parser: ParserInit }) => void} Plugin\n */\n\n/**\n * De-register all plugins and reset the internal state-machine. Used for\n * testing; not required in practice.\n * @private\n */\nfunction reset() {\n  State.groups = {};\n  INIT.scanner = null;\n  INIT.parser = null;\n  INIT.tokenQueue = [];\n  INIT.pluginQueue = [];\n  INIT.customSchemes = [];\n  INIT.initialized = false;\n  return INIT;\n}\n\n/**\n * Register a token plugin to allow the scanner to recognize additional token\n * types before the parser state machine is constructed from the results.\n * @param {string} name of plugin to register\n * @param {TokenPlugin} plugin function that accepts the scanner state machine\n * and available scanner tokens and collections and extends the state machine to\n * recognize additional tokens or groups.\n */\nfunction registerTokenPlugin(name, plugin) {\n  if (typeof plugin !== 'function') {\n    throw new Error(`linkifyjs: Invalid token plugin ${plugin} (expects function)`);\n  }\n  for (let i = 0; i < INIT.tokenQueue.length; i++) {\n    if (name === INIT.tokenQueue[i][0]) {\n      warn(`linkifyjs: token plugin \"${name}\" already registered - will be overwritten`);\n      INIT.tokenQueue[i] = [name, plugin];\n      return;\n    }\n  }\n  INIT.tokenQueue.push([name, plugin]);\n  if (INIT.initialized) {\n    warn(`linkifyjs: already initialized - will not register token plugin \"${name}\" ${warnAdvice}`);\n  }\n}\n\n/**\n * Register a linkify plugin\n * @param {string} name of plugin to register\n * @param {Plugin} plugin function that accepts the parser state machine and\n * extends the parser to recognize additional link types\n */\nfunction registerPlugin(name, plugin) {\n  if (typeof plugin !== 'function') {\n    throw new Error(`linkifyjs: Invalid plugin ${plugin} (expects function)`);\n  }\n  for (let i = 0; i < INIT.pluginQueue.length; i++) {\n    if (name === INIT.pluginQueue[i][0]) {\n      warn(`linkifyjs: plugin \"${name}\" already registered - will be overwritten`);\n      INIT.pluginQueue[i] = [name, plugin];\n      return;\n    }\n  }\n  INIT.pluginQueue.push([name, plugin]);\n  if (INIT.initialized) {\n    warn(`linkifyjs: already initialized - will not register plugin \"${name}\" ${warnAdvice}`);\n  }\n}\n\n/**\n * Detect URLs with the following additional protocol. Anything with format\n * \"protocol://...\" will be considered a link. If `optionalSlashSlash` is set to\n * `true`, anything with format \"protocol:...\" will be considered a link.\n * @param {string} scheme\n * @param {boolean} [optionalSlashSlash]\n */\nfunction registerCustomProtocol(scheme, optionalSlashSlash = false) {\n  if (INIT.initialized) {\n    warn(`linkifyjs: already initialized - will not register custom scheme \"${scheme}\" ${warnAdvice}`);\n  }\n  if (!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(scheme)) {\n    throw new Error(`linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or \"-\"\n2. Cannot start or end with \"-\"\n3. \"-\" cannot repeat`);\n  }\n  INIT.customSchemes.push([scheme, optionalSlashSlash]);\n}\n\n/**\n * Initialize the linkify state machine. Called automatically the first time\n * linkify is called on a string, but may be called manually as well.\n */\nfunction init() {\n  // Initialize scanner state machine and plugins\n  INIT.scanner = init$2(INIT.customSchemes);\n  for (let i = 0; i < INIT.tokenQueue.length; i++) {\n    INIT.tokenQueue[i][1]({\n      scanner: INIT.scanner\n    });\n  }\n\n  // Initialize parser state machine and plugins\n  INIT.parser = init$1(INIT.scanner.tokens);\n  for (let i = 0; i < INIT.pluginQueue.length; i++) {\n    INIT.pluginQueue[i][1]({\n      scanner: INIT.scanner,\n      parser: INIT.parser\n    });\n  }\n  INIT.initialized = true;\n  return INIT;\n}\n\n/**\n * Parse a string into tokens that represent linkable and non-linkable sub-components\n * @param {string} str\n * @return {MultiToken[]} tokens\n */\nfunction tokenize(str) {\n  if (!INIT.initialized) {\n    init();\n  }\n  return run(INIT.parser.start, str, run$1(INIT.scanner.start, str));\n}\ntokenize.scan = run$1; // for testing\n\n/**\n * Find a list of linkable items in the given string.\n * @param {string} str string to find links in\n * @param {string | Opts} [type] either formatting options or specific type of\n * links to find, e.g., 'url' or 'email'\n * @param {Opts} [opts] formatting options for final output. Cannot be specified\n * if opts already provided in `type` argument\n */\nfunction find(str, type = null, opts = null) {\n  if (type && typeof type === 'object') {\n    if (opts) {\n      throw Error(`linkifyjs: Invalid link type ${type}; must be a string`);\n    }\n    opts = type;\n    type = null;\n  }\n  const options = new Options(opts);\n  const tokens = tokenize(str);\n  const filtered = [];\n  for (let i = 0; i < tokens.length; i++) {\n    const token = tokens[i];\n    if (token.isLink && (!type || token.t === type) && options.check(token)) {\n      filtered.push(token.toFormattedObject(options));\n    }\n  }\n  return filtered;\n}\n\n/**\n * Is the given string valid linkable text of some sort. Note that this does not\n * trim the text for you.\n *\n * Optionally pass in a second `type` param, which is the type of link to test\n * for.\n *\n * For example,\n *\n *     linkify.test(str, 'email');\n *\n * Returns `true` if str is a valid email.\n * @param {string} str string to test for links\n * @param {string} [type] optional specific link type to look for\n * @returns boolean true/false\n */\nfunction test(str, type = null) {\n  const tokens = tokenize(str);\n  return tokens.length === 1 && tokens[0].isLink && (!type || tokens[0].t === type);\n}\n\nexport { MultiToken, Options, State, createTokenClass, find, init, multi, options, regexp, registerCustomProtocol, registerPlugin, registerTokenPlugin, reset, stringToArray, test, multi as text, tokenize };\n","// src/link.ts\nimport { Mark, markPasteRule, mergeAttributes } from \"@tiptap/core\";\nimport { find as find2, registerCustomProtocol, reset } from \"linkifyjs\";\n\n// src/helpers/autolink.ts\nimport { combineTransactionSteps, findChildrenInRange, getChangedRanges, getMarksBetween } from \"@tiptap/core\";\nimport { Plugin, PluginKey } from \"@tiptap/pm/state\";\nimport { tokenize } from \"linkifyjs\";\n\n// src/helpers/whitespace.ts\nvar UNICODE_WHITESPACE_PATTERN = \"[\\0- \\xA0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]\";\nvar UNICODE_WHITESPACE_REGEX = new RegExp(UNICODE_WHITESPACE_PATTERN);\nvar UNICODE_WHITESPACE_REGEX_END = new RegExp(`${UNICODE_WHITESPACE_PATTERN}$`);\nvar UNICODE_WHITESPACE_REGEX_GLOBAL = new RegExp(UNICODE_WHITESPACE_PATTERN, \"g\");\n\n// src/helpers/autolink.ts\nfunction isValidLinkStructure(tokens) {\n  if (tokens.length === 1) {\n    return tokens[0].isLink;\n  }\n  if (tokens.length === 3 && tokens[1].isLink) {\n    return [\"()\", \"[]\"].includes(tokens[0].value + tokens[2].value);\n  }\n  return false;\n}\nfunction autolink(options) {\n  return new Plugin({\n    key: new PluginKey(\"autolink\"),\n    appendTransaction: (transactions, oldState, newState) => {\n      const docChanges = transactions.some((transaction) => transaction.docChanged) && !oldState.doc.eq(newState.doc);\n      const preventAutolink = transactions.some((transaction) => transaction.getMeta(\"preventAutolink\"));\n      if (!docChanges || preventAutolink) {\n        return;\n      }\n      const { tr } = newState;\n      const transform = combineTransactionSteps(oldState.doc, [...transactions]);\n      const changes = getChangedRanges(transform);\n      changes.forEach(({ newRange }) => {\n        const nodesInChangedRanges = findChildrenInRange(newState.doc, newRange, (node) => node.isTextblock);\n        let textBlock;\n        let textBeforeWhitespace;\n        if (nodesInChangedRanges.length > 1) {\n          textBlock = nodesInChangedRanges[0];\n          textBeforeWhitespace = newState.doc.textBetween(\n            textBlock.pos,\n            textBlock.pos + textBlock.node.nodeSize,\n            void 0,\n            \" \"\n          );\n        } else if (nodesInChangedRanges.length) {\n          const endText = newState.doc.textBetween(newRange.from, newRange.to, \" \", \" \");\n          if (!UNICODE_WHITESPACE_REGEX_END.test(endText)) {\n            return;\n          }\n          textBlock = nodesInChangedRanges[0];\n          textBeforeWhitespace = newState.doc.textBetween(textBlock.pos, newRange.to, void 0, \" \");\n        }\n        if (textBlock && textBeforeWhitespace) {\n          const wordsBeforeWhitespace = textBeforeWhitespace.split(UNICODE_WHITESPACE_REGEX).filter(Boolean);\n          if (wordsBeforeWhitespace.length <= 0) {\n            return false;\n          }\n          const lastWordBeforeSpace = wordsBeforeWhitespace[wordsBeforeWhitespace.length - 1];\n          const lastWordAndBlockOffset = textBlock.pos + textBeforeWhitespace.lastIndexOf(lastWordBeforeSpace);\n          if (!lastWordBeforeSpace) {\n            return false;\n          }\n          const linksBeforeSpace = tokenize(lastWordBeforeSpace).map((t) => t.toObject(options.defaultProtocol));\n          if (!isValidLinkStructure(linksBeforeSpace)) {\n            return false;\n          }\n          linksBeforeSpace.filter((link) => link.isLink).map((link) => ({\n            ...link,\n            from: lastWordAndBlockOffset + link.start + 1,\n            to: lastWordAndBlockOffset + link.end + 1\n          })).filter((link) => {\n            if (!newState.schema.marks.code) {\n              return true;\n            }\n            return !newState.doc.rangeHasMark(link.from, link.to, newState.schema.marks.code);\n          }).filter((link) => options.validate(link.value)).filter((link) => options.shouldAutoLink(link.value)).forEach((link) => {\n            if (getMarksBetween(link.from, link.to, newState.doc).some((item) => item.mark.type === options.type)) {\n              return;\n            }\n            tr.addMark(\n              link.from,\n              link.to,\n              options.type.create({\n                href: link.href\n              })\n            );\n          });\n        }\n      });\n      if (!tr.steps.length) {\n        return;\n      }\n      return tr;\n    }\n  });\n}\n\n// src/helpers/clickHandler.ts\nimport { getAttributes } from \"@tiptap/core\";\nimport { Plugin as Plugin2, PluginKey as PluginKey2 } from \"@tiptap/pm/state\";\nfunction clickHandler(options) {\n  return new Plugin2({\n    key: new PluginKey2(\"handleClickLink\"),\n    props: {\n      handleClick: (view, pos, event) => {\n        var _a, _b;\n        if (event.button !== 0) {\n          return false;\n        }\n        if (!view.editable) {\n          return false;\n        }\n        let link = null;\n        if (event.target instanceof HTMLAnchorElement) {\n          link = event.target;\n        } else {\n          const target = event.target;\n          if (!target) {\n            return false;\n          }\n          const root = options.editor.view.dom;\n          link = target.closest(\"a\");\n          if (link && !root.contains(link)) {\n            link = null;\n          }\n        }\n        if (!link) {\n          return false;\n        }\n        let handled = false;\n        if (options.enableClickSelection) {\n          const commandResult = options.editor.commands.extendMarkRange(options.type.name);\n          handled = commandResult;\n        }\n        if (options.openOnClick) {\n          const attrs = getAttributes(view.state, options.type.name);\n          const href = (_a = link.href) != null ? _a : attrs.href;\n          const target = (_b = link.target) != null ? _b : attrs.target;\n          if (href) {\n            window.open(href, target);\n            handled = true;\n          }\n        }\n        return handled;\n      }\n    }\n  });\n}\n\n// src/helpers/pasteHandler.ts\nimport { Plugin as Plugin3, PluginKey as PluginKey3 } from \"@tiptap/pm/state\";\nimport { find } from \"linkifyjs\";\nfunction pasteHandler(options) {\n  return new Plugin3({\n    key: new PluginKey3(\"handlePasteLink\"),\n    props: {\n      handlePaste: (view, _event, slice) => {\n        const { shouldAutoLink } = options;\n        const { state } = view;\n        const { selection } = state;\n        const { empty } = selection;\n        if (empty) {\n          return false;\n        }\n        let textContent = \"\";\n        slice.content.forEach((node) => {\n          textContent += node.textContent;\n        });\n        const link = find(textContent, { defaultProtocol: options.defaultProtocol }).find(\n          (item) => item.isLink && item.value === textContent\n        );\n        if (!textContent || !link || shouldAutoLink !== void 0 && !shouldAutoLink(link.value)) {\n          return false;\n        }\n        return options.editor.commands.setMark(options.type, {\n          href: link.href\n        });\n      }\n    }\n  });\n}\n\n// src/link.ts\nvar pasteRegex = /https?:\\/\\/(?:www\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z]{2,}\\b(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)/gi;\nfunction isAllowedUri(uri, protocols) {\n  const allowedProtocols = [\"http\", \"https\", \"ftp\", \"ftps\", \"mailto\", \"tel\", \"callto\", \"sms\", \"cid\", \"xmpp\"];\n  if (protocols) {\n    protocols.forEach((protocol) => {\n      const nextProtocol = typeof protocol === \"string\" ? protocol : protocol.scheme;\n      if (nextProtocol) {\n        allowedProtocols.push(nextProtocol);\n      }\n    });\n  }\n  return !uri || uri.replace(UNICODE_WHITESPACE_REGEX_GLOBAL, \"\").match(\n    new RegExp(\n      // eslint-disable-next-line no-useless-escape\n      `^(?:(?:${allowedProtocols.join(\"|\")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,\n      \"i\"\n    )\n  );\n}\nvar Link = Mark.create({\n  name: \"link\",\n  priority: 1e3,\n  keepOnSplit: false,\n  exitable: true,\n  onCreate() {\n    if (this.options.validate && !this.options.shouldAutoLink) {\n      this.options.shouldAutoLink = this.options.validate;\n      console.warn(\"The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.\");\n    }\n    this.options.protocols.forEach((protocol) => {\n      if (typeof protocol === \"string\") {\n        registerCustomProtocol(protocol);\n        return;\n      }\n      registerCustomProtocol(protocol.scheme, protocol.optionalSlashes);\n    });\n  },\n  onDestroy() {\n    reset();\n  },\n  inclusive() {\n    return this.options.autolink;\n  },\n  addOptions() {\n    return {\n      openOnClick: true,\n      enableClickSelection: false,\n      linkOnPaste: true,\n      autolink: true,\n      protocols: [],\n      defaultProtocol: \"http\",\n      HTMLAttributes: {\n        target: \"_blank\",\n        rel: \"noopener noreferrer nofollow\",\n        class: null\n      },\n      isAllowedUri: (url, ctx) => !!isAllowedUri(url, ctx.protocols),\n      validate: (url) => !!url,\n      shouldAutoLink: (url) => {\n        const hasProtocol = /^[a-z][a-z0-9+.-]*:\\/\\//i.test(url);\n        const hasMaybeProtocol = /^[a-z][a-z0-9+.-]*:/i.test(url);\n        if (hasProtocol || hasMaybeProtocol && !url.includes(\"@\")) {\n          return true;\n        }\n        const urlWithoutUserinfo = url.includes(\"@\") ? url.split(\"@\").pop() : url;\n        const hostname = urlWithoutUserinfo.split(/[/?#:]/)[0];\n        if (/^\\d{1,3}(\\.\\d{1,3}){3}$/.test(hostname)) {\n          return false;\n        }\n        if (!/\\./.test(hostname)) {\n          return false;\n        }\n        return true;\n      }\n    };\n  },\n  addAttributes() {\n    return {\n      href: {\n        default: null,\n        parseHTML(element) {\n          return element.getAttribute(\"href\");\n        }\n      },\n      target: {\n        default: this.options.HTMLAttributes.target\n      },\n      rel: {\n        default: this.options.HTMLAttributes.rel\n      },\n      class: {\n        default: this.options.HTMLAttributes.class\n      },\n      title: {\n        default: null\n      }\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"a[href]\",\n        getAttrs: (dom) => {\n          const href = dom.getAttribute(\"href\");\n          if (!href || !this.options.isAllowedUri(href, {\n            defaultValidate: (url) => !!isAllowedUri(url, this.options.protocols),\n            protocols: this.options.protocols,\n            defaultProtocol: this.options.defaultProtocol\n          })) {\n            return false;\n          }\n          return null;\n        }\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    if (!this.options.isAllowedUri(HTMLAttributes.href, {\n      defaultValidate: (href) => !!isAllowedUri(href, this.options.protocols),\n      protocols: this.options.protocols,\n      defaultProtocol: this.options.defaultProtocol\n    })) {\n      return [\"a\", mergeAttributes(this.options.HTMLAttributes, { ...HTMLAttributes, href: \"\" }), 0];\n    }\n    return [\"a\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  markdownTokenName: \"link\",\n  parseMarkdown: (token, helpers) => {\n    return helpers.applyMark(\"link\", helpers.parseInline(token.tokens || []), {\n      href: token.href,\n      title: token.title || null\n    });\n  },\n  renderMarkdown: (node, h) => {\n    var _a, _b, _c, _d;\n    const href = (_b = (_a = node.attrs) == null ? void 0 : _a.href) != null ? _b : \"\";\n    const title = (_d = (_c = node.attrs) == null ? void 0 : _c.title) != null ? _d : \"\";\n    const text = h.renderChildren(node);\n    return title ? `[${text}](${href} \"${title}\")` : `[${text}](${href})`;\n  },\n  addCommands() {\n    return {\n      setLink: (attributes) => ({ chain }) => {\n        const { href } = attributes;\n        if (!this.options.isAllowedUri(href, {\n          defaultValidate: (url) => !!isAllowedUri(url, this.options.protocols),\n          protocols: this.options.protocols,\n          defaultProtocol: this.options.defaultProtocol\n        })) {\n          return false;\n        }\n        return chain().setMark(this.name, attributes).setMeta(\"preventAutolink\", true).run();\n      },\n      toggleLink: (attributes) => ({ chain }) => {\n        const { href } = attributes || {};\n        if (href && !this.options.isAllowedUri(href, {\n          defaultValidate: (url) => !!isAllowedUri(url, this.options.protocols),\n          protocols: this.options.protocols,\n          defaultProtocol: this.options.defaultProtocol\n        })) {\n          return false;\n        }\n        return chain().toggleMark(this.name, attributes, { extendEmptyMarkRange: true }).setMeta(\"preventAutolink\", true).run();\n      },\n      unsetLink: () => ({ chain }) => {\n        return chain().unsetMark(this.name, { extendEmptyMarkRange: true }).setMeta(\"preventAutolink\", true).run();\n      }\n    };\n  },\n  addPasteRules() {\n    return [\n      markPasteRule({\n        find: (text) => {\n          const foundLinks = [];\n          if (text) {\n            const { protocols, defaultProtocol } = this.options;\n            const links = find2(text).filter(\n              (item) => item.isLink && this.options.isAllowedUri(item.value, {\n                defaultValidate: (href) => !!isAllowedUri(href, protocols),\n                protocols,\n                defaultProtocol\n              })\n            );\n            if (links.length) {\n              links.forEach((link) => {\n                if (!this.options.shouldAutoLink(link.value)) {\n                  return;\n                }\n                foundLinks.push({\n                  text: link.value,\n                  data: {\n                    href: link.href\n                  },\n                  index: link.start\n                });\n              });\n            }\n          }\n          return foundLinks;\n        },\n        type: this.type,\n        getAttributes: (match) => {\n          var _a;\n          return {\n            href: (_a = match.data) == null ? void 0 : _a.href\n          };\n        }\n      })\n    ];\n  },\n  addProseMirrorPlugins() {\n    const plugins = [];\n    const { protocols, defaultProtocol } = this.options;\n    if (this.options.autolink) {\n      plugins.push(\n        autolink({\n          type: this.type,\n          defaultProtocol: this.options.defaultProtocol,\n          validate: (url) => this.options.isAllowedUri(url, {\n            defaultValidate: (href) => !!isAllowedUri(href, protocols),\n            protocols,\n            defaultProtocol\n          }),\n          shouldAutoLink: this.options.shouldAutoLink\n        })\n      );\n    }\n    plugins.push(\n      clickHandler({\n        type: this.type,\n        editor: this.editor,\n        openOnClick: this.options.openOnClick === \"whenNotEditable\" ? true : this.options.openOnClick,\n        enableClickSelection: this.options.enableClickSelection\n      })\n    );\n    if (this.options.linkOnPaste) {\n      plugins.push(\n        pasteHandler({\n          editor: this.editor,\n          defaultProtocol: this.options.defaultProtocol,\n          type: this.type,\n          shouldAutoLink: this.options.shouldAutoLink\n        })\n      );\n    }\n    return plugins;\n  }\n});\n\n// src/index.ts\nvar index_default = Link;\nexport {\n  Link,\n  index_default as default,\n  isAllowedUri,\n  pasteRegex\n};\n//# sourceMappingURL=index.js.map","var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// src/bullet-list/bullet-list.ts\nimport { mergeAttributes, Node, wrappingInputRule } from \"@tiptap/core\";\nvar ListItemName = \"listItem\";\nvar TextStyleName = \"textStyle\";\nvar bulletListInputRegex = /^\\s*([-+*])\\s$/;\nvar BulletList = Node.create({\n  name: \"bulletList\",\n  addOptions() {\n    return {\n      itemTypeName: \"listItem\",\n      HTMLAttributes: {},\n      keepMarks: false,\n      keepAttributes: false\n    };\n  },\n  group: \"block list\",\n  content() {\n    return `${this.options.itemTypeName}+`;\n  },\n  parseHTML() {\n    return [{ tag: \"ul\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"ul\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  markdownTokenName: \"list\",\n  parseMarkdown: (token, helpers) => {\n    if (token.type !== \"list\" || token.ordered) {\n      return [];\n    }\n    return {\n      type: \"bulletList\",\n      content: token.items ? helpers.parseChildren(token.items) : []\n    };\n  },\n  renderMarkdown: (node, h) => {\n    if (!node.content) {\n      return \"\";\n    }\n    return h.renderChildren(node.content, \"\\n\");\n  },\n  markdownOptions: {\n    indentsContent: true\n  },\n  addCommands() {\n    return {\n      toggleBulletList: () => ({ commands, chain }) => {\n        if (this.options.keepAttributes) {\n          return chain().toggleList(this.name, this.options.itemTypeName, this.options.keepMarks).updateAttributes(ListItemName, this.editor.getAttributes(TextStyleName)).run();\n        }\n        return commands.toggleList(this.name, this.options.itemTypeName, this.options.keepMarks);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Shift-8\": () => this.editor.commands.toggleBulletList()\n    };\n  },\n  addInputRules() {\n    let inputRule = wrappingInputRule({\n      find: bulletListInputRegex,\n      type: this.type\n    });\n    if (this.options.keepMarks || this.options.keepAttributes) {\n      inputRule = wrappingInputRule({\n        find: bulletListInputRegex,\n        type: this.type,\n        keepMarks: this.options.keepMarks,\n        keepAttributes: this.options.keepAttributes,\n        getAttributes: () => {\n          return this.editor.getAttributes(TextStyleName);\n        },\n        editor: this.editor\n      });\n    }\n    return [inputRule];\n  }\n});\n\n// src/item/list-item.ts\nimport { mergeAttributes as mergeAttributes2, Node as Node2, renderNestedMarkdownContent } from \"@tiptap/core\";\nvar ListItem = Node2.create({\n  name: \"listItem\",\n  addOptions() {\n    return {\n      HTMLAttributes: {},\n      bulletListTypeName: \"bulletList\",\n      orderedListTypeName: \"orderedList\"\n    };\n  },\n  content: \"paragraph block*\",\n  defining: true,\n  parseHTML() {\n    return [\n      {\n        tag: \"li\"\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"li\", mergeAttributes2(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  markdownTokenName: \"list_item\",\n  parseMarkdown: (token, helpers) => {\n    if (token.type !== \"list_item\") {\n      return [];\n    }\n    let content = [];\n    if (token.tokens && token.tokens.length > 0) {\n      const hasParagraphTokens = token.tokens.some((t) => t.type === \"paragraph\");\n      if (hasParagraphTokens) {\n        content = helpers.parseChildren(token.tokens);\n      } else {\n        const firstToken = token.tokens[0];\n        if (firstToken && firstToken.type === \"text\" && firstToken.tokens && firstToken.tokens.length > 0) {\n          const inlineContent = helpers.parseInline(firstToken.tokens);\n          content = [\n            {\n              type: \"paragraph\",\n              content: inlineContent\n            }\n          ];\n          if (token.tokens.length > 1) {\n            const remainingTokens = token.tokens.slice(1);\n            const additionalContent = helpers.parseChildren(remainingTokens);\n            content.push(...additionalContent);\n          }\n        } else {\n          content = helpers.parseChildren(token.tokens);\n        }\n      }\n    }\n    if (content.length === 0) {\n      content = [\n        {\n          type: \"paragraph\",\n          content: []\n        }\n      ];\n    }\n    return {\n      type: \"listItem\",\n      content\n    };\n  },\n  renderMarkdown: (node, h, ctx) => {\n    return renderNestedMarkdownContent(\n      node,\n      h,\n      (context) => {\n        var _a, _b;\n        if (context.parentType === \"bulletList\") {\n          return \"- \";\n        }\n        if (context.parentType === \"orderedList\") {\n          const start = ((_b = (_a = context.meta) == null ? void 0 : _a.parentAttrs) == null ? void 0 : _b.start) || 1;\n          return `${start + context.index}. `;\n        }\n        return \"- \";\n      },\n      ctx\n    );\n  },\n  addKeyboardShortcuts() {\n    return {\n      Enter: () => this.editor.commands.splitListItem(this.name),\n      Tab: () => this.editor.commands.sinkListItem(this.name),\n      \"Shift-Tab\": () => this.editor.commands.liftListItem(this.name)\n    };\n  }\n});\n\n// src/keymap/list-keymap.ts\nimport { Extension } from \"@tiptap/core\";\n\n// src/keymap/listHelpers/index.ts\nvar listHelpers_exports = {};\n__export(listHelpers_exports, {\n  findListItemPos: () => findListItemPos,\n  getNextListDepth: () => getNextListDepth,\n  handleBackspace: () => handleBackspace,\n  handleDelete: () => handleDelete,\n  hasListBefore: () => hasListBefore,\n  hasListItemAfter: () => hasListItemAfter,\n  hasListItemBefore: () => hasListItemBefore,\n  listItemHasSubList: () => listItemHasSubList,\n  nextListIsDeeper: () => nextListIsDeeper,\n  nextListIsHigher: () => nextListIsHigher\n});\n\n// src/keymap/listHelpers/findListItemPos.ts\nimport { getNodeType } from \"@tiptap/core\";\nvar findListItemPos = (typeOrName, state) => {\n  const { $from } = state.selection;\n  const nodeType = getNodeType(typeOrName, state.schema);\n  let currentNode = null;\n  let currentDepth = $from.depth;\n  let currentPos = $from.pos;\n  let targetDepth = null;\n  while (currentDepth > 0 && targetDepth === null) {\n    currentNode = $from.node(currentDepth);\n    if (currentNode.type === nodeType) {\n      targetDepth = currentDepth;\n    } else {\n      currentDepth -= 1;\n      currentPos -= 1;\n    }\n  }\n  if (targetDepth === null) {\n    return null;\n  }\n  return { $pos: state.doc.resolve(currentPos), depth: targetDepth };\n};\n\n// src/keymap/listHelpers/getNextListDepth.ts\nimport { getNodeAtPosition } from \"@tiptap/core\";\nvar getNextListDepth = (typeOrName, state) => {\n  const listItemPos = findListItemPos(typeOrName, state);\n  if (!listItemPos) {\n    return false;\n  }\n  const [, depth] = getNodeAtPosition(state, typeOrName, listItemPos.$pos.pos + 4);\n  return depth;\n};\n\n// src/keymap/listHelpers/handleBackspace.ts\nimport { isAtStartOfNode, isNodeActive } from \"@tiptap/core\";\n\n// src/keymap/listHelpers/hasListBefore.ts\nvar hasListBefore = (editorState, name, parentListTypes) => {\n  const { $anchor } = editorState.selection;\n  const previousNodePos = Math.max(0, $anchor.pos - 2);\n  const previousNode = editorState.doc.resolve(previousNodePos).node();\n  if (!previousNode || !parentListTypes.includes(previousNode.type.name)) {\n    return false;\n  }\n  return true;\n};\n\n// src/keymap/listHelpers/hasListItemBefore.ts\nvar hasListItemBefore = (typeOrName, state) => {\n  var _a;\n  const { $anchor } = state.selection;\n  const $targetPos = state.doc.resolve($anchor.pos - 2);\n  if ($targetPos.index() === 0) {\n    return false;\n  }\n  if (((_a = $targetPos.nodeBefore) == null ? void 0 : _a.type.name) !== typeOrName) {\n    return false;\n  }\n  return true;\n};\n\n// src/keymap/listHelpers/listItemHasSubList.ts\nimport { getNodeType as getNodeType2 } from \"@tiptap/core\";\nvar listItemHasSubList = (typeOrName, state, node) => {\n  if (!node) {\n    return false;\n  }\n  const nodeType = getNodeType2(typeOrName, state.schema);\n  let hasSubList = false;\n  node.descendants((child) => {\n    if (child.type === nodeType) {\n      hasSubList = true;\n    }\n  });\n  return hasSubList;\n};\n\n// src/keymap/listHelpers/handleBackspace.ts\nvar handleBackspace = (editor, name, parentListTypes) => {\n  if (editor.commands.undoInputRule()) {\n    return true;\n  }\n  if (editor.state.selection.from !== editor.state.selection.to) {\n    return false;\n  }\n  if (!isNodeActive(editor.state, name) && hasListBefore(editor.state, name, parentListTypes)) {\n    const { $anchor } = editor.state.selection;\n    const $listPos = editor.state.doc.resolve($anchor.before() - 1);\n    const listDescendants = [];\n    $listPos.node().descendants((node, pos) => {\n      if (node.type.name === name) {\n        listDescendants.push({ node, pos });\n      }\n    });\n    const lastItem = listDescendants.at(-1);\n    if (!lastItem) {\n      return false;\n    }\n    const $lastItemPos = editor.state.doc.resolve($listPos.start() + lastItem.pos + 1);\n    return editor.chain().cut({ from: $anchor.start() - 1, to: $anchor.end() + 1 }, $lastItemPos.end()).joinForward().run();\n  }\n  if (!isNodeActive(editor.state, name)) {\n    return false;\n  }\n  if (!isAtStartOfNode(editor.state)) {\n    return false;\n  }\n  const listItemPos = findListItemPos(name, editor.state);\n  if (!listItemPos) {\n    return false;\n  }\n  const $prev = editor.state.doc.resolve(listItemPos.$pos.pos - 2);\n  const prevNode = $prev.node(listItemPos.depth);\n  const previousListItemHasSubList = listItemHasSubList(name, editor.state, prevNode);\n  if (hasListItemBefore(name, editor.state) && !previousListItemHasSubList) {\n    return editor.commands.joinItemBackward();\n  }\n  return editor.chain().liftListItem(name).run();\n};\n\n// src/keymap/listHelpers/handleDelete.ts\nimport { isAtEndOfNode, isNodeActive as isNodeActive2 } from \"@tiptap/core\";\n\n// src/keymap/listHelpers/nextListIsDeeper.ts\nvar nextListIsDeeper = (typeOrName, state) => {\n  const listDepth = getNextListDepth(typeOrName, state);\n  const listItemPos = findListItemPos(typeOrName, state);\n  if (!listItemPos || !listDepth) {\n    return false;\n  }\n  if (listDepth > listItemPos.depth) {\n    return true;\n  }\n  return false;\n};\n\n// src/keymap/listHelpers/nextListIsHigher.ts\nvar nextListIsHigher = (typeOrName, state) => {\n  const listDepth = getNextListDepth(typeOrName, state);\n  const listItemPos = findListItemPos(typeOrName, state);\n  if (!listItemPos || !listDepth) {\n    return false;\n  }\n  if (listDepth < listItemPos.depth) {\n    return true;\n  }\n  return false;\n};\n\n// src/keymap/listHelpers/handleDelete.ts\nvar handleDelete = (editor, name) => {\n  if (!isNodeActive2(editor.state, name)) {\n    return false;\n  }\n  if (!isAtEndOfNode(editor.state, name)) {\n    return false;\n  }\n  const { selection } = editor.state;\n  const { $from, $to } = selection;\n  if (!selection.empty && $from.sameParent($to)) {\n    return false;\n  }\n  if (nextListIsDeeper(name, editor.state)) {\n    return editor.chain().focus(editor.state.selection.from + 4).lift(name).joinBackward().run();\n  }\n  if (nextListIsHigher(name, editor.state)) {\n    return editor.chain().joinForward().joinBackward().run();\n  }\n  return editor.commands.joinItemForward();\n};\n\n// src/keymap/listHelpers/hasListItemAfter.ts\nvar hasListItemAfter = (typeOrName, state) => {\n  var _a;\n  const { $anchor } = state.selection;\n  const $targetPos = state.doc.resolve($anchor.pos - $anchor.parentOffset - 2);\n  if ($targetPos.index() === $targetPos.parent.childCount - 1) {\n    return false;\n  }\n  if (((_a = $targetPos.nodeAfter) == null ? void 0 : _a.type.name) !== typeOrName) {\n    return false;\n  }\n  return true;\n};\n\n// src/keymap/list-keymap.ts\nvar ListKeymap = Extension.create({\n  name: \"listKeymap\",\n  addOptions() {\n    return {\n      listTypes: [\n        {\n          itemName: \"listItem\",\n          wrapperNames: [\"bulletList\", \"orderedList\"]\n        },\n        {\n          itemName: \"taskItem\",\n          wrapperNames: [\"taskList\"]\n        }\n      ]\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      Delete: ({ editor }) => {\n        let handled = false;\n        this.options.listTypes.forEach(({ itemName }) => {\n          if (editor.state.schema.nodes[itemName] === void 0) {\n            return;\n          }\n          if (handleDelete(editor, itemName)) {\n            handled = true;\n          }\n        });\n        return handled;\n      },\n      \"Mod-Delete\": ({ editor }) => {\n        let handled = false;\n        this.options.listTypes.forEach(({ itemName }) => {\n          if (editor.state.schema.nodes[itemName] === void 0) {\n            return;\n          }\n          if (handleDelete(editor, itemName)) {\n            handled = true;\n          }\n        });\n        return handled;\n      },\n      Backspace: ({ editor }) => {\n        let handled = false;\n        this.options.listTypes.forEach(({ itemName, wrapperNames }) => {\n          if (editor.state.schema.nodes[itemName] === void 0) {\n            return;\n          }\n          if (handleBackspace(editor, itemName, wrapperNames)) {\n            handled = true;\n          }\n        });\n        return handled;\n      },\n      \"Mod-Backspace\": ({ editor }) => {\n        let handled = false;\n        this.options.listTypes.forEach(({ itemName, wrapperNames }) => {\n          if (editor.state.schema.nodes[itemName] === void 0) {\n            return;\n          }\n          if (handleBackspace(editor, itemName, wrapperNames)) {\n            handled = true;\n          }\n        });\n        return handled;\n      }\n    };\n  }\n});\n\n// src/kit/index.ts\nimport { Extension as Extension2 } from \"@tiptap/core\";\n\n// src/ordered-list/ordered-list.ts\nimport { mergeAttributes as mergeAttributes3, Node as Node3, wrappingInputRule as wrappingInputRule2 } from \"@tiptap/core\";\n\n// src/ordered-list/utils.ts\nvar ORDERED_LIST_ITEM_REGEX = /^(\\s*)(\\d+)\\.\\s+(.*)$/;\nvar INDENTED_LINE_REGEX = /^\\s/;\nfunction collectOrderedListItems(lines) {\n  const listItems = [];\n  let currentLineIndex = 0;\n  let consumed = 0;\n  while (currentLineIndex < lines.length) {\n    const line = lines[currentLineIndex];\n    const match = line.match(ORDERED_LIST_ITEM_REGEX);\n    if (!match) {\n      break;\n    }\n    const [, indent, number, content] = match;\n    const indentLevel = indent.length;\n    let itemContent = content;\n    let nextLineIndex = currentLineIndex + 1;\n    const itemLines = [line];\n    while (nextLineIndex < lines.length) {\n      const nextLine = lines[nextLineIndex];\n      const nextMatch = nextLine.match(ORDERED_LIST_ITEM_REGEX);\n      if (nextMatch) {\n        break;\n      }\n      if (nextLine.trim() === \"\") {\n        itemLines.push(nextLine);\n        itemContent += \"\\n\";\n        nextLineIndex += 1;\n      } else if (nextLine.match(INDENTED_LINE_REGEX)) {\n        itemLines.push(nextLine);\n        itemContent += `\n${nextLine.slice(indentLevel + 2)}`;\n        nextLineIndex += 1;\n      } else {\n        break;\n      }\n    }\n    listItems.push({\n      indent: indentLevel,\n      number: parseInt(number, 10),\n      content: itemContent.trim(),\n      raw: itemLines.join(\"\\n\")\n    });\n    consumed = nextLineIndex;\n    currentLineIndex = nextLineIndex;\n  }\n  return [listItems, consumed];\n}\nfunction buildNestedStructure(items, baseIndent, lexer) {\n  var _a;\n  const result = [];\n  let currentIndex = 0;\n  while (currentIndex < items.length) {\n    const item = items[currentIndex];\n    if (item.indent === baseIndent) {\n      const contentLines = item.content.split(\"\\n\");\n      const mainText = ((_a = contentLines[0]) == null ? void 0 : _a.trim()) || \"\";\n      const tokens = [];\n      if (mainText) {\n        tokens.push({\n          type: \"paragraph\",\n          raw: mainText,\n          tokens: lexer.inlineTokens(mainText)\n        });\n      }\n      const additionalContent = contentLines.slice(1).join(\"\\n\").trim();\n      if (additionalContent) {\n        const blockTokens = lexer.blockTokens(additionalContent);\n        tokens.push(...blockTokens);\n      }\n      let lookAheadIndex = currentIndex + 1;\n      const nestedItems = [];\n      while (lookAheadIndex < items.length && items[lookAheadIndex].indent > baseIndent) {\n        nestedItems.push(items[lookAheadIndex]);\n        lookAheadIndex += 1;\n      }\n      if (nestedItems.length > 0) {\n        const nextIndent = Math.min(...nestedItems.map((nestedItem) => nestedItem.indent));\n        const nestedListItems = buildNestedStructure(nestedItems, nextIndent, lexer);\n        tokens.push({\n          type: \"list\",\n          ordered: true,\n          start: nestedItems[0].number,\n          items: nestedListItems,\n          raw: nestedItems.map((nestedItem) => nestedItem.raw).join(\"\\n\")\n        });\n      }\n      result.push({\n        type: \"list_item\",\n        raw: item.raw,\n        tokens\n      });\n      currentIndex = lookAheadIndex;\n    } else {\n      currentIndex += 1;\n    }\n  }\n  return result;\n}\nfunction parseListItems(items, helpers) {\n  return items.map((item) => {\n    if (item.type !== \"list_item\") {\n      return helpers.parseChildren([item])[0];\n    }\n    const content = [];\n    if (item.tokens && item.tokens.length > 0) {\n      item.tokens.forEach((itemToken) => {\n        if (itemToken.type === \"paragraph\" || itemToken.type === \"list\" || itemToken.type === \"blockquote\" || itemToken.type === \"code\") {\n          content.push(...helpers.parseChildren([itemToken]));\n        } else if (itemToken.type === \"text\" && itemToken.tokens) {\n          const inlineContent = helpers.parseChildren([itemToken]);\n          content.push({\n            type: \"paragraph\",\n            content: inlineContent\n          });\n        } else {\n          const parsed = helpers.parseChildren([itemToken]);\n          if (parsed.length > 0) {\n            content.push(...parsed);\n          }\n        }\n      });\n    }\n    return {\n      type: \"listItem\",\n      content\n    };\n  });\n}\n\n// src/ordered-list/ordered-list.ts\nvar ListItemName2 = \"listItem\";\nvar TextStyleName2 = \"textStyle\";\nvar orderedListInputRegex = /^(\\d+)\\.\\s$/;\nvar OrderedList = Node3.create({\n  name: \"orderedList\",\n  addOptions() {\n    return {\n      itemTypeName: \"listItem\",\n      HTMLAttributes: {},\n      keepMarks: false,\n      keepAttributes: false\n    };\n  },\n  group: \"block list\",\n  content() {\n    return `${this.options.itemTypeName}+`;\n  },\n  addAttributes() {\n    return {\n      start: {\n        default: 1,\n        parseHTML: (element) => {\n          return element.hasAttribute(\"start\") ? parseInt(element.getAttribute(\"start\") || \"\", 10) : 1;\n        }\n      },\n      type: {\n        default: null,\n        parseHTML: (element) => element.getAttribute(\"type\")\n      }\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"ol\"\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    const { start, ...attributesWithoutStart } = HTMLAttributes;\n    return start === 1 ? [\"ol\", mergeAttributes3(this.options.HTMLAttributes, attributesWithoutStart), 0] : [\"ol\", mergeAttributes3(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  markdownTokenName: \"list\",\n  parseMarkdown: (token, helpers) => {\n    if (token.type !== \"list\" || !token.ordered) {\n      return [];\n    }\n    const startValue = token.start || 1;\n    const content = token.items ? parseListItems(token.items, helpers) : [];\n    if (startValue !== 1) {\n      return {\n        type: \"orderedList\",\n        attrs: { start: startValue },\n        content\n      };\n    }\n    return {\n      type: \"orderedList\",\n      content\n    };\n  },\n  renderMarkdown: (node, h) => {\n    if (!node.content) {\n      return \"\";\n    }\n    return h.renderChildren(node.content, \"\\n\");\n  },\n  markdownTokenizer: {\n    name: \"orderedList\",\n    level: \"block\",\n    start: (src) => {\n      const match = src.match(/^(\\s*)(\\d+)\\.\\s+/);\n      const index = match == null ? void 0 : match.index;\n      return index !== void 0 ? index : -1;\n    },\n    tokenize: (src, _tokens, lexer) => {\n      var _a;\n      const lines = src.split(\"\\n\");\n      const [listItems, consumed] = collectOrderedListItems(lines);\n      if (listItems.length === 0) {\n        return void 0;\n      }\n      const items = buildNestedStructure(listItems, 0, lexer);\n      if (items.length === 0) {\n        return void 0;\n      }\n      const startValue = ((_a = listItems[0]) == null ? void 0 : _a.number) || 1;\n      return {\n        type: \"list\",\n        ordered: true,\n        start: startValue,\n        items,\n        raw: lines.slice(0, consumed).join(\"\\n\")\n      };\n    }\n  },\n  markdownOptions: {\n    indentsContent: true\n  },\n  addCommands() {\n    return {\n      toggleOrderedList: () => ({ commands, chain }) => {\n        if (this.options.keepAttributes) {\n          return chain().toggleList(this.name, this.options.itemTypeName, this.options.keepMarks).updateAttributes(ListItemName2, this.editor.getAttributes(TextStyleName2)).run();\n        }\n        return commands.toggleList(this.name, this.options.itemTypeName, this.options.keepMarks);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Shift-7\": () => this.editor.commands.toggleOrderedList()\n    };\n  },\n  addInputRules() {\n    let inputRule = wrappingInputRule2({\n      find: orderedListInputRegex,\n      type: this.type,\n      getAttributes: (match) => ({ start: +match[1] }),\n      joinPredicate: (match, node) => node.childCount + node.attrs.start === +match[1]\n    });\n    if (this.options.keepMarks || this.options.keepAttributes) {\n      inputRule = wrappingInputRule2({\n        find: orderedListInputRegex,\n        type: this.type,\n        keepMarks: this.options.keepMarks,\n        keepAttributes: this.options.keepAttributes,\n        getAttributes: (match) => ({ start: +match[1], ...this.editor.getAttributes(TextStyleName2) }),\n        joinPredicate: (match, node) => node.childCount + node.attrs.start === +match[1],\n        editor: this.editor\n      });\n    }\n    return [inputRule];\n  }\n});\n\n// src/task-item/task-item.ts\nimport {\n  getRenderedAttributes,\n  mergeAttributes as mergeAttributes4,\n  Node as Node4,\n  renderNestedMarkdownContent as renderNestedMarkdownContent2,\n  wrappingInputRule as wrappingInputRule3\n} from \"@tiptap/core\";\nvar inputRegex = /^\\s*(\\[([( |x])?\\])\\s$/;\nvar TaskItem = Node4.create({\n  name: \"taskItem\",\n  addOptions() {\n    return {\n      nested: false,\n      HTMLAttributes: {},\n      taskListTypeName: \"taskList\",\n      a11y: void 0\n    };\n  },\n  content() {\n    return this.options.nested ? \"paragraph block*\" : \"paragraph+\";\n  },\n  defining: true,\n  addAttributes() {\n    return {\n      checked: {\n        default: false,\n        keepOnSplit: false,\n        parseHTML: (element) => {\n          const dataChecked = element.getAttribute(\"data-checked\");\n          return dataChecked === \"\" || dataChecked === \"true\";\n        },\n        renderHTML: (attributes) => ({\n          \"data-checked\": attributes.checked\n        })\n      }\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: `li[data-type=\"${this.name}\"]`,\n        priority: 51\n      }\n    ];\n  },\n  renderHTML({ node, HTMLAttributes }) {\n    return [\n      \"li\",\n      mergeAttributes4(this.options.HTMLAttributes, HTMLAttributes, {\n        \"data-type\": this.name\n      }),\n      [\n        \"label\",\n        [\n          \"input\",\n          {\n            type: \"checkbox\",\n            checked: node.attrs.checked ? \"checked\" : null\n          }\n        ],\n        [\"span\"]\n      ],\n      [\"div\", 0]\n    ];\n  },\n  parseMarkdown: (token, h) => {\n    const content = [];\n    if (token.tokens && token.tokens.length > 0) {\n      content.push(h.createNode(\"paragraph\", {}, h.parseInline(token.tokens)));\n    } else if (token.text) {\n      content.push(h.createNode(\"paragraph\", {}, [h.createNode(\"text\", { text: token.text })]));\n    } else {\n      content.push(h.createNode(\"paragraph\", {}, []));\n    }\n    if (token.nestedTokens && token.nestedTokens.length > 0) {\n      const nestedContent = h.parseChildren(token.nestedTokens);\n      content.push(...nestedContent);\n    }\n    return h.createNode(\"taskItem\", { checked: token.checked || false }, content);\n  },\n  renderMarkdown: (node, h) => {\n    var _a;\n    const checkedChar = ((_a = node.attrs) == null ? void 0 : _a.checked) ? \"x\" : \" \";\n    const prefix = `- [${checkedChar}] `;\n    return renderNestedMarkdownContent2(node, h, prefix);\n  },\n  addKeyboardShortcuts() {\n    const shortcuts = {\n      Enter: () => this.editor.commands.splitListItem(this.name),\n      \"Shift-Tab\": () => this.editor.commands.liftListItem(this.name)\n    };\n    if (!this.options.nested) {\n      return shortcuts;\n    }\n    return {\n      ...shortcuts,\n      Tab: () => this.editor.commands.sinkListItem(this.name)\n    };\n  },\n  addNodeView() {\n    return ({ node, HTMLAttributes, getPos, editor }) => {\n      const listItem = document.createElement(\"li\");\n      const checkboxWrapper = document.createElement(\"label\");\n      const checkboxStyler = document.createElement(\"span\");\n      const checkbox = document.createElement(\"input\");\n      const content = document.createElement(\"div\");\n      const updateA11Y = (currentNode) => {\n        var _a, _b;\n        checkbox.ariaLabel = ((_b = (_a = this.options.a11y) == null ? void 0 : _a.checkboxLabel) == null ? void 0 : _b.call(_a, currentNode, checkbox.checked)) || `Task item checkbox for ${currentNode.textContent || \"empty task item\"}`;\n      };\n      updateA11Y(node);\n      checkboxWrapper.contentEditable = \"false\";\n      checkbox.type = \"checkbox\";\n      checkbox.addEventListener(\"mousedown\", (event) => event.preventDefault());\n      checkbox.addEventListener(\"change\", (event) => {\n        if (!editor.isEditable && !this.options.onReadOnlyChecked) {\n          checkbox.checked = !checkbox.checked;\n          return;\n        }\n        const { checked } = event.target;\n        if (editor.isEditable && typeof getPos === \"function\") {\n          editor.chain().focus(void 0, { scrollIntoView: false }).command(({ tr }) => {\n            const position = getPos();\n            if (typeof position !== \"number\") {\n              return false;\n            }\n            const currentNode = tr.doc.nodeAt(position);\n            tr.setNodeMarkup(position, void 0, {\n              ...currentNode == null ? void 0 : currentNode.attrs,\n              checked\n            });\n            return true;\n          }).run();\n        }\n        if (!editor.isEditable && this.options.onReadOnlyChecked) {\n          if (!this.options.onReadOnlyChecked(node, checked)) {\n            checkbox.checked = !checkbox.checked;\n          }\n        }\n      });\n      Object.entries(this.options.HTMLAttributes).forEach(([key, value]) => {\n        listItem.setAttribute(key, value);\n      });\n      listItem.dataset.checked = node.attrs.checked;\n      checkbox.checked = node.attrs.checked;\n      checkboxWrapper.append(checkbox, checkboxStyler);\n      listItem.append(checkboxWrapper, content);\n      Object.entries(HTMLAttributes).forEach(([key, value]) => {\n        listItem.setAttribute(key, value);\n      });\n      let prevRenderedAttributeKeys = new Set(Object.keys(HTMLAttributes));\n      return {\n        dom: listItem,\n        contentDOM: content,\n        update: (updatedNode) => {\n          if (updatedNode.type !== this.type) {\n            return false;\n          }\n          listItem.dataset.checked = updatedNode.attrs.checked;\n          checkbox.checked = updatedNode.attrs.checked;\n          updateA11Y(updatedNode);\n          const extensionAttributes = editor.extensionManager.attributes;\n          const newHTMLAttributes = getRenderedAttributes(updatedNode, extensionAttributes);\n          const newKeys = new Set(Object.keys(newHTMLAttributes));\n          const staticAttrs = this.options.HTMLAttributes;\n          prevRenderedAttributeKeys.forEach((key) => {\n            if (!newKeys.has(key)) {\n              if (key in staticAttrs) {\n                listItem.setAttribute(key, staticAttrs[key]);\n              } else {\n                listItem.removeAttribute(key);\n              }\n            }\n          });\n          Object.entries(newHTMLAttributes).forEach(([key, value]) => {\n            if (value === null || value === void 0) {\n              if (key in staticAttrs) {\n                listItem.setAttribute(key, staticAttrs[key]);\n              } else {\n                listItem.removeAttribute(key);\n              }\n            } else {\n              listItem.setAttribute(key, value);\n            }\n          });\n          prevRenderedAttributeKeys = newKeys;\n          return true;\n        }\n      };\n    };\n  },\n  addInputRules() {\n    return [\n      wrappingInputRule3({\n        find: inputRegex,\n        type: this.type,\n        getAttributes: (match) => ({\n          checked: match[match.length - 1] === \"x\"\n        })\n      })\n    ];\n  }\n});\n\n// src/task-list/task-list.ts\nimport { mergeAttributes as mergeAttributes5, Node as Node5, parseIndentedBlocks } from \"@tiptap/core\";\nvar TaskList = Node5.create({\n  name: \"taskList\",\n  addOptions() {\n    return {\n      itemTypeName: \"taskItem\",\n      HTMLAttributes: {}\n    };\n  },\n  group: \"block list\",\n  content() {\n    return `${this.options.itemTypeName}+`;\n  },\n  parseHTML() {\n    return [\n      {\n        tag: `ul[data-type=\"${this.name}\"]`,\n        priority: 51\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"ul\", mergeAttributes5(this.options.HTMLAttributes, HTMLAttributes, { \"data-type\": this.name }), 0];\n  },\n  parseMarkdown: (token, h) => {\n    return h.createNode(\"taskList\", {}, h.parseChildren(token.items || []));\n  },\n  renderMarkdown: (node, h) => {\n    if (!node.content) {\n      return \"\";\n    }\n    return h.renderChildren(node.content, \"\\n\");\n  },\n  markdownTokenizer: {\n    name: \"taskList\",\n    level: \"block\",\n    start(src) {\n      var _a;\n      const index = (_a = src.match(/^\\s*[-+*]\\s+\\[([ xX])\\]\\s+/)) == null ? void 0 : _a.index;\n      return index !== void 0 ? index : -1;\n    },\n    tokenize(src, tokens, lexer) {\n      const parseTaskListContent = (content) => {\n        const nestedResult = parseIndentedBlocks(\n          content,\n          {\n            itemPattern: /^(\\s*)([-+*])\\s+\\[([ xX])\\]\\s+(.*)$/,\n            extractItemData: (match) => ({\n              indentLevel: match[1].length,\n              mainContent: match[4],\n              checked: match[3].toLowerCase() === \"x\"\n            }),\n            createToken: (data, nestedTokens) => ({\n              type: \"taskItem\",\n              raw: \"\",\n              mainContent: data.mainContent,\n              indentLevel: data.indentLevel,\n              checked: data.checked,\n              text: data.mainContent,\n              tokens: lexer.inlineTokens(data.mainContent),\n              nestedTokens\n            }),\n            // Allow recursive nesting\n            customNestedParser: parseTaskListContent\n          },\n          lexer\n        );\n        if (nestedResult) {\n          return [\n            {\n              type: \"taskList\",\n              raw: nestedResult.raw,\n              items: nestedResult.items\n            }\n          ];\n        }\n        return lexer.blockTokens(content);\n      };\n      const result = parseIndentedBlocks(\n        src,\n        {\n          itemPattern: /^(\\s*)([-+*])\\s+\\[([ xX])\\]\\s+(.*)$/,\n          extractItemData: (match) => ({\n            indentLevel: match[1].length,\n            mainContent: match[4],\n            checked: match[3].toLowerCase() === \"x\"\n          }),\n          createToken: (data, nestedTokens) => ({\n            type: \"taskItem\",\n            raw: \"\",\n            mainContent: data.mainContent,\n            indentLevel: data.indentLevel,\n            checked: data.checked,\n            text: data.mainContent,\n            tokens: lexer.inlineTokens(data.mainContent),\n            nestedTokens\n          }),\n          // Use the recursive parser for nested content\n          customNestedParser: parseTaskListContent\n        },\n        lexer\n      );\n      if (!result) {\n        return void 0;\n      }\n      return {\n        type: \"taskList\",\n        raw: result.raw,\n        items: result.items\n      };\n    }\n  },\n  markdownOptions: {\n    indentsContent: true\n  },\n  addCommands() {\n    return {\n      toggleTaskList: () => ({ commands }) => {\n        return commands.toggleList(this.name, this.options.itemTypeName);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Shift-9\": () => this.editor.commands.toggleTaskList()\n    };\n  }\n});\n\n// src/kit/index.ts\nvar ListKit = Extension2.create({\n  name: \"listKit\",\n  addExtensions() {\n    const extensions = [];\n    if (this.options.bulletList !== false) {\n      extensions.push(BulletList.configure(this.options.bulletList));\n    }\n    if (this.options.listItem !== false) {\n      extensions.push(ListItem.configure(this.options.listItem));\n    }\n    if (this.options.listKeymap !== false) {\n      extensions.push(ListKeymap.configure(this.options.listKeymap));\n    }\n    if (this.options.orderedList !== false) {\n      extensions.push(OrderedList.configure(this.options.orderedList));\n    }\n    if (this.options.taskItem !== false) {\n      extensions.push(TaskItem.configure(this.options.taskItem));\n    }\n    if (this.options.taskList !== false) {\n      extensions.push(TaskList.configure(this.options.taskList));\n    }\n    return extensions;\n  }\n});\nexport {\n  BulletList,\n  ListItem,\n  ListKeymap,\n  ListKit,\n  OrderedList,\n  TaskItem,\n  TaskList,\n  bulletListInputRegex,\n  inputRegex,\n  listHelpers_exports as listHelpers,\n  orderedListInputRegex\n};\n//# sourceMappingURL=index.js.map","// src/paragraph.ts\nimport { mergeAttributes, Node } from \"@tiptap/core\";\nvar EMPTY_PARAGRAPH_MARKDOWN = \"&nbsp;\";\nvar NBSP_CHAR = \"\\xA0\";\nvar Paragraph = Node.create({\n  name: \"paragraph\",\n  priority: 1e3,\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  group: \"block\",\n  content: \"inline*\",\n  parseHTML() {\n    return [{ tag: \"p\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"p\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  parseMarkdown: (token, helpers) => {\n    const tokens = token.tokens || [];\n    if (tokens.length === 1 && tokens[0].type === \"image\") {\n      return helpers.parseChildren([tokens[0]]);\n    }\n    const content = helpers.parseInline(tokens);\n    if (content.length === 1 && content[0].type === \"text\" && (content[0].text === EMPTY_PARAGRAPH_MARKDOWN || content[0].text === NBSP_CHAR)) {\n      return helpers.createNode(\"paragraph\", void 0, []);\n    }\n    return helpers.createNode(\"paragraph\", void 0, content);\n  },\n  renderMarkdown: (node, h) => {\n    if (!node) {\n      return \"\";\n    }\n    const content = Array.isArray(node.content) ? node.content : [];\n    if (content.length === 0) {\n      return EMPTY_PARAGRAPH_MARKDOWN;\n    }\n    return h.renderChildren(content);\n  },\n  addCommands() {\n    return {\n      setParagraph: () => ({ commands }) => {\n        return commands.setNode(this.name);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Alt-0\": () => this.editor.commands.setParagraph()\n    };\n  }\n});\n\n// src/index.ts\nvar index_default = Paragraph;\nexport {\n  Paragraph,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","// src/strike.ts\nimport { Mark, markInputRule, markPasteRule, mergeAttributes } from \"@tiptap/core\";\nvar inputRegex = /(?:^|\\s)(~~(?!\\s+~~)((?:[^~]+))~~(?!\\s+~~))$/;\nvar pasteRegex = /(?:^|\\s)(~~(?!\\s+~~)((?:[^~]+))~~(?!\\s+~~))/g;\nvar Strike = Mark.create({\n  name: \"strike\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"s\"\n      },\n      {\n        tag: \"del\"\n      },\n      {\n        tag: \"strike\"\n      },\n      {\n        style: \"text-decoration\",\n        consuming: false,\n        getAttrs: (style) => style.includes(\"line-through\") ? {} : false\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"s\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  markdownTokenName: \"del\",\n  parseMarkdown: (token, helpers) => {\n    return helpers.applyMark(\"strike\", helpers.parseInline(token.tokens || []));\n  },\n  renderMarkdown: (node, h) => {\n    return `~~${h.renderChildren(node)}~~`;\n  },\n  addCommands() {\n    return {\n      setStrike: () => ({ commands }) => {\n        return commands.setMark(this.name);\n      },\n      toggleStrike: () => ({ commands }) => {\n        return commands.toggleMark(this.name);\n      },\n      unsetStrike: () => ({ commands }) => {\n        return commands.unsetMark(this.name);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Shift-s\": () => this.editor.commands.toggleStrike()\n    };\n  },\n  addInputRules() {\n    return [\n      markInputRule({\n        find: inputRegex,\n        type: this.type\n      })\n    ];\n  },\n  addPasteRules() {\n    return [\n      markPasteRule({\n        find: pasteRegex,\n        type: this.type\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = Strike;\nexport {\n  Strike,\n  index_default as default,\n  inputRegex,\n  pasteRegex\n};\n//# sourceMappingURL=index.js.map","// src/text.ts\nimport { Node } from \"@tiptap/core\";\nvar Text = Node.create({\n  name: \"text\",\n  group: \"inline\",\n  parseMarkdown: (token) => {\n    return {\n      type: \"text\",\n      text: token.text || \"\"\n    };\n  },\n  renderMarkdown: (node) => node.text || \"\"\n});\n\n// src/index.ts\nvar index_default = Text;\nexport {\n  Text,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","// src/underline.ts\nimport { Mark, mergeAttributes } from \"@tiptap/core\";\nvar Underline = Mark.create({\n  name: \"underline\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"u\"\n      },\n      {\n        style: \"text-decoration\",\n        consuming: false,\n        getAttrs: (style) => style.includes(\"underline\") ? {} : false\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"u\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  parseMarkdown(token, helpers) {\n    return helpers.applyMark(this.name || \"underline\", helpers.parseInline(token.tokens || []));\n  },\n  renderMarkdown(node, helpers) {\n    return `++${helpers.renderChildren(node)}++`;\n  },\n  markdownTokenizer: {\n    name: \"underline\",\n    level: \"inline\",\n    start(src) {\n      return src.indexOf(\"++\");\n    },\n    tokenize(src, _tokens, lexer) {\n      const rule = /^(\\+\\+)([\\s\\S]+?)(\\+\\+)/;\n      const match = rule.exec(src);\n      if (!match) {\n        return void 0;\n      }\n      const innerContent = match[2].trim();\n      return {\n        type: \"underline\",\n        raw: match[0],\n        text: innerContent,\n        tokens: lexer.inlineTokens(innerContent)\n      };\n    }\n  },\n  addCommands() {\n    return {\n      setUnderline: () => ({ commands }) => {\n        return commands.setMark(this.name);\n      },\n      toggleUnderline: () => ({ commands }) => {\n        return commands.toggleMark(this.name);\n      },\n      unsetUnderline: () => ({ commands }) => {\n        return commands.unsetMark(this.name);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-u\": () => this.editor.commands.toggleUnderline(),\n      \"Mod-U\": () => this.editor.commands.toggleUnderline()\n    };\n  }\n});\n\n// src/index.ts\nvar index_default = Underline;\nexport {\n  Underline,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","import { Plugin } from 'prosemirror-state';\nimport { dropPoint } from 'prosemirror-transform';\n\n/**\nCreate a plugin that, when added to a ProseMirror instance,\ncauses a decoration to show up at the drop position when something\nis dragged over the editor.\n\nNodes may add a `disableDropCursor` property to their spec to\ncontrol the showing of a drop cursor inside them. This may be a\nboolean or a function, which will be called with a view and a\nposition, and should return a boolean.\n*/\nfunction dropCursor(options = {}) {\n    return new Plugin({\n        view(editorView) { return new DropCursorView(editorView, options); }\n    });\n}\nclass DropCursorView {\n    constructor(editorView, options) {\n        var _a;\n        this.editorView = editorView;\n        this.cursorPos = null;\n        this.element = null;\n        this.timeout = -1;\n        this.width = (_a = options.width) !== null && _a !== void 0 ? _a : 1;\n        this.color = options.color === false ? undefined : (options.color || \"black\");\n        this.class = options.class;\n        this.handlers = [\"dragover\", \"dragend\", \"drop\", \"dragleave\"].map(name => {\n            let handler = (e) => { this[name](e); };\n            editorView.dom.addEventListener(name, handler);\n            return { name, handler };\n        });\n    }\n    destroy() {\n        this.handlers.forEach(({ name, handler }) => this.editorView.dom.removeEventListener(name, handler));\n    }\n    update(editorView, prevState) {\n        if (this.cursorPos != null && prevState.doc != editorView.state.doc) {\n            if (this.cursorPos > editorView.state.doc.content.size)\n                this.setCursor(null);\n            else\n                this.updateOverlay();\n        }\n    }\n    setCursor(pos) {\n        if (pos == this.cursorPos)\n            return;\n        this.cursorPos = pos;\n        if (pos == null) {\n            this.element.parentNode.removeChild(this.element);\n            this.element = null;\n        }\n        else {\n            this.updateOverlay();\n        }\n    }\n    updateOverlay() {\n        let $pos = this.editorView.state.doc.resolve(this.cursorPos);\n        let isBlock = !$pos.parent.inlineContent, rect;\n        let editorDOM = this.editorView.dom, editorRect = editorDOM.getBoundingClientRect();\n        let scaleX = editorRect.width / editorDOM.offsetWidth, scaleY = editorRect.height / editorDOM.offsetHeight;\n        if (isBlock) {\n            let before = $pos.nodeBefore, after = $pos.nodeAfter;\n            if (before || after) {\n                let node = this.editorView.nodeDOM(this.cursorPos - (before ? before.nodeSize : 0));\n                if (node) {\n                    let nodeRect = node.getBoundingClientRect();\n                    let top = before ? nodeRect.bottom : nodeRect.top;\n                    if (before && after)\n                        top = (top + this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top) / 2;\n                    let halfWidth = (this.width / 2) * scaleY;\n                    rect = { left: nodeRect.left, right: nodeRect.right, top: top - halfWidth, bottom: top + halfWidth };\n                }\n            }\n        }\n        if (!rect) {\n            let coords = this.editorView.coordsAtPos(this.cursorPos);\n            let halfWidth = (this.width / 2) * scaleX;\n            rect = { left: coords.left - halfWidth, right: coords.left + halfWidth, top: coords.top, bottom: coords.bottom };\n        }\n        let parent = this.editorView.dom.offsetParent;\n        if (!this.element) {\n            this.element = parent.appendChild(document.createElement(\"div\"));\n            if (this.class)\n                this.element.className = this.class;\n            this.element.style.cssText = \"position: absolute; z-index: 50; pointer-events: none;\";\n            if (this.color) {\n                this.element.style.backgroundColor = this.color;\n            }\n        }\n        this.element.classList.toggle(\"prosemirror-dropcursor-block\", isBlock);\n        this.element.classList.toggle(\"prosemirror-dropcursor-inline\", !isBlock);\n        let parentLeft, parentTop;\n        if (!parent || parent == document.body && getComputedStyle(parent).position == \"static\") {\n            parentLeft = -pageXOffset;\n            parentTop = -pageYOffset;\n        }\n        else {\n            let rect = parent.getBoundingClientRect();\n            let parentScaleX = rect.width / parent.offsetWidth, parentScaleY = rect.height / parent.offsetHeight;\n            parentLeft = rect.left - parent.scrollLeft * parentScaleX;\n            parentTop = rect.top - parent.scrollTop * parentScaleY;\n        }\n        this.element.style.left = (rect.left - parentLeft) / scaleX + \"px\";\n        this.element.style.top = (rect.top - parentTop) / scaleY + \"px\";\n        this.element.style.width = (rect.right - rect.left) / scaleX + \"px\";\n        this.element.style.height = (rect.bottom - rect.top) / scaleY + \"px\";\n    }\n    scheduleRemoval(timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = setTimeout(() => this.setCursor(null), timeout);\n    }\n    dragover(event) {\n        if (!this.editorView.editable)\n            return;\n        let pos = this.editorView.posAtCoords({ left: event.clientX, top: event.clientY });\n        let node = pos && pos.inside >= 0 && this.editorView.state.doc.nodeAt(pos.inside);\n        let disableDropCursor = node && node.type.spec.disableDropCursor;\n        let disabled = typeof disableDropCursor == \"function\"\n            ? disableDropCursor(this.editorView, pos, event)\n            : disableDropCursor;\n        if (pos && !disabled) {\n            let target = pos.pos;\n            if (this.editorView.dragging && this.editorView.dragging.slice) {\n                let point = dropPoint(this.editorView.state.doc, target, this.editorView.dragging.slice);\n                if (point != null)\n                    target = point;\n            }\n            this.setCursor(target);\n            this.scheduleRemoval(5000);\n        }\n    }\n    dragend() {\n        this.scheduleRemoval(20);\n    }\n    drop() {\n        this.scheduleRemoval(20);\n    }\n    dragleave(event) {\n        if (!this.editorView.dom.contains(event.relatedTarget))\n            this.setCursor(null);\n    }\n}\n\nexport { dropCursor };\n","import { keydownHandler } from 'prosemirror-keymap';\nimport { Selection, NodeSelection, TextSelection, Plugin } from 'prosemirror-state';\nimport { Slice, Fragment } from 'prosemirror-model';\nimport { DecorationSet, Decoration } from 'prosemirror-view';\n\n/**\nGap cursor selections are represented using this class. Its\n`$anchor` and `$head` properties both point at the cursor position.\n*/\nclass GapCursor extends Selection {\n    /**\n    Create a gap cursor.\n    */\n    constructor($pos) {\n        super($pos, $pos);\n    }\n    map(doc, mapping) {\n        let $pos = doc.resolve(mapping.map(this.head));\n        return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos);\n    }\n    content() { return Slice.empty; }\n    eq(other) {\n        return other instanceof GapCursor && other.head == this.head;\n    }\n    toJSON() {\n        return { type: \"gapcursor\", pos: this.head };\n    }\n    /**\n    @internal\n    */\n    static fromJSON(doc, json) {\n        if (typeof json.pos != \"number\")\n            throw new RangeError(\"Invalid input for GapCursor.fromJSON\");\n        return new GapCursor(doc.resolve(json.pos));\n    }\n    /**\n    @internal\n    */\n    getBookmark() { return new GapBookmark(this.anchor); }\n    /**\n    @internal\n    */\n    static valid($pos) {\n        let parent = $pos.parent;\n        if (parent.isTextblock || !closedBefore($pos) || !closedAfter($pos))\n            return false;\n        let override = parent.type.spec.allowGapCursor;\n        if (override != null)\n            return override;\n        let deflt = parent.contentMatchAt($pos.index()).defaultType;\n        return deflt && deflt.isTextblock;\n    }\n    /**\n    @internal\n    */\n    static findGapCursorFrom($pos, dir, mustMove = false) {\n        search: for (;;) {\n            if (!mustMove && GapCursor.valid($pos))\n                return $pos;\n            let pos = $pos.pos, next = null;\n            // Scan up from this position\n            for (let d = $pos.depth;; d--) {\n                let parent = $pos.node(d);\n                if (dir > 0 ? $pos.indexAfter(d) < parent.childCount : $pos.index(d) > 0) {\n                    next = parent.child(dir > 0 ? $pos.indexAfter(d) : $pos.index(d) - 1);\n                    break;\n                }\n                else if (d == 0) {\n                    return null;\n                }\n                pos += dir;\n                let $cur = $pos.doc.resolve(pos);\n                if (GapCursor.valid($cur))\n                    return $cur;\n            }\n            // And then down into the next node\n            for (;;) {\n                let inside = dir > 0 ? next.firstChild : next.lastChild;\n                if (!inside) {\n                    if (next.isAtom && !next.isText && !NodeSelection.isSelectable(next)) {\n                        $pos = $pos.doc.resolve(pos + next.nodeSize * dir);\n                        mustMove = false;\n                        continue search;\n                    }\n                    break;\n                }\n                next = inside;\n                pos += dir;\n                let $cur = $pos.doc.resolve(pos);\n                if (GapCursor.valid($cur))\n                    return $cur;\n            }\n            return null;\n        }\n    }\n}\nGapCursor.prototype.visible = false;\nGapCursor.findFrom = GapCursor.findGapCursorFrom;\nSelection.jsonID(\"gapcursor\", GapCursor);\nclass GapBookmark {\n    constructor(pos) {\n        this.pos = pos;\n    }\n    map(mapping) {\n        return new GapBookmark(mapping.map(this.pos));\n    }\n    resolve(doc) {\n        let $pos = doc.resolve(this.pos);\n        return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos);\n    }\n}\nfunction needsGap(type) {\n    return type.isAtom || type.spec.isolating || type.spec.createGapCursor;\n}\nfunction closedBefore($pos) {\n    for (let d = $pos.depth; d >= 0; d--) {\n        let index = $pos.index(d), parent = $pos.node(d);\n        // At the start of this parent, look at next one\n        if (index == 0) {\n            if (parent.type.spec.isolating)\n                return true;\n            continue;\n        }\n        // See if the node before (or its first ancestor) is closed\n        for (let before = parent.child(index - 1);; before = before.lastChild) {\n            if ((before.childCount == 0 && !before.inlineContent) || needsGap(before.type))\n                return true;\n            if (before.inlineContent)\n                return false;\n        }\n    }\n    // Hit start of document\n    return true;\n}\nfunction closedAfter($pos) {\n    for (let d = $pos.depth; d >= 0; d--) {\n        let index = $pos.indexAfter(d), parent = $pos.node(d);\n        if (index == parent.childCount) {\n            if (parent.type.spec.isolating)\n                return true;\n            continue;\n        }\n        for (let after = parent.child(index);; after = after.firstChild) {\n            if ((after.childCount == 0 && !after.inlineContent) || needsGap(after.type))\n                return true;\n            if (after.inlineContent)\n                return false;\n        }\n    }\n    return true;\n}\n\n/**\nCreate a gap cursor plugin. When enabled, this will capture clicks\nnear and arrow-key-motion past places that don't have a normally\nselectable position nearby, and create a gap cursor selection for\nthem. The cursor is drawn as an element with class\n`ProseMirror-gapcursor`. You can either include\n`style/gapcursor.css` from the package's directory or add your own\nstyles to make it visible.\n*/\nfunction gapCursor() {\n    return new Plugin({\n        props: {\n            decorations: drawGapCursor,\n            createSelectionBetween(_view, $anchor, $head) {\n                return $anchor.pos == $head.pos && GapCursor.valid($head) ? new GapCursor($head) : null;\n            },\n            handleClick,\n            handleKeyDown,\n            handleDOMEvents: { beforeinput: beforeinput }\n        }\n    });\n}\nconst handleKeyDown = keydownHandler({\n    \"ArrowLeft\": arrow(\"horiz\", -1),\n    \"ArrowRight\": arrow(\"horiz\", 1),\n    \"ArrowUp\": arrow(\"vert\", -1),\n    \"ArrowDown\": arrow(\"vert\", 1)\n});\nfunction arrow(axis, dir) {\n    const dirStr = axis == \"vert\" ? (dir > 0 ? \"down\" : \"up\") : (dir > 0 ? \"right\" : \"left\");\n    return function (state, dispatch, view) {\n        let sel = state.selection;\n        let $start = dir > 0 ? sel.$to : sel.$from, mustMove = sel.empty;\n        if (sel instanceof TextSelection) {\n            if (!view.endOfTextblock(dirStr) || $start.depth == 0)\n                return false;\n            mustMove = false;\n            $start = state.doc.resolve(dir > 0 ? $start.after() : $start.before());\n        }\n        let $found = GapCursor.findGapCursorFrom($start, dir, mustMove);\n        if (!$found)\n            return false;\n        if (dispatch)\n            dispatch(state.tr.setSelection(new GapCursor($found)));\n        return true;\n    };\n}\nfunction handleClick(view, pos, event) {\n    if (!view || !view.editable)\n        return false;\n    let $pos = view.state.doc.resolve(pos);\n    if (!GapCursor.valid($pos))\n        return false;\n    let clickPos = view.posAtCoords({ left: event.clientX, top: event.clientY });\n    if (clickPos && clickPos.inside > -1 && NodeSelection.isSelectable(view.state.doc.nodeAt(clickPos.inside)))\n        return false;\n    view.dispatch(view.state.tr.setSelection(new GapCursor($pos)));\n    return true;\n}\n// This is a hack that, when a composition starts while a gap cursor\n// is active, quickly creates an inline context for the composition to\n// happen in, to avoid it being aborted by the DOM selection being\n// moved into a valid position.\nfunction beforeinput(view, event) {\n    if (event.inputType != \"insertCompositionText\" || !(view.state.selection instanceof GapCursor))\n        return false;\n    let { $from } = view.state.selection;\n    let insert = $from.parent.contentMatchAt($from.index()).findWrapping(view.state.schema.nodes.text);\n    if (!insert)\n        return false;\n    let frag = Fragment.empty;\n    for (let i = insert.length - 1; i >= 0; i--)\n        frag = Fragment.from(insert[i].createAndFill(null, frag));\n    let tr = view.state.tr.replace($from.pos, $from.pos, new Slice(frag, 0, 0));\n    tr.setSelection(TextSelection.near(tr.doc.resolve($from.pos + 1)));\n    view.dispatch(tr);\n    return false;\n}\nfunction drawGapCursor(state) {\n    if (!(state.selection instanceof GapCursor))\n        return null;\n    let node = document.createElement(\"div\");\n    node.className = \"ProseMirror-gapcursor\";\n    return DecorationSet.create(state.doc, [Decoration.widget(state.selection.head, node, { key: \"gapcursor\" })]);\n}\n\nexport { GapCursor, gapCursor };\n","var GOOD_LEAF_SIZE = 200;\n\n// :: class<T> A rope sequence is a persistent sequence data structure\n// that supports appending, prepending, and slicing without doing a\n// full copy. It is represented as a mostly-balanced tree.\nvar RopeSequence = function RopeSequence () {};\n\nRopeSequence.prototype.append = function append (other) {\n  if (!other.length) { return this }\n  other = RopeSequence.from(other);\n\n  return (!this.length && other) ||\n    (other.length < GOOD_LEAF_SIZE && this.leafAppend(other)) ||\n    (this.length < GOOD_LEAF_SIZE && other.leafPrepend(this)) ||\n    this.appendInner(other)\n};\n\n// :: (union<[T], RopeSequence<T>>) → RopeSequence<T>\n// Prepend an array or other rope to this one, returning a new rope.\nRopeSequence.prototype.prepend = function prepend (other) {\n  if (!other.length) { return this }\n  return RopeSequence.from(other).append(this)\n};\n\nRopeSequence.prototype.appendInner = function appendInner (other) {\n  return new Append(this, other)\n};\n\n// :: (?number, ?number) → RopeSequence<T>\n// Create a rope repesenting a sub-sequence of this rope.\nRopeSequence.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from >= to) { return RopeSequence.empty }\n  return this.sliceInner(Math.max(0, from), Math.min(this.length, to))\n};\n\n// :: (number) → T\n// Retrieve the element at the given position from this rope.\nRopeSequence.prototype.get = function get (i) {\n  if (i < 0 || i >= this.length) { return undefined }\n  return this.getInner(i)\n};\n\n// :: ((element: T, index: number) → ?bool, ?number, ?number)\n// Call the given function for each element between the given\n// indices. This tends to be more efficient than looping over the\n// indices and calling `get`, because it doesn't have to descend the\n// tree for every element.\nRopeSequence.prototype.forEach = function forEach (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from <= to)\n    { this.forEachInner(f, from, to, 0); }\n  else\n    { this.forEachInvertedInner(f, from, to, 0); }\n};\n\n// :: ((element: T, index: number) → U, ?number, ?number) → [U]\n// Map the given functions over the elements of the rope, producing\n// a flat array.\nRopeSequence.prototype.map = function map (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  var result = [];\n  this.forEach(function (elt, i) { return result.push(f(elt, i)); }, from, to);\n  return result\n};\n\n// :: (?union<[T], RopeSequence<T>>) → RopeSequence<T>\n// Create a rope representing the given array, or return the rope\n// itself if a rope was given.\nRopeSequence.from = function from (values) {\n  if (values instanceof RopeSequence) { return values }\n  return values && values.length ? new Leaf(values) : RopeSequence.empty\n};\n\nvar Leaf = /*@__PURE__*/(function (RopeSequence) {\n  function Leaf(values) {\n    RopeSequence.call(this);\n    this.values = values;\n  }\n\n  if ( RopeSequence ) Leaf.__proto__ = RopeSequence;\n  Leaf.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Leaf.prototype.constructor = Leaf;\n\n  var prototypeAccessors = { length: { configurable: true },depth: { configurable: true } };\n\n  Leaf.prototype.flatten = function flatten () {\n    return this.values\n  };\n\n  Leaf.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    return new Leaf(this.values.slice(from, to))\n  };\n\n  Leaf.prototype.getInner = function getInner (i) {\n    return this.values[i]\n  };\n\n  Leaf.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    for (var i = from; i < to; i++)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    for (var i = from - 1; i >= to; i--)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.leafAppend = function leafAppend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(this.values.concat(other.flatten())) }\n  };\n\n  Leaf.prototype.leafPrepend = function leafPrepend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(other.flatten().concat(this.values)) }\n  };\n\n  prototypeAccessors.length.get = function () { return this.values.length };\n\n  prototypeAccessors.depth.get = function () { return 0 };\n\n  Object.defineProperties( Leaf.prototype, prototypeAccessors );\n\n  return Leaf;\n}(RopeSequence));\n\n// :: RopeSequence\n// The empty rope sequence.\nRopeSequence.empty = new Leaf([]);\n\nvar Append = /*@__PURE__*/(function (RopeSequence) {\n  function Append(left, right) {\n    RopeSequence.call(this);\n    this.left = left;\n    this.right = right;\n    this.length = left.length + right.length;\n    this.depth = Math.max(left.depth, right.depth) + 1;\n  }\n\n  if ( RopeSequence ) Append.__proto__ = RopeSequence;\n  Append.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Append.prototype.constructor = Append;\n\n  Append.prototype.flatten = function flatten () {\n    return this.left.flatten().concat(this.right.flatten())\n  };\n\n  Append.prototype.getInner = function getInner (i) {\n    return i < this.left.length ? this.left.get(i) : this.right.get(i - this.left.length)\n  };\n\n  Append.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from < leftLen &&\n        this.left.forEachInner(f, from, Math.min(to, leftLen), start) === false)\n      { return false }\n    if (to > leftLen &&\n        this.right.forEachInner(f, Math.max(from - leftLen, 0), Math.min(this.length, to) - leftLen, start + leftLen) === false)\n      { return false }\n  };\n\n  Append.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from > leftLen &&\n        this.right.forEachInvertedInner(f, from - leftLen, Math.max(to, leftLen) - leftLen, start + leftLen) === false)\n      { return false }\n    if (to < leftLen &&\n        this.left.forEachInvertedInner(f, Math.min(from, leftLen), to, start) === false)\n      { return false }\n  };\n\n  Append.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    var leftLen = this.left.length;\n    if (to <= leftLen) { return this.left.slice(from, to) }\n    if (from >= leftLen) { return this.right.slice(from - leftLen, to - leftLen) }\n    return this.left.slice(from, leftLen).append(this.right.slice(0, to - leftLen))\n  };\n\n  Append.prototype.leafAppend = function leafAppend (other) {\n    var inner = this.right.leafAppend(other);\n    if (inner) { return new Append(this.left, inner) }\n  };\n\n  Append.prototype.leafPrepend = function leafPrepend (other) {\n    var inner = this.left.leafPrepend(other);\n    if (inner) { return new Append(inner, this.right) }\n  };\n\n  Append.prototype.appendInner = function appendInner (other) {\n    if (this.left.depth >= Math.max(this.right.depth, other.depth) + 1)\n      { return new Append(this.left, new Append(this.right, other)) }\n    return new Append(this, other)\n  };\n\n  return Append;\n}(RopeSequence));\n\nexport default RopeSequence;\n","import RopeSequence from 'rope-sequence';\nimport { Mapping } from 'prosemirror-transform';\nimport { PluginKey, Plugin } from 'prosemirror-state';\n\n// ProseMirror's history isn't simply a way to roll back to a previous\n// state, because ProseMirror supports applying changes without adding\n// them to the history (for example during collaboration).\n//\n// To this end, each 'Branch' (one for the undo history and one for\n// the redo history) keeps an array of 'Items', which can optionally\n// hold a step (an actual undoable change), and always hold a position\n// map (which is needed to move changes below them to apply to the\n// current document).\n//\n// An item that has both a step and a selection bookmark is the start\n// of an 'event' — a group of changes that will be undone or redone at\n// once. (It stores only the bookmark, since that way we don't have to\n// provide a document until the selection is actually applied, which\n// is useful when compressing.)\n// Used to schedule history compression\nconst max_empty_items = 500;\nclass Branch {\n    constructor(items, eventCount) {\n        this.items = items;\n        this.eventCount = eventCount;\n    }\n    // Pop the latest event off the branch's history and apply it\n    // to a document transform.\n    popEvent(state, preserveItems) {\n        if (this.eventCount == 0)\n            return null;\n        let end = this.items.length;\n        for (;; end--) {\n            let next = this.items.get(end - 1);\n            if (next.selection) {\n                --end;\n                break;\n            }\n        }\n        let remap, mapFrom;\n        if (preserveItems) {\n            remap = this.remapping(end, this.items.length);\n            mapFrom = remap.maps.length;\n        }\n        let transform = state.tr;\n        let selection, remaining;\n        let addAfter = [], addBefore = [];\n        this.items.forEach((item, i) => {\n            if (!item.step) {\n                if (!remap) {\n                    remap = this.remapping(end, i + 1);\n                    mapFrom = remap.maps.length;\n                }\n                mapFrom--;\n                addBefore.push(item);\n                return;\n            }\n            if (remap) {\n                addBefore.push(new Item(item.map));\n                let step = item.step.map(remap.slice(mapFrom)), map;\n                if (step && transform.maybeStep(step).doc) {\n                    map = transform.mapping.maps[transform.mapping.maps.length - 1];\n                    addAfter.push(new Item(map, undefined, undefined, addAfter.length + addBefore.length));\n                }\n                mapFrom--;\n                if (map)\n                    remap.appendMap(map, mapFrom);\n            }\n            else {\n                transform.maybeStep(item.step);\n            }\n            if (item.selection) {\n                selection = remap ? item.selection.map(remap.slice(mapFrom)) : item.selection;\n                remaining = new Branch(this.items.slice(0, end).append(addBefore.reverse().concat(addAfter)), this.eventCount - 1);\n                return false;\n            }\n        }, this.items.length, 0);\n        return { remaining: remaining, transform, selection: selection };\n    }\n    // Create a new branch with the given transform added.\n    addTransform(transform, selection, histOptions, preserveItems) {\n        let newItems = [], eventCount = this.eventCount;\n        let oldItems = this.items, lastItem = !preserveItems && oldItems.length ? oldItems.get(oldItems.length - 1) : null;\n        for (let i = 0; i < transform.steps.length; i++) {\n            let step = transform.steps[i].invert(transform.docs[i]);\n            let item = new Item(transform.mapping.maps[i], step, selection), merged;\n            if (merged = lastItem && lastItem.merge(item)) {\n                item = merged;\n                if (i)\n                    newItems.pop();\n                else\n                    oldItems = oldItems.slice(0, oldItems.length - 1);\n            }\n            newItems.push(item);\n            if (selection) {\n                eventCount++;\n                selection = undefined;\n            }\n            if (!preserveItems)\n                lastItem = item;\n        }\n        let overflow = eventCount - histOptions.depth;\n        if (overflow > DEPTH_OVERFLOW) {\n            oldItems = cutOffEvents(oldItems, overflow);\n            eventCount -= overflow;\n        }\n        return new Branch(oldItems.append(newItems), eventCount);\n    }\n    remapping(from, to) {\n        let maps = new Mapping;\n        this.items.forEach((item, i) => {\n            let mirrorPos = item.mirrorOffset != null && i - item.mirrorOffset >= from\n                ? maps.maps.length - item.mirrorOffset : undefined;\n            maps.appendMap(item.map, mirrorPos);\n        }, from, to);\n        return maps;\n    }\n    addMaps(array) {\n        if (this.eventCount == 0)\n            return this;\n        return new Branch(this.items.append(array.map(map => new Item(map))), this.eventCount);\n    }\n    // When the collab module receives remote changes, the history has\n    // to know about those, so that it can adjust the steps that were\n    // rebased on top of the remote changes, and include the position\n    // maps for the remote changes in its array of items.\n    rebased(rebasedTransform, rebasedCount) {\n        if (!this.eventCount)\n            return this;\n        let rebasedItems = [], start = Math.max(0, this.items.length - rebasedCount);\n        let mapping = rebasedTransform.mapping;\n        let newUntil = rebasedTransform.steps.length;\n        let eventCount = this.eventCount;\n        this.items.forEach(item => { if (item.selection)\n            eventCount--; }, start);\n        let iRebased = rebasedCount;\n        this.items.forEach(item => {\n            let pos = mapping.getMirror(--iRebased);\n            if (pos == null)\n                return;\n            newUntil = Math.min(newUntil, pos);\n            let map = mapping.maps[pos];\n            if (item.step) {\n                let step = rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos]);\n                let selection = item.selection && item.selection.map(mapping.slice(iRebased + 1, pos));\n                if (selection)\n                    eventCount++;\n                rebasedItems.push(new Item(map, step, selection));\n            }\n            else {\n                rebasedItems.push(new Item(map));\n            }\n        }, start);\n        let newMaps = [];\n        for (let i = rebasedCount; i < newUntil; i++)\n            newMaps.push(new Item(mapping.maps[i]));\n        let items = this.items.slice(0, start).append(newMaps).append(rebasedItems);\n        let branch = new Branch(items, eventCount);\n        if (branch.emptyItemCount() > max_empty_items)\n            branch = branch.compress(this.items.length - rebasedItems.length);\n        return branch;\n    }\n    emptyItemCount() {\n        let count = 0;\n        this.items.forEach(item => { if (!item.step)\n            count++; });\n        return count;\n    }\n    // Compressing a branch means rewriting it to push the air (map-only\n    // items) out. During collaboration, these naturally accumulate\n    // because each remote change adds one. The `upto` argument is used\n    // to ensure that only the items below a given level are compressed,\n    // because `rebased` relies on a clean, untouched set of items in\n    // order to associate old items with rebased steps.\n    compress(upto = this.items.length) {\n        let remap = this.remapping(0, upto), mapFrom = remap.maps.length;\n        let items = [], events = 0;\n        this.items.forEach((item, i) => {\n            if (i >= upto) {\n                items.push(item);\n                if (item.selection)\n                    events++;\n            }\n            else if (item.step) {\n                let step = item.step.map(remap.slice(mapFrom)), map = step && step.getMap();\n                mapFrom--;\n                if (map)\n                    remap.appendMap(map, mapFrom);\n                if (step) {\n                    let selection = item.selection && item.selection.map(remap.slice(mapFrom));\n                    if (selection)\n                        events++;\n                    let newItem = new Item(map.invert(), step, selection), merged, last = items.length - 1;\n                    if (merged = items.length && items[last].merge(newItem))\n                        items[last] = merged;\n                    else\n                        items.push(newItem);\n                }\n            }\n            else if (item.map) {\n                mapFrom--;\n            }\n        }, this.items.length, 0);\n        return new Branch(RopeSequence.from(items.reverse()), events);\n    }\n}\nBranch.empty = new Branch(RopeSequence.empty, 0);\nfunction cutOffEvents(items, n) {\n    let cutPoint;\n    items.forEach((item, i) => {\n        if (item.selection && (n-- == 0)) {\n            cutPoint = i;\n            return false;\n        }\n    });\n    return items.slice(cutPoint);\n}\nclass Item {\n    constructor(\n    // The (forward) step map for this item.\n    map, \n    // The inverted step\n    step, \n    // If this is non-null, this item is the start of a group, and\n    // this selection is the starting selection for the group (the one\n    // that was active before the first step was applied)\n    selection, \n    // If this item is the inverse of a previous mapping on the stack,\n    // this points at the inverse's offset\n    mirrorOffset) {\n        this.map = map;\n        this.step = step;\n        this.selection = selection;\n        this.mirrorOffset = mirrorOffset;\n    }\n    merge(other) {\n        if (this.step && other.step && !other.selection) {\n            let step = other.step.merge(this.step);\n            if (step)\n                return new Item(step.getMap().invert(), step, this.selection);\n        }\n    }\n}\n// The value of the state field that tracks undo/redo history for that\n// state. Will be stored in the plugin state when the history plugin\n// is active.\nclass HistoryState {\n    constructor(done, undone, prevRanges, prevTime, prevComposition) {\n        this.done = done;\n        this.undone = undone;\n        this.prevRanges = prevRanges;\n        this.prevTime = prevTime;\n        this.prevComposition = prevComposition;\n    }\n}\nconst DEPTH_OVERFLOW = 20;\n// Record a transformation in undo history.\nfunction applyTransaction(history, state, tr, options) {\n    let historyTr = tr.getMeta(historyKey), rebased;\n    if (historyTr)\n        return historyTr.historyState;\n    if (tr.getMeta(closeHistoryKey))\n        history = new HistoryState(history.done, history.undone, null, 0, -1);\n    let appended = tr.getMeta(\"appendedTransaction\");\n    if (tr.steps.length == 0) {\n        return history;\n    }\n    else if (appended && appended.getMeta(historyKey)) {\n        if (appended.getMeta(historyKey).redo)\n            return new HistoryState(history.done.addTransform(tr, undefined, options, mustPreserveItems(state)), history.undone, rangesFor(tr.mapping.maps), history.prevTime, history.prevComposition);\n        else\n            return new HistoryState(history.done, history.undone.addTransform(tr, undefined, options, mustPreserveItems(state)), null, history.prevTime, history.prevComposition);\n    }\n    else if (tr.getMeta(\"addToHistory\") !== false && !(appended && appended.getMeta(\"addToHistory\") === false)) {\n        // Group transforms that occur in quick succession into one event.\n        let composition = tr.getMeta(\"composition\");\n        let newGroup = history.prevTime == 0 ||\n            (!appended && history.prevComposition != composition &&\n                (history.prevTime < (tr.time || 0) - options.newGroupDelay || !isAdjacentTo(tr, history.prevRanges)));\n        let prevRanges = appended ? mapRanges(history.prevRanges, tr.mapping) : rangesFor(tr.mapping.maps);\n        return new HistoryState(history.done.addTransform(tr, newGroup ? state.selection.getBookmark() : undefined, options, mustPreserveItems(state)), Branch.empty, prevRanges, tr.time, composition == null ? history.prevComposition : composition);\n    }\n    else if (rebased = tr.getMeta(\"rebased\")) {\n        // Used by the collab module to tell the history that some of its\n        // content has been rebased.\n        return new HistoryState(history.done.rebased(tr, rebased), history.undone.rebased(tr, rebased), mapRanges(history.prevRanges, tr.mapping), history.prevTime, history.prevComposition);\n    }\n    else {\n        return new HistoryState(history.done.addMaps(tr.mapping.maps), history.undone.addMaps(tr.mapping.maps), mapRanges(history.prevRanges, tr.mapping), history.prevTime, history.prevComposition);\n    }\n}\nfunction isAdjacentTo(transform, prevRanges) {\n    if (!prevRanges)\n        return false;\n    if (!transform.docChanged)\n        return true;\n    let adjacent = false;\n    transform.mapping.maps[0].forEach((start, end) => {\n        for (let i = 0; i < prevRanges.length; i += 2)\n            if (start <= prevRanges[i + 1] && end >= prevRanges[i])\n                adjacent = true;\n    });\n    return adjacent;\n}\nfunction rangesFor(maps) {\n    let result = [];\n    for (let i = maps.length - 1; i >= 0 && result.length == 0; i--)\n        maps[i].forEach((_from, _to, from, to) => result.push(from, to));\n    return result;\n}\nfunction mapRanges(ranges, mapping) {\n    if (!ranges)\n        return null;\n    let result = [];\n    for (let i = 0; i < ranges.length; i += 2) {\n        let from = mapping.map(ranges[i], 1), to = mapping.map(ranges[i + 1], -1);\n        if (from <= to)\n            result.push(from, to);\n    }\n    return result;\n}\n// Apply the latest event from one branch to the document and shift the event\n// onto the other branch.\nfunction histTransaction(history, state, redo) {\n    let preserveItems = mustPreserveItems(state);\n    let histOptions = historyKey.get(state).spec.config;\n    let pop = (redo ? history.undone : history.done).popEvent(state, preserveItems);\n    if (!pop)\n        return null;\n    let selection = pop.selection.resolve(pop.transform.doc);\n    let added = (redo ? history.done : history.undone).addTransform(pop.transform, state.selection.getBookmark(), histOptions, preserveItems);\n    let newHist = new HistoryState(redo ? added : pop.remaining, redo ? pop.remaining : added, null, 0, -1);\n    return pop.transform.setSelection(selection).setMeta(historyKey, { redo, historyState: newHist });\n}\nlet cachedPreserveItems = false, cachedPreserveItemsPlugins = null;\n// Check whether any plugin in the given state has a\n// `historyPreserveItems` property in its spec, in which case we must\n// preserve steps exactly as they came in, so that they can be\n// rebased.\nfunction mustPreserveItems(state) {\n    let plugins = state.plugins;\n    if (cachedPreserveItemsPlugins != plugins) {\n        cachedPreserveItems = false;\n        cachedPreserveItemsPlugins = plugins;\n        for (let i = 0; i < plugins.length; i++)\n            if (plugins[i].spec.historyPreserveItems) {\n                cachedPreserveItems = true;\n                break;\n            }\n    }\n    return cachedPreserveItems;\n}\n/**\nSet a flag on the given transaction that will prevent further steps\nfrom being appended to an existing history event (so that they\nrequire a separate undo command to undo).\n*/\nfunction closeHistory(tr) {\n    return tr.setMeta(closeHistoryKey, true);\n}\nconst historyKey = new PluginKey(\"history\");\nconst closeHistoryKey = new PluginKey(\"closeHistory\");\n/**\nReturns a plugin that enables the undo history for an editor. The\nplugin will track undo and redo stacks, which can be used with the\n[`undo`](https://prosemirror.net/docs/ref/#history.undo) and [`redo`](https://prosemirror.net/docs/ref/#history.redo) commands.\n\nYou can set an `\"addToHistory\"` [metadata\nproperty](https://prosemirror.net/docs/ref/#state.Transaction.setMeta) of `false` on a transaction\nto prevent it from being rolled back by undo.\n*/\nfunction history(config = {}) {\n    config = { depth: config.depth || 100,\n        newGroupDelay: config.newGroupDelay || 500 };\n    return new Plugin({\n        key: historyKey,\n        state: {\n            init() {\n                return new HistoryState(Branch.empty, Branch.empty, null, 0, -1);\n            },\n            apply(tr, hist, state) {\n                return applyTransaction(hist, state, tr, config);\n            }\n        },\n        config,\n        props: {\n            handleDOMEvents: {\n                beforeinput(view, e) {\n                    let inputType = e.inputType;\n                    let command = inputType == \"historyUndo\" ? undo : inputType == \"historyRedo\" ? redo : null;\n                    if (!command || !view.editable)\n                        return false;\n                    e.preventDefault();\n                    return command(view.state, view.dispatch);\n                }\n            }\n        }\n    });\n}\nfunction buildCommand(redo, scroll) {\n    return (state, dispatch) => {\n        let hist = historyKey.getState(state);\n        if (!hist || (redo ? hist.undone : hist.done).eventCount == 0)\n            return false;\n        if (dispatch) {\n            let tr = histTransaction(hist, state, redo);\n            if (tr)\n                dispatch(scroll ? tr.scrollIntoView() : tr);\n        }\n        return true;\n    };\n}\n/**\nA command function that undoes the last change, if any.\n*/\nconst undo = buildCommand(false, true);\n/**\nA command function that redoes the last undone change, if any.\n*/\nconst redo = buildCommand(true, true);\n/**\nA command function that undoes the last change. Don't scroll the\nselection into view.\n*/\nconst undoNoScroll = buildCommand(false, false);\n/**\nA command function that redoes the last undone change. Don't\nscroll the selection into view.\n*/\nconst redoNoScroll = buildCommand(true, false);\n/**\nThe amount of undoable events available in a given state.\n*/\nfunction undoDepth(state) {\n    let hist = historyKey.getState(state);\n    return hist ? hist.done.eventCount : 0;\n}\n/**\nThe amount of redoable events available in a given editor state.\n*/\nfunction redoDepth(state) {\n    let hist = historyKey.getState(state);\n    return hist ? hist.undone.eventCount : 0;\n}\n/**\nReturns true if the given transaction was generated by the history\nplugin.\n*/\nfunction isHistoryTransaction(tr) {\n    return tr.getMeta(historyKey) != null;\n}\n\nexport { closeHistory, history, isHistoryTransaction, redo, redoDepth, redoNoScroll, undo, undoDepth, undoNoScroll };\n","// src/character-count/character-count.ts\nimport { Extension } from \"@tiptap/core\";\nimport { Plugin, PluginKey } from \"@tiptap/pm/state\";\nvar CharacterCount = Extension.create({\n  name: \"characterCount\",\n  addOptions() {\n    return {\n      limit: null,\n      mode: \"textSize\",\n      textCounter: (text) => text.length,\n      wordCounter: (text) => text.split(\" \").filter((word) => word !== \"\").length\n    };\n  },\n  addStorage() {\n    return {\n      characters: () => 0,\n      words: () => 0\n    };\n  },\n  onBeforeCreate() {\n    this.storage.characters = (options) => {\n      const node = (options == null ? void 0 : options.node) || this.editor.state.doc;\n      const mode = (options == null ? void 0 : options.mode) || this.options.mode;\n      if (mode === \"textSize\") {\n        const text = node.textBetween(0, node.content.size, void 0, \" \");\n        return this.options.textCounter(text);\n      }\n      return node.nodeSize;\n    };\n    this.storage.words = (options) => {\n      const node = (options == null ? void 0 : options.node) || this.editor.state.doc;\n      const text = node.textBetween(0, node.content.size, \" \", \" \");\n      return this.options.wordCounter(text);\n    };\n  },\n  addProseMirrorPlugins() {\n    let initialEvaluationDone = false;\n    return [\n      new Plugin({\n        key: new PluginKey(\"characterCount\"),\n        appendTransaction: (transactions, oldState, newState) => {\n          if (initialEvaluationDone) {\n            return;\n          }\n          const limit = this.options.limit;\n          if (limit === null || limit === void 0 || limit === 0) {\n            initialEvaluationDone = true;\n            return;\n          }\n          const initialContentSize = this.storage.characters({ node: newState.doc });\n          if (initialContentSize > limit) {\n            const over = initialContentSize - limit;\n            const from = 0;\n            const to = over;\n            console.warn(\n              `[CharacterCount] Initial content exceeded limit of ${limit} characters. Content was automatically trimmed.`\n            );\n            const tr = newState.tr.deleteRange(from, to);\n            initialEvaluationDone = true;\n            return tr;\n          }\n          initialEvaluationDone = true;\n        },\n        filterTransaction: (transaction, state) => {\n          const limit = this.options.limit;\n          if (!transaction.docChanged || limit === 0 || limit === null || limit === void 0) {\n            return true;\n          }\n          const oldSize = this.storage.characters({ node: state.doc });\n          const newSize = this.storage.characters({ node: transaction.doc });\n          if (newSize <= limit) {\n            return true;\n          }\n          if (oldSize > limit && newSize > limit && newSize <= oldSize) {\n            return true;\n          }\n          if (oldSize > limit && newSize > limit && newSize > oldSize) {\n            return false;\n          }\n          const isPaste = transaction.getMeta(\"paste\");\n          if (!isPaste) {\n            return false;\n          }\n          const pos = transaction.selection.$head.pos;\n          const over = newSize - limit;\n          const from = pos - over;\n          const to = pos;\n          transaction.deleteRange(from, to);\n          const updatedSize = this.storage.characters({ node: transaction.doc });\n          if (updatedSize > limit) {\n            return false;\n          }\n          return true;\n        }\n      })\n    ];\n  }\n});\n\n// src/drop-cursor/drop-cursor.ts\nimport { Extension as Extension2 } from \"@tiptap/core\";\nimport { dropCursor } from \"@tiptap/pm/dropcursor\";\nvar Dropcursor = Extension2.create({\n  name: \"dropCursor\",\n  addOptions() {\n    return {\n      color: \"currentColor\",\n      width: 1,\n      class: void 0\n    };\n  },\n  addProseMirrorPlugins() {\n    return [dropCursor(this.options)];\n  }\n});\n\n// src/focus/focus.ts\nimport { Extension as Extension3 } from \"@tiptap/core\";\nimport { Plugin as Plugin2, PluginKey as PluginKey2 } from \"@tiptap/pm/state\";\nimport { Decoration, DecorationSet } from \"@tiptap/pm/view\";\nvar Focus = Extension3.create({\n  name: \"focus\",\n  addOptions() {\n    return {\n      className: \"has-focus\",\n      mode: \"all\"\n    };\n  },\n  addProseMirrorPlugins() {\n    return [\n      new Plugin2({\n        key: new PluginKey2(\"focus\"),\n        props: {\n          decorations: ({ doc, selection }) => {\n            const { isEditable, isFocused } = this.editor;\n            const { anchor } = selection;\n            const decorations = [];\n            if (!isEditable || !isFocused) {\n              return DecorationSet.create(doc, []);\n            }\n            let maxLevels = 0;\n            if (this.options.mode === \"deepest\") {\n              doc.descendants((node, pos) => {\n                if (node.isText) {\n                  return;\n                }\n                const isCurrent = anchor >= pos && anchor <= pos + node.nodeSize - 1;\n                if (!isCurrent) {\n                  return false;\n                }\n                maxLevels += 1;\n              });\n            }\n            let currentLevel = 0;\n            doc.descendants((node, pos) => {\n              if (node.isText) {\n                return false;\n              }\n              const isCurrent = anchor >= pos && anchor <= pos + node.nodeSize - 1;\n              if (!isCurrent) {\n                return false;\n              }\n              currentLevel += 1;\n              const outOfScope = this.options.mode === \"deepest\" && maxLevels - currentLevel > 0 || this.options.mode === \"shallowest\" && currentLevel > 1;\n              if (outOfScope) {\n                return this.options.mode === \"deepest\";\n              }\n              decorations.push(\n                Decoration.node(pos, pos + node.nodeSize, {\n                  class: this.options.className\n                })\n              );\n            });\n            return DecorationSet.create(doc, decorations);\n          }\n        }\n      })\n    ];\n  }\n});\n\n// src/gap-cursor/gap-cursor.ts\nimport { callOrReturn, Extension as Extension4, getExtensionField } from \"@tiptap/core\";\nimport { gapCursor } from \"@tiptap/pm/gapcursor\";\nvar Gapcursor = Extension4.create({\n  name: \"gapCursor\",\n  addProseMirrorPlugins() {\n    return [gapCursor()];\n  },\n  extendNodeSchema(extension) {\n    var _a;\n    const context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    return {\n      allowGapCursor: (_a = callOrReturn(getExtensionField(extension, \"allowGapCursor\", context))) != null ? _a : null\n    };\n  }\n});\n\n// src/placeholder/placeholder.ts\nimport { Extension as Extension5, isNodeEmpty } from \"@tiptap/core\";\nimport { Plugin as Plugin3, PluginKey as PluginKey3 } from \"@tiptap/pm/state\";\nimport { Decoration as Decoration2, DecorationSet as DecorationSet2 } from \"@tiptap/pm/view\";\nvar DEFAULT_DATA_ATTRIBUTE = \"placeholder\";\nfunction preparePlaceholderAttribute(attr) {\n  return attr.replace(/\\s+/g, \"-\").replace(/[^a-zA-Z0-9-]/g, \"\").replace(/^[0-9-]+/, \"\").replace(/^-+/, \"\").toLowerCase();\n}\nvar Placeholder = Extension5.create({\n  name: \"placeholder\",\n  addOptions() {\n    return {\n      emptyEditorClass: \"is-editor-empty\",\n      emptyNodeClass: \"is-empty\",\n      dataAttribute: DEFAULT_DATA_ATTRIBUTE,\n      placeholder: \"Write something \\u2026\",\n      showOnlyWhenEditable: true,\n      showOnlyCurrent: true,\n      includeChildren: false\n    };\n  },\n  addProseMirrorPlugins() {\n    const dataAttribute = this.options.dataAttribute ? `data-${preparePlaceholderAttribute(this.options.dataAttribute)}` : `data-${DEFAULT_DATA_ATTRIBUTE}`;\n    return [\n      new Plugin3({\n        key: new PluginKey3(\"placeholder\"),\n        props: {\n          decorations: ({ doc, selection }) => {\n            const active = this.editor.isEditable || !this.options.showOnlyWhenEditable;\n            const { anchor } = selection;\n            const decorations = [];\n            if (!active) {\n              return null;\n            }\n            const isEmptyDoc = this.editor.isEmpty;\n            doc.descendants((node, pos) => {\n              const hasAnchor = anchor >= pos && anchor <= pos + node.nodeSize;\n              const isEmpty = !node.isLeaf && isNodeEmpty(node);\n              if ((hasAnchor || !this.options.showOnlyCurrent) && isEmpty) {\n                const classes = [this.options.emptyNodeClass];\n                if (isEmptyDoc) {\n                  classes.push(this.options.emptyEditorClass);\n                }\n                const decoration = Decoration2.node(pos, pos + node.nodeSize, {\n                  class: classes.join(\" \"),\n                  [dataAttribute]: typeof this.options.placeholder === \"function\" ? this.options.placeholder({\n                    editor: this.editor,\n                    node,\n                    pos,\n                    hasAnchor\n                  }) : this.options.placeholder\n                });\n                decorations.push(decoration);\n              }\n              return this.options.includeChildren;\n            });\n            return DecorationSet2.create(doc, decorations);\n          }\n        }\n      })\n    ];\n  }\n});\n\n// src/selection/selection.ts\nimport { Extension as Extension6, isNodeSelection } from \"@tiptap/core\";\nimport { Plugin as Plugin4, PluginKey as PluginKey4 } from \"@tiptap/pm/state\";\nimport { Decoration as Decoration3, DecorationSet as DecorationSet3 } from \"@tiptap/pm/view\";\nvar Selection = Extension6.create({\n  name: \"selection\",\n  addOptions() {\n    return {\n      className: \"selection\"\n    };\n  },\n  addProseMirrorPlugins() {\n    const { editor, options } = this;\n    return [\n      new Plugin4({\n        key: new PluginKey4(\"selection\"),\n        props: {\n          decorations(state) {\n            if (state.selection.empty || editor.isFocused || !editor.isEditable || isNodeSelection(state.selection) || editor.view.dragging) {\n              return null;\n            }\n            return DecorationSet3.create(state.doc, [\n              Decoration3.inline(state.selection.from, state.selection.to, {\n                class: options.className\n              })\n            ]);\n          }\n        }\n      })\n    ];\n  }\n});\n\n// src/trailing-node/trailing-node.ts\nimport { Extension as Extension7 } from \"@tiptap/core\";\nimport { Plugin as Plugin5, PluginKey as PluginKey5 } from \"@tiptap/pm/state\";\nfunction nodeEqualsType({ types, node }) {\n  return node && Array.isArray(types) && types.includes(node.type) || (node == null ? void 0 : node.type) === types;\n}\nvar TrailingNode = Extension7.create({\n  name: \"trailingNode\",\n  addOptions() {\n    return {\n      node: void 0,\n      notAfter: []\n    };\n  },\n  addProseMirrorPlugins() {\n    var _a;\n    const plugin = new PluginKey5(this.name);\n    const defaultNode = this.options.node || ((_a = this.editor.schema.topNodeType.contentMatch.defaultType) == null ? void 0 : _a.name) || \"paragraph\";\n    const disabledNodes = Object.entries(this.editor.schema.nodes).map(([, value]) => value).filter((node) => (this.options.notAfter || []).concat(defaultNode).includes(node.name));\n    return [\n      new Plugin5({\n        key: plugin,\n        appendTransaction: (_, __, state) => {\n          const { doc, tr, schema } = state;\n          const shouldInsertNodeAtEnd = plugin.getState(state);\n          const endPosition = doc.content.size;\n          const type = schema.nodes[defaultNode];\n          if (!shouldInsertNodeAtEnd) {\n            return;\n          }\n          return tr.insert(endPosition, type.create());\n        },\n        state: {\n          init: (_, state) => {\n            const lastNode = state.tr.doc.lastChild;\n            return !nodeEqualsType({ node: lastNode, types: disabledNodes });\n          },\n          apply: (tr, value) => {\n            if (!tr.docChanged) {\n              return value;\n            }\n            if (tr.getMeta(\"__uniqueIDTransaction\")) {\n              return value;\n            }\n            const lastNode = tr.doc.lastChild;\n            return !nodeEqualsType({ node: lastNode, types: disabledNodes });\n          }\n        }\n      })\n    ];\n  }\n});\n\n// src/undo-redo/undo-redo.ts\nimport { Extension as Extension8 } from \"@tiptap/core\";\nimport { history, redo, undo } from \"@tiptap/pm/history\";\nvar UndoRedo = Extension8.create({\n  name: \"undoRedo\",\n  addOptions() {\n    return {\n      depth: 100,\n      newGroupDelay: 500\n    };\n  },\n  addCommands() {\n    return {\n      undo: () => ({ state, dispatch }) => {\n        return undo(state, dispatch);\n      },\n      redo: () => ({ state, dispatch }) => {\n        return redo(state, dispatch);\n      }\n    };\n  },\n  addProseMirrorPlugins() {\n    return [history(this.options)];\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-z\": () => this.editor.commands.undo(),\n      \"Shift-Mod-z\": () => this.editor.commands.redo(),\n      \"Mod-y\": () => this.editor.commands.redo(),\n      // Russian keyboard layouts\n      \"Mod-\\u044F\": () => this.editor.commands.undo(),\n      \"Shift-Mod-\\u044F\": () => this.editor.commands.redo()\n    };\n  }\n});\nexport {\n  CharacterCount,\n  Dropcursor,\n  Focus,\n  Gapcursor,\n  Placeholder,\n  Selection,\n  TrailingNode,\n  UndoRedo,\n  preparePlaceholderAttribute\n};\n//# sourceMappingURL=index.js.map","// src/starter-kit.ts\nimport { Extension } from \"@tiptap/core\";\nimport { Blockquote } from \"@tiptap/extension-blockquote\";\nimport { Bold } from \"@tiptap/extension-bold\";\nimport { Code } from \"@tiptap/extension-code\";\nimport { CodeBlock } from \"@tiptap/extension-code-block\";\nimport { Document } from \"@tiptap/extension-document\";\nimport { HardBreak } from \"@tiptap/extension-hard-break\";\nimport { Heading } from \"@tiptap/extension-heading\";\nimport { HorizontalRule } from \"@tiptap/extension-horizontal-rule\";\nimport { Italic } from \"@tiptap/extension-italic\";\nimport { Link } from \"@tiptap/extension-link\";\nimport { BulletList, ListItem, ListKeymap, OrderedList } from \"@tiptap/extension-list\";\nimport { Paragraph } from \"@tiptap/extension-paragraph\";\nimport { Strike } from \"@tiptap/extension-strike\";\nimport { Text } from \"@tiptap/extension-text\";\nimport { Underline } from \"@tiptap/extension-underline\";\nimport { Dropcursor, Gapcursor, TrailingNode, UndoRedo } from \"@tiptap/extensions\";\nvar StarterKit = Extension.create({\n  name: \"starterKit\",\n  addExtensions() {\n    var _a, _b, _c, _d;\n    const extensions = [];\n    if (this.options.bold !== false) {\n      extensions.push(Bold.configure(this.options.bold));\n    }\n    if (this.options.blockquote !== false) {\n      extensions.push(Blockquote.configure(this.options.blockquote));\n    }\n    if (this.options.bulletList !== false) {\n      extensions.push(BulletList.configure(this.options.bulletList));\n    }\n    if (this.options.code !== false) {\n      extensions.push(Code.configure(this.options.code));\n    }\n    if (this.options.codeBlock !== false) {\n      extensions.push(CodeBlock.configure(this.options.codeBlock));\n    }\n    if (this.options.document !== false) {\n      extensions.push(Document.configure(this.options.document));\n    }\n    if (this.options.dropcursor !== false) {\n      extensions.push(Dropcursor.configure(this.options.dropcursor));\n    }\n    if (this.options.gapcursor !== false) {\n      extensions.push(Gapcursor.configure(this.options.gapcursor));\n    }\n    if (this.options.hardBreak !== false) {\n      extensions.push(HardBreak.configure(this.options.hardBreak));\n    }\n    if (this.options.heading !== false) {\n      extensions.push(Heading.configure(this.options.heading));\n    }\n    if (this.options.undoRedo !== false) {\n      extensions.push(UndoRedo.configure(this.options.undoRedo));\n    }\n    if (this.options.horizontalRule !== false) {\n      extensions.push(HorizontalRule.configure(this.options.horizontalRule));\n    }\n    if (this.options.italic !== false) {\n      extensions.push(Italic.configure(this.options.italic));\n    }\n    if (this.options.listItem !== false) {\n      extensions.push(ListItem.configure(this.options.listItem));\n    }\n    if (this.options.listKeymap !== false) {\n      extensions.push(ListKeymap.configure((_a = this.options) == null ? void 0 : _a.listKeymap));\n    }\n    if (this.options.link !== false) {\n      extensions.push(Link.configure((_b = this.options) == null ? void 0 : _b.link));\n    }\n    if (this.options.orderedList !== false) {\n      extensions.push(OrderedList.configure(this.options.orderedList));\n    }\n    if (this.options.paragraph !== false) {\n      extensions.push(Paragraph.configure(this.options.paragraph));\n    }\n    if (this.options.strike !== false) {\n      extensions.push(Strike.configure(this.options.strike));\n    }\n    if (this.options.text !== false) {\n      extensions.push(Text.configure(this.options.text));\n    }\n    if (this.options.underline !== false) {\n      extensions.push(Underline.configure((_c = this.options) == null ? void 0 : _c.underline));\n    }\n    if (this.options.trailingNode !== false) {\n      extensions.push(TrailingNode.configure((_d = this.options) == null ? void 0 : _d.trailingNode));\n    }\n    return extensions;\n  }\n});\n\n// src/index.ts\nvar index_default = StarterKit;\nexport {\n  StarterKit,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","// src/text-style/index.ts\nimport { Mark, mergeAttributes } from \"@tiptap/core\";\nvar MAX_FIND_CHILD_SPAN_DEPTH = 20;\nvar findChildSpans = (element, depth = 0) => {\n  const childSpans = [];\n  if (!element.children.length || depth > MAX_FIND_CHILD_SPAN_DEPTH) {\n    return childSpans;\n  }\n  Array.from(element.children).forEach((child) => {\n    if (child.tagName === \"SPAN\") {\n      childSpans.push(child);\n    } else if (child.children.length) {\n      childSpans.push(...findChildSpans(child, depth + 1));\n    }\n  });\n  return childSpans;\n};\nvar mergeNestedSpanStyles = (element) => {\n  if (!element.children.length) {\n    return;\n  }\n  const childSpans = findChildSpans(element);\n  if (!childSpans) {\n    return;\n  }\n  childSpans.forEach((childSpan) => {\n    var _a, _b;\n    const childStyle = childSpan.getAttribute(\"style\");\n    const closestParentSpanStyleOfChild = (_b = (_a = childSpan.parentElement) == null ? void 0 : _a.closest(\"span\")) == null ? void 0 : _b.getAttribute(\"style\");\n    childSpan.setAttribute(\"style\", `${closestParentSpanStyleOfChild};${childStyle}`);\n  });\n};\nvar TextStyle = Mark.create({\n  name: \"textStyle\",\n  priority: 101,\n  addOptions() {\n    return {\n      HTMLAttributes: {},\n      mergeNestedSpanStyles: true\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"span\",\n        consuming: false,\n        getAttrs: (element) => {\n          const hasStyles = element.hasAttribute(\"style\");\n          if (!hasStyles) {\n            return false;\n          }\n          if (this.options.mergeNestedSpanStyles) {\n            mergeNestedSpanStyles(element);\n          }\n          return {};\n        }\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"span\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  addCommands() {\n    return {\n      toggleTextStyle: (attributes) => ({ commands }) => {\n        return commands.toggleMark(this.name, attributes);\n      },\n      removeEmptyTextStyle: () => ({ tr }) => {\n        const { selection } = tr;\n        tr.doc.nodesBetween(selection.from, selection.to, (node, pos) => {\n          if (node.isTextblock) {\n            return true;\n          }\n          if (!node.marks.filter((mark) => mark.type === this.type).some((mark) => Object.values(mark.attrs).some((value) => !!value))) {\n            tr.removeMark(pos, pos + node.nodeSize, this.type);\n          }\n        });\n        return true;\n      }\n    };\n  }\n});\n\n// src/background-color/background-color.ts\nimport { Extension } from \"@tiptap/core\";\nvar BackgroundColor = Extension.create({\n  name: \"backgroundColor\",\n  addOptions() {\n    return {\n      types: [\"textStyle\"]\n    };\n  },\n  addGlobalAttributes() {\n    return [\n      {\n        types: this.options.types,\n        attributes: {\n          backgroundColor: {\n            default: null,\n            parseHTML: (element) => {\n              var _a;\n              const styleAttr = element.getAttribute(\"style\");\n              if (styleAttr) {\n                const decls = styleAttr.split(\";\").map((s) => s.trim()).filter(Boolean);\n                for (let i = decls.length - 1; i >= 0; i -= 1) {\n                  const parts = decls[i].split(\":\");\n                  if (parts.length >= 2) {\n                    const prop = parts[0].trim().toLowerCase();\n                    const val = parts.slice(1).join(\":\").trim();\n                    if (prop === \"background-color\") {\n                      return val.replace(/['\"]+/g, \"\");\n                    }\n                  }\n                }\n              }\n              return (_a = element.style.backgroundColor) == null ? void 0 : _a.replace(/['\"]+/g, \"\");\n            },\n            renderHTML: (attributes) => {\n              if (!attributes.backgroundColor) {\n                return {};\n              }\n              return {\n                style: `background-color: ${attributes.backgroundColor}`\n              };\n            }\n          }\n        }\n      }\n    ];\n  },\n  addCommands() {\n    return {\n      setBackgroundColor: (backgroundColor) => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { backgroundColor }).run();\n      },\n      unsetBackgroundColor: () => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { backgroundColor: null }).removeEmptyTextStyle().run();\n      }\n    };\n  }\n});\n\n// src/color/color.ts\nimport { Extension as Extension2 } from \"@tiptap/core\";\nvar Color = Extension2.create({\n  name: \"color\",\n  addOptions() {\n    return {\n      types: [\"textStyle\"]\n    };\n  },\n  addGlobalAttributes() {\n    return [\n      {\n        types: this.options.types,\n        attributes: {\n          color: {\n            default: null,\n            parseHTML: (element) => {\n              var _a;\n              const styleAttr = element.getAttribute(\"style\");\n              if (styleAttr) {\n                const decls = styleAttr.split(\";\").map((s) => s.trim()).filter(Boolean);\n                for (let i = decls.length - 1; i >= 0; i -= 1) {\n                  const parts = decls[i].split(\":\");\n                  if (parts.length >= 2) {\n                    const prop = parts[0].trim().toLowerCase();\n                    const val = parts.slice(1).join(\":\").trim();\n                    if (prop === \"color\") {\n                      return val.replace(/['\"]+/g, \"\");\n                    }\n                  }\n                }\n              }\n              return (_a = element.style.color) == null ? void 0 : _a.replace(/['\"]+/g, \"\");\n            },\n            renderHTML: (attributes) => {\n              if (!attributes.color) {\n                return {};\n              }\n              return {\n                style: `color: ${attributes.color}`\n              };\n            }\n          }\n        }\n      }\n    ];\n  },\n  addCommands() {\n    return {\n      setColor: (color) => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { color }).run();\n      },\n      unsetColor: () => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { color: null }).removeEmptyTextStyle().run();\n      }\n    };\n  }\n});\n\n// src/font-family/font-family.ts\nimport { Extension as Extension3 } from \"@tiptap/core\";\nvar FontFamily = Extension3.create({\n  name: \"fontFamily\",\n  addOptions() {\n    return {\n      types: [\"textStyle\"]\n    };\n  },\n  addGlobalAttributes() {\n    return [\n      {\n        types: this.options.types,\n        attributes: {\n          fontFamily: {\n            default: null,\n            parseHTML: (element) => element.style.fontFamily,\n            renderHTML: (attributes) => {\n              if (!attributes.fontFamily) {\n                return {};\n              }\n              return {\n                style: `font-family: ${attributes.fontFamily}`\n              };\n            }\n          }\n        }\n      }\n    ];\n  },\n  addCommands() {\n    return {\n      setFontFamily: (fontFamily) => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { fontFamily }).run();\n      },\n      unsetFontFamily: () => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { fontFamily: null }).removeEmptyTextStyle().run();\n      }\n    };\n  }\n});\n\n// src/font-size/font-size.ts\nimport { Extension as Extension4 } from \"@tiptap/core\";\nvar FontSize = Extension4.create({\n  name: \"fontSize\",\n  addOptions() {\n    return {\n      types: [\"textStyle\"]\n    };\n  },\n  addGlobalAttributes() {\n    return [\n      {\n        types: this.options.types,\n        attributes: {\n          fontSize: {\n            default: null,\n            parseHTML: (element) => element.style.fontSize,\n            renderHTML: (attributes) => {\n              if (!attributes.fontSize) {\n                return {};\n              }\n              return {\n                style: `font-size: ${attributes.fontSize}`\n              };\n            }\n          }\n        }\n      }\n    ];\n  },\n  addCommands() {\n    return {\n      setFontSize: (fontSize) => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { fontSize }).run();\n      },\n      unsetFontSize: () => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { fontSize: null }).removeEmptyTextStyle().run();\n      }\n    };\n  }\n});\n\n// src/line-height/line-height.ts\nimport { Extension as Extension5 } from \"@tiptap/core\";\nvar LineHeight = Extension5.create({\n  name: \"lineHeight\",\n  addOptions() {\n    return {\n      types: [\"textStyle\"]\n    };\n  },\n  addGlobalAttributes() {\n    return [\n      {\n        types: this.options.types,\n        attributes: {\n          lineHeight: {\n            default: null,\n            parseHTML: (element) => element.style.lineHeight,\n            renderHTML: (attributes) => {\n              if (!attributes.lineHeight) {\n                return {};\n              }\n              return {\n                style: `line-height: ${attributes.lineHeight}`\n              };\n            }\n          }\n        }\n      }\n    ];\n  },\n  addCommands() {\n    return {\n      setLineHeight: (lineHeight) => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { lineHeight }).run();\n      },\n      unsetLineHeight: () => ({ chain }) => {\n        return chain().setMark(\"textStyle\", { lineHeight: null }).removeEmptyTextStyle().run();\n      }\n    };\n  }\n});\n\n// src/text-style-kit/index.ts\nimport { Extension as Extension6 } from \"@tiptap/core\";\nvar TextStyleKit = Extension6.create({\n  name: \"textStyleKit\",\n  addExtensions() {\n    const extensions = [];\n    if (this.options.backgroundColor !== false) {\n      extensions.push(BackgroundColor.configure(this.options.backgroundColor));\n    }\n    if (this.options.color !== false) {\n      extensions.push(Color.configure(this.options.color));\n    }\n    if (this.options.fontFamily !== false) {\n      extensions.push(FontFamily.configure(this.options.fontFamily));\n    }\n    if (this.options.fontSize !== false) {\n      extensions.push(FontSize.configure(this.options.fontSize));\n    }\n    if (this.options.lineHeight !== false) {\n      extensions.push(LineHeight.configure(this.options.lineHeight));\n    }\n    if (this.options.textStyle !== false) {\n      extensions.push(TextStyle.configure(this.options.textStyle));\n    }\n    return extensions;\n  }\n});\nexport {\n  BackgroundColor,\n  Color,\n  FontFamily,\n  FontSize,\n  LineHeight,\n  TextStyle,\n  TextStyleKit\n};\n//# sourceMappingURL=index.js.map","// src/text-align.ts\nimport { Extension } from \"@tiptap/core\";\nvar TextAlign = Extension.create({\n  name: \"textAlign\",\n  addOptions() {\n    return {\n      types: [],\n      alignments: [\"left\", \"center\", \"right\", \"justify\"],\n      defaultAlignment: null\n    };\n  },\n  addGlobalAttributes() {\n    return [\n      {\n        types: this.options.types,\n        attributes: {\n          textAlign: {\n            default: this.options.defaultAlignment,\n            parseHTML: (element) => {\n              const alignment = element.style.textAlign;\n              return this.options.alignments.includes(alignment) ? alignment : this.options.defaultAlignment;\n            },\n            renderHTML: (attributes) => {\n              if (!attributes.textAlign) {\n                return {};\n              }\n              return { style: `text-align: ${attributes.textAlign}` };\n            }\n          }\n        }\n      }\n    ];\n  },\n  addCommands() {\n    return {\n      setTextAlign: (alignment) => ({ commands }) => {\n        if (!this.options.alignments.includes(alignment)) {\n          return false;\n        }\n        return this.options.types.map((type) => commands.updateAttributes(type, { textAlign: alignment })).some((response) => response);\n      },\n      unsetTextAlign: () => ({ commands }) => {\n        return this.options.types.map((type) => commands.resetAttributes(type, \"textAlign\")).some((response) => response);\n      },\n      toggleTextAlign: (alignment) => ({ editor, commands }) => {\n        if (!this.options.alignments.includes(alignment)) {\n          return false;\n        }\n        if (editor.isActive({ textAlign: alignment })) {\n          return commands.unsetTextAlign();\n        }\n        return commands.setTextAlign(alignment);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Shift-l\": () => this.editor.commands.setTextAlign(\"left\"),\n      \"Mod-Shift-e\": () => this.editor.commands.setTextAlign(\"center\"),\n      \"Mod-Shift-r\": () => this.editor.commands.setTextAlign(\"right\"),\n      \"Mod-Shift-j\": () => this.editor.commands.setTextAlign(\"justify\")\n    };\n  }\n});\n\n// src/index.ts\nvar index_default = TextAlign;\nexport {\n  TextAlign,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","// src/highlight.ts\nimport { Mark, markInputRule, markPasteRule, mergeAttributes } from \"@tiptap/core\";\nvar inputRegex = /(?:^|\\s)(==(?!\\s+==)((?:[^=]+))==(?!\\s+==))$/;\nvar pasteRegex = /(?:^|\\s)(==(?!\\s+==)((?:[^=]+))==(?!\\s+==))/g;\nvar Highlight = Mark.create({\n  name: \"highlight\",\n  addOptions() {\n    return {\n      multicolor: false,\n      HTMLAttributes: {}\n    };\n  },\n  addAttributes() {\n    if (!this.options.multicolor) {\n      return {};\n    }\n    return {\n      color: {\n        default: null,\n        parseHTML: (element) => element.getAttribute(\"data-color\") || element.style.backgroundColor,\n        renderHTML: (attributes) => {\n          if (!attributes.color) {\n            return {};\n          }\n          return {\n            \"data-color\": attributes.color,\n            style: `background-color: ${attributes.color}; color: inherit`\n          };\n        }\n      }\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: \"mark\"\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"mark\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  },\n  renderMarkdown: (node, h) => {\n    return `==${h.renderChildren(node)}==`;\n  },\n  parseMarkdown: (token, h) => {\n    return h.applyMark(\"highlight\", h.parseInline(token.tokens || []));\n  },\n  markdownTokenizer: {\n    name: \"highlight\",\n    level: \"inline\",\n    start: (src) => src.indexOf(\"==\"),\n    tokenize(src, _, h) {\n      const rule = /^(==)([^=]+)(==)/;\n      const match = rule.exec(src);\n      if (match) {\n        const innerContent = match[2].trim();\n        const children = h.inlineTokens(innerContent);\n        return {\n          type: \"highlight\",\n          raw: match[0],\n          text: innerContent,\n          tokens: children\n        };\n      }\n    }\n  },\n  addCommands() {\n    return {\n      setHighlight: (attributes) => ({ commands }) => {\n        return commands.setMark(this.name, attributes);\n      },\n      toggleHighlight: (attributes) => ({ commands }) => {\n        return commands.toggleMark(this.name, attributes);\n      },\n      unsetHighlight: () => ({ commands }) => {\n        return commands.unsetMark(this.name);\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      \"Mod-Shift-h\": () => this.editor.commands.toggleHighlight()\n    };\n  },\n  addInputRules() {\n    return [\n      markInputRule({\n        find: inputRegex,\n        type: this.type\n      })\n    ];\n  },\n  addPasteRules() {\n    return [\n      markPasteRule({\n        find: pasteRegex,\n        type: this.type\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = Highlight;\nexport {\n  Highlight,\n  index_default as default,\n  inputRegex,\n  pasteRegex\n};\n//# sourceMappingURL=index.js.map","// src/image.ts\nimport { mergeAttributes, Node, nodeInputRule, ResizableNodeView } from \"@tiptap/core\";\nvar inputRegex = /(?:^|\\s)(!\\[(.+|:?)]\\((\\S+)(?:(?:\\s+)[\"'](\\S+)[\"'])?\\))$/;\nvar Image = Node.create({\n  name: \"image\",\n  addOptions() {\n    return {\n      inline: false,\n      allowBase64: false,\n      HTMLAttributes: {},\n      resize: false\n    };\n  },\n  inline() {\n    return this.options.inline;\n  },\n  group() {\n    return this.options.inline ? \"inline\" : \"block\";\n  },\n  draggable: true,\n  addAttributes() {\n    return {\n      src: {\n        default: null\n      },\n      alt: {\n        default: null\n      },\n      title: {\n        default: null\n      },\n      width: {\n        default: null\n      },\n      height: {\n        default: null\n      }\n    };\n  },\n  parseHTML() {\n    return [\n      {\n        tag: this.options.allowBase64 ? \"img[src]\" : 'img[src]:not([src^=\"data:\"])'\n      }\n    ];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"img\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes)];\n  },\n  parseMarkdown: (token, helpers) => {\n    return helpers.createNode(\"image\", {\n      src: token.href,\n      title: token.title,\n      alt: token.text\n    });\n  },\n  renderMarkdown: (node) => {\n    var _a, _b, _c, _d, _e, _f;\n    const src = (_b = (_a = node.attrs) == null ? void 0 : _a.src) != null ? _b : \"\";\n    const alt = (_d = (_c = node.attrs) == null ? void 0 : _c.alt) != null ? _d : \"\";\n    const title = (_f = (_e = node.attrs) == null ? void 0 : _e.title) != null ? _f : \"\";\n    return title ? `![${alt}](${src} \"${title}\")` : `![${alt}](${src})`;\n  },\n  addNodeView() {\n    if (!this.options.resize || !this.options.resize.enabled || typeof document === \"undefined\") {\n      return null;\n    }\n    const { directions, minWidth, minHeight, alwaysPreserveAspectRatio } = this.options.resize;\n    return ({ node, getPos, HTMLAttributes, editor }) => {\n      const el = document.createElement(\"img\");\n      Object.entries(HTMLAttributes).forEach(([key, value]) => {\n        if (value != null) {\n          switch (key) {\n            case \"width\":\n            case \"height\":\n              break;\n            default:\n              el.setAttribute(key, value);\n              break;\n          }\n        }\n      });\n      el.src = HTMLAttributes.src;\n      const nodeView = new ResizableNodeView({\n        element: el,\n        editor,\n        node,\n        getPos,\n        onResize: (width, height) => {\n          el.style.width = `${width}px`;\n          el.style.height = `${height}px`;\n        },\n        onCommit: (width, height) => {\n          const pos = getPos();\n          if (pos === void 0) {\n            return;\n          }\n          this.editor.chain().setNodeSelection(pos).updateAttributes(this.name, {\n            width,\n            height\n          }).run();\n        },\n        onUpdate: (updatedNode, _decorations, _innerDecorations) => {\n          if (updatedNode.type !== node.type) {\n            return false;\n          }\n          return true;\n        },\n        options: {\n          directions,\n          min: {\n            width: minWidth,\n            height: minHeight\n          },\n          preserveAspectRatio: alwaysPreserveAspectRatio === true\n        }\n      });\n      const dom = nodeView.dom;\n      dom.style.visibility = \"hidden\";\n      dom.style.pointerEvents = \"none\";\n      el.onload = () => {\n        dom.style.visibility = \"\";\n        dom.style.pointerEvents = \"\";\n      };\n      return nodeView;\n    };\n  },\n  addCommands() {\n    return {\n      setImage: (options) => ({ commands }) => {\n        return commands.insertContent({\n          type: this.name,\n          attrs: options\n        });\n      }\n    };\n  },\n  addInputRules() {\n    return [\n      nodeInputRule({\n        find: inputRegex,\n        type: this.type,\n        getAttributes: (match) => {\n          const [, , alt, src, title] = match;\n          return { src, alt, title };\n        }\n      })\n    ];\n  }\n});\n\n// src/index.ts\nvar index_default = Image;\nexport {\n  Image,\n  index_default as default,\n  inputRegex\n};\n//# sourceMappingURL=index.js.map","import { NodeSelection, Plugin, PluginKey, Selection, SelectionRange, TextSelection } from \"prosemirror-state\";\nimport { Fragment, Slice } from \"prosemirror-model\";\nimport { Decoration, DecorationSet } from \"prosemirror-view\";\nimport { keydownHandler } from \"prosemirror-keymap\";\nimport { Transform } from \"prosemirror-transform\";\n\n//#region src/tablemap.ts\nlet readFromCache;\nlet addToCache;\nif (typeof WeakMap != \"undefined\") {\n\tlet cache = /* @__PURE__ */ new WeakMap();\n\treadFromCache = (key) => cache.get(key);\n\taddToCache = (key, value) => {\n\t\tcache.set(key, value);\n\t\treturn value;\n\t};\n} else {\n\tconst cache = [];\n\tconst cacheSize = 10;\n\tlet cachePos = 0;\n\treadFromCache = (key) => {\n\t\tfor (let i = 0; i < cache.length; i += 2) if (cache[i] == key) return cache[i + 1];\n\t};\n\taddToCache = (key, value) => {\n\t\tif (cachePos == cacheSize) cachePos = 0;\n\t\tcache[cachePos++] = key;\n\t\treturn cache[cachePos++] = value;\n\t};\n}\n/**\n* A table map describes the structure of a given table. To avoid\n* recomputing them all the time, they are cached per table node. To\n* be able to do that, positions saved in the map are relative to the\n* start of the table, rather than the start of the document.\n*\n* @public\n*/\nvar TableMap = class {\n\tconstructor(width, height, map, problems) {\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.map = map;\n\t\tthis.problems = problems;\n\t}\n\tfindCell(pos) {\n\t\tfor (let i = 0; i < this.map.length; i++) {\n\t\t\tconst curPos = this.map[i];\n\t\t\tif (curPos != pos) continue;\n\t\t\tconst left = i % this.width;\n\t\t\tconst top = i / this.width | 0;\n\t\t\tlet right = left + 1;\n\t\t\tlet bottom = top + 1;\n\t\t\tfor (let j = 1; right < this.width && this.map[i + j] == curPos; j++) right++;\n\t\t\tfor (let j = 1; bottom < this.height && this.map[i + this.width * j] == curPos; j++) bottom++;\n\t\t\treturn {\n\t\t\t\tleft,\n\t\t\t\ttop,\n\t\t\t\tright,\n\t\t\t\tbottom\n\t\t\t};\n\t\t}\n\t\tthrow new RangeError(`No cell with offset ${pos} found`);\n\t}\n\tcolCount(pos) {\n\t\tfor (let i = 0; i < this.map.length; i++) if (this.map[i] == pos) return i % this.width;\n\t\tthrow new RangeError(`No cell with offset ${pos} found`);\n\t}\n\tnextCell(pos, axis, dir) {\n\t\tconst { left, right, top, bottom } = this.findCell(pos);\n\t\tif (axis == \"horiz\") {\n\t\t\tif (dir < 0 ? left == 0 : right == this.width) return null;\n\t\t\treturn this.map[top * this.width + (dir < 0 ? left - 1 : right)];\n\t\t} else {\n\t\t\tif (dir < 0 ? top == 0 : bottom == this.height) return null;\n\t\t\treturn this.map[left + this.width * (dir < 0 ? top - 1 : bottom)];\n\t\t}\n\t}\n\trectBetween(a, b) {\n\t\tconst { left: leftA, right: rightA, top: topA, bottom: bottomA } = this.findCell(a);\n\t\tconst { left: leftB, right: rightB, top: topB, bottom: bottomB } = this.findCell(b);\n\t\treturn {\n\t\t\tleft: Math.min(leftA, leftB),\n\t\t\ttop: Math.min(topA, topB),\n\t\t\tright: Math.max(rightA, rightB),\n\t\t\tbottom: Math.max(bottomA, bottomB)\n\t\t};\n\t}\n\tcellsInRect(rect) {\n\t\tconst result = [];\n\t\tconst seen = {};\n\t\tfor (let row = rect.top; row < rect.bottom; row++) for (let col = rect.left; col < rect.right; col++) {\n\t\t\tconst index = row * this.width + col;\n\t\t\tconst pos = this.map[index];\n\t\t\tif (seen[pos]) continue;\n\t\t\tseen[pos] = true;\n\t\t\tif (col == rect.left && col && this.map[index - 1] == pos || row == rect.top && row && this.map[index - this.width] == pos) continue;\n\t\t\tresult.push(pos);\n\t\t}\n\t\treturn result;\n\t}\n\tpositionAt(row, col, table) {\n\t\tfor (let i = 0, rowStart = 0;; i++) {\n\t\t\tconst rowEnd = rowStart + table.child(i).nodeSize;\n\t\t\tif (i == row) {\n\t\t\t\tlet index = col + row * this.width;\n\t\t\t\tconst rowEndIndex = (row + 1) * this.width;\n\t\t\t\twhile (index < rowEndIndex && this.map[index] < rowStart) index++;\n\t\t\t\treturn index == rowEndIndex ? rowEnd - 1 : this.map[index];\n\t\t\t}\n\t\t\trowStart = rowEnd;\n\t\t}\n\t}\n\tstatic get(table) {\n\t\treturn readFromCache(table) || addToCache(table, computeMap(table));\n\t}\n};\nfunction computeMap(table) {\n\tif (table.type.spec.tableRole != \"table\") throw new RangeError(\"Not a table node: \" + table.type.name);\n\tconst width = findWidth(table), height = table.childCount;\n\tconst map = [];\n\tlet mapPos = 0;\n\tlet problems = null;\n\tconst colWidths = [];\n\tfor (let i = 0, e = width * height; i < e; i++) map[i] = 0;\n\tfor (let row = 0, pos = 0; row < height; row++) {\n\t\tconst rowNode = table.child(row);\n\t\tpos++;\n\t\tfor (let i = 0;; i++) {\n\t\t\twhile (mapPos < map.length && map[mapPos] != 0) mapPos++;\n\t\t\tif (i == rowNode.childCount) break;\n\t\t\tconst cellNode = rowNode.child(i);\n\t\t\tconst { colspan, rowspan, colwidth } = cellNode.attrs;\n\t\t\tfor (let h = 0; h < rowspan; h++) {\n\t\t\t\tif (h + row >= height) {\n\t\t\t\t\t(problems || (problems = [])).push({\n\t\t\t\t\t\ttype: \"overlong_rowspan\",\n\t\t\t\t\t\tpos,\n\t\t\t\t\t\tn: rowspan - h\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconst start = mapPos + h * width;\n\t\t\t\tfor (let w = 0; w < colspan; w++) {\n\t\t\t\t\tif (map[start + w] == 0) map[start + w] = pos;\n\t\t\t\t\telse (problems || (problems = [])).push({\n\t\t\t\t\t\ttype: \"collision\",\n\t\t\t\t\t\trow,\n\t\t\t\t\t\tpos,\n\t\t\t\t\t\tn: colspan - w\n\t\t\t\t\t});\n\t\t\t\t\tconst colW = colwidth && colwidth[w];\n\t\t\t\t\tif (colW) {\n\t\t\t\t\t\tconst widthIndex = (start + w) % width * 2, prev = colWidths[widthIndex];\n\t\t\t\t\t\tif (prev == null || prev != colW && colWidths[widthIndex + 1] == 1) {\n\t\t\t\t\t\t\tcolWidths[widthIndex] = colW;\n\t\t\t\t\t\t\tcolWidths[widthIndex + 1] = 1;\n\t\t\t\t\t\t} else if (prev == colW) colWidths[widthIndex + 1]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tmapPos += colspan;\n\t\t\tpos += cellNode.nodeSize;\n\t\t}\n\t\tconst expectedPos = (row + 1) * width;\n\t\tlet missing = 0;\n\t\twhile (mapPos < expectedPos) if (map[mapPos++] == 0) missing++;\n\t\tif (missing) (problems || (problems = [])).push({\n\t\t\ttype: \"missing\",\n\t\t\trow,\n\t\t\tn: missing\n\t\t});\n\t\tpos++;\n\t}\n\tif (width === 0 || height === 0) (problems || (problems = [])).push({ type: \"zero_sized\" });\n\tconst tableMap = new TableMap(width, height, map, problems);\n\tlet badWidths = false;\n\tfor (let i = 0; !badWidths && i < colWidths.length; i += 2) if (colWidths[i] != null && colWidths[i + 1] < height) badWidths = true;\n\tif (badWidths) findBadColWidths(tableMap, colWidths, table);\n\treturn tableMap;\n}\nfunction findWidth(table) {\n\tlet width = -1;\n\tlet hasRowSpan = false;\n\tfor (let row = 0; row < table.childCount; row++) {\n\t\tconst rowNode = table.child(row);\n\t\tlet rowWidth = 0;\n\t\tif (hasRowSpan) for (let j = 0; j < row; j++) {\n\t\t\tconst prevRow = table.child(j);\n\t\t\tfor (let i = 0; i < prevRow.childCount; i++) {\n\t\t\t\tconst cell = prevRow.child(i);\n\t\t\t\tif (j + cell.attrs.rowspan > row) rowWidth += cell.attrs.colspan;\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < rowNode.childCount; i++) {\n\t\t\tconst cell = rowNode.child(i);\n\t\t\trowWidth += cell.attrs.colspan;\n\t\t\tif (cell.attrs.rowspan > 1) hasRowSpan = true;\n\t\t}\n\t\tif (width == -1) width = rowWidth;\n\t\telse if (width != rowWidth) width = Math.max(width, rowWidth);\n\t}\n\treturn width;\n}\nfunction findBadColWidths(map, colWidths, table) {\n\tif (!map.problems) map.problems = [];\n\tconst seen = {};\n\tfor (let i = 0; i < map.map.length; i++) {\n\t\tconst pos = map.map[i];\n\t\tif (seen[pos]) continue;\n\t\tseen[pos] = true;\n\t\tconst node = table.nodeAt(pos);\n\t\tif (!node) throw new RangeError(`No cell with offset ${pos} found`);\n\t\tlet updated = null;\n\t\tconst attrs = node.attrs;\n\t\tfor (let j = 0; j < attrs.colspan; j++) {\n\t\t\tconst colWidth = colWidths[(i + j) % map.width * 2];\n\t\t\tif (colWidth != null && (!attrs.colwidth || attrs.colwidth[j] != colWidth)) (updated || (updated = freshColWidth(attrs)))[j] = colWidth;\n\t\t}\n\t\tif (updated) map.problems.unshift({\n\t\t\ttype: \"colwidth mismatch\",\n\t\t\tpos,\n\t\t\tcolwidth: updated\n\t\t});\n\t}\n}\nfunction freshColWidth(attrs) {\n\tif (attrs.colwidth) return attrs.colwidth.slice();\n\tconst result = [];\n\tfor (let i = 0; i < attrs.colspan; i++) result.push(0);\n\treturn result;\n}\n\n//#endregion\n//#region src/schema.ts\nfunction getCellAttrs(dom, extraAttrs) {\n\tif (typeof dom === \"string\") return {};\n\tconst widthAttr = dom.getAttribute(\"data-colwidth\");\n\tconst widths = widthAttr && /^\\d+(,\\d+)*$/.test(widthAttr) ? widthAttr.split(\",\").map((s) => Number(s)) : null;\n\tconst colspan = Number(dom.getAttribute(\"colspan\") || 1);\n\tconst result = {\n\t\tcolspan,\n\t\trowspan: Number(dom.getAttribute(\"rowspan\") || 1),\n\t\tcolwidth: widths && widths.length == colspan ? widths : null\n\t};\n\tfor (const prop in extraAttrs) {\n\t\tconst getter = extraAttrs[prop].getFromDOM;\n\t\tconst value = getter && getter(dom);\n\t\tif (value != null) result[prop] = value;\n\t}\n\treturn result;\n}\nfunction setCellAttrs(node, extraAttrs) {\n\tconst attrs = {};\n\tif (node.attrs.colspan != 1) attrs.colspan = node.attrs.colspan;\n\tif (node.attrs.rowspan != 1) attrs.rowspan = node.attrs.rowspan;\n\tif (node.attrs.colwidth) attrs[\"data-colwidth\"] = node.attrs.colwidth.join(\",\");\n\tfor (const prop in extraAttrs) {\n\t\tconst setter = extraAttrs[prop].setDOMAttr;\n\t\tif (setter) setter(node.attrs[prop], attrs);\n\t}\n\treturn attrs;\n}\nfunction validateColwidth(value) {\n\tif (value === null) return;\n\tif (!Array.isArray(value)) throw new TypeError(\"colwidth must be null or an array\");\n\tfor (const item of value) if (typeof item !== \"number\") throw new TypeError(\"colwidth must be null or an array of numbers\");\n}\n/**\n* This function creates a set of [node\n* specs](http://prosemirror.net/docs/ref/#model.SchemaSpec.nodes) for\n* `table`, `table_row`, and `table_cell` nodes types as used by this\n* module. The result can then be added to the set of nodes when\n* creating a schema.\n*\n* @public\n*/\nfunction tableNodes(options) {\n\tconst extraAttrs = options.cellAttributes || {};\n\tconst cellAttrs = {\n\t\tcolspan: {\n\t\t\tdefault: 1,\n\t\t\tvalidate: \"number\"\n\t\t},\n\t\trowspan: {\n\t\t\tdefault: 1,\n\t\t\tvalidate: \"number\"\n\t\t},\n\t\tcolwidth: {\n\t\t\tdefault: null,\n\t\t\tvalidate: validateColwidth\n\t\t}\n\t};\n\tfor (const prop in extraAttrs) cellAttrs[prop] = {\n\t\tdefault: extraAttrs[prop].default,\n\t\tvalidate: extraAttrs[prop].validate\n\t};\n\treturn {\n\t\ttable: {\n\t\t\tcontent: \"table_row+\",\n\t\t\ttableRole: \"table\",\n\t\t\tisolating: true,\n\t\t\tgroup: options.tableGroup,\n\t\t\tparseDOM: [{ tag: \"table\" }],\n\t\t\ttoDOM() {\n\t\t\t\treturn [\"table\", [\"tbody\", 0]];\n\t\t\t}\n\t\t},\n\t\ttable_row: {\n\t\t\tcontent: \"(table_cell | table_header)*\",\n\t\t\ttableRole: \"row\",\n\t\t\tparseDOM: [{ tag: \"tr\" }],\n\t\t\ttoDOM() {\n\t\t\t\treturn [\"tr\", 0];\n\t\t\t}\n\t\t},\n\t\ttable_cell: {\n\t\t\tcontent: options.cellContent,\n\t\t\tattrs: cellAttrs,\n\t\t\ttableRole: \"cell\",\n\t\t\tisolating: true,\n\t\t\tparseDOM: [{\n\t\t\t\ttag: \"td\",\n\t\t\t\tgetAttrs: (dom) => getCellAttrs(dom, extraAttrs)\n\t\t\t}],\n\t\t\ttoDOM(node) {\n\t\t\t\treturn [\n\t\t\t\t\t\"td\",\n\t\t\t\t\tsetCellAttrs(node, extraAttrs),\n\t\t\t\t\t0\n\t\t\t\t];\n\t\t\t}\n\t\t},\n\t\ttable_header: {\n\t\t\tcontent: options.cellContent,\n\t\t\tattrs: cellAttrs,\n\t\t\ttableRole: \"header_cell\",\n\t\t\tisolating: true,\n\t\t\tparseDOM: [{\n\t\t\t\ttag: \"th\",\n\t\t\t\tgetAttrs: (dom) => getCellAttrs(dom, extraAttrs)\n\t\t\t}],\n\t\t\ttoDOM(node) {\n\t\t\t\treturn [\n\t\t\t\t\t\"th\",\n\t\t\t\t\tsetCellAttrs(node, extraAttrs),\n\t\t\t\t\t0\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n* @public\n*/\nfunction tableNodeTypes(schema) {\n\tlet result = schema.cached.tableNodeTypes;\n\tif (!result) {\n\t\tresult = schema.cached.tableNodeTypes = {};\n\t\tfor (const name in schema.nodes) {\n\t\t\tconst type = schema.nodes[name], role = type.spec.tableRole;\n\t\t\tif (role) result[role] = type;\n\t\t}\n\t}\n\treturn result;\n}\n\n//#endregion\n//#region src/util.ts\n/**\n* @public\n*/\nconst tableEditingKey = new PluginKey(\"selectingCells\");\n/**\n* @public\n*/\nfunction cellAround($pos) {\n\tfor (let d = $pos.depth - 1; d > 0; d--) if ($pos.node(d).type.spec.tableRole == \"row\") return $pos.node(0).resolve($pos.before(d + 1));\n\treturn null;\n}\nfunction cellWrapping($pos) {\n\tfor (let d = $pos.depth; d > 0; d--) {\n\t\tconst role = $pos.node(d).type.spec.tableRole;\n\t\tif (role === \"cell\" || role === \"header_cell\") return $pos.node(d);\n\t}\n\treturn null;\n}\n/**\n* @public\n*/\nfunction isInTable(state) {\n\tconst $head = state.selection.$head;\n\tfor (let d = $head.depth; d > 0; d--) if ($head.node(d).type.spec.tableRole == \"row\") return true;\n\treturn false;\n}\n/**\n* @internal\n*/\nfunction selectionCell(state) {\n\tconst sel = state.selection;\n\tif (\"$anchorCell\" in sel && sel.$anchorCell) return sel.$anchorCell.pos > sel.$headCell.pos ? sel.$anchorCell : sel.$headCell;\n\telse if (\"node\" in sel && sel.node && sel.node.type.spec.tableRole == \"cell\") return sel.$anchor;\n\tconst $cell = cellAround(sel.$head) || cellNear(sel.$head);\n\tif ($cell) return $cell;\n\tthrow new RangeError(`No cell found around position ${sel.head}`);\n}\n/**\n* @public\n*/\nfunction cellNear($pos) {\n\tfor (let after = $pos.nodeAfter, pos = $pos.pos; after; after = after.firstChild, pos++) {\n\t\tconst role = after.type.spec.tableRole;\n\t\tif (role == \"cell\" || role == \"header_cell\") return $pos.doc.resolve(pos);\n\t}\n\tfor (let before = $pos.nodeBefore, pos = $pos.pos; before; before = before.lastChild, pos--) {\n\t\tconst role = before.type.spec.tableRole;\n\t\tif (role == \"cell\" || role == \"header_cell\") return $pos.doc.resolve(pos - before.nodeSize);\n\t}\n}\n/**\n* @public\n*/\nfunction pointsAtCell($pos) {\n\treturn $pos.parent.type.spec.tableRole == \"row\" && !!$pos.nodeAfter;\n}\n/**\n* @public\n*/\nfunction moveCellForward($pos) {\n\treturn $pos.node(0).resolve($pos.pos + $pos.nodeAfter.nodeSize);\n}\n/**\n* @internal\n*/\nfunction inSameTable($cellA, $cellB) {\n\treturn $cellA.depth == $cellB.depth && $cellA.pos >= $cellB.start(-1) && $cellA.pos <= $cellB.end(-1);\n}\n/**\n* @public\n*/\nfunction findCell($pos) {\n\treturn TableMap.get($pos.node(-1)).findCell($pos.pos - $pos.start(-1));\n}\n/**\n* @public\n*/\nfunction colCount($pos) {\n\treturn TableMap.get($pos.node(-1)).colCount($pos.pos - $pos.start(-1));\n}\n/**\n* @public\n*/\nfunction nextCell($pos, axis, dir) {\n\tconst table = $pos.node(-1);\n\tconst map = TableMap.get(table);\n\tconst tableStart = $pos.start(-1);\n\tconst moved = map.nextCell($pos.pos - tableStart, axis, dir);\n\treturn moved == null ? null : $pos.node(0).resolve(tableStart + moved);\n}\n/**\n* @public\n*/\nfunction removeColSpan(attrs, pos, n = 1) {\n\tconst result = {\n\t\t...attrs,\n\t\tcolspan: attrs.colspan - n\n\t};\n\tif (result.colwidth) {\n\t\tresult.colwidth = result.colwidth.slice();\n\t\tresult.colwidth.splice(pos, n);\n\t\tif (!result.colwidth.some((w) => w > 0)) result.colwidth = null;\n\t}\n\treturn result;\n}\n/**\n* @public\n*/\nfunction addColSpan(attrs, pos, n = 1) {\n\tconst result = {\n\t\t...attrs,\n\t\tcolspan: attrs.colspan + n\n\t};\n\tif (result.colwidth) {\n\t\tresult.colwidth = result.colwidth.slice();\n\t\tfor (let i = 0; i < n; i++) result.colwidth.splice(pos, 0, 0);\n\t}\n\treturn result;\n}\n/**\n* @public\n*/\nfunction columnIsHeader(map, table, col) {\n\tconst headerCell = tableNodeTypes(table.type.schema).header_cell;\n\tfor (let row = 0; row < map.height; row++) if (table.nodeAt(map.map[col + row * map.width]).type != headerCell) return false;\n\treturn true;\n}\n\n//#endregion\n//#region src/cellselection.ts\n/**\n* A [`Selection`](http://prosemirror.net/docs/ref/#state.Selection)\n* subclass that represents a cell selection spanning part of a table.\n* With the plugin enabled, these will be created when the user\n* selects across cells, and will be drawn by giving selected cells a\n* `selectedCell` CSS class.\n*\n* @public\n*/\nvar CellSelection = class CellSelection extends Selection {\n\tconstructor($anchorCell, $headCell = $anchorCell) {\n\t\tconst table = $anchorCell.node(-1);\n\t\tconst map = TableMap.get(table);\n\t\tconst tableStart = $anchorCell.start(-1);\n\t\tconst rect = map.rectBetween($anchorCell.pos - tableStart, $headCell.pos - tableStart);\n\t\tconst doc = $anchorCell.node(0);\n\t\tconst cells = map.cellsInRect(rect).filter((p) => p != $headCell.pos - tableStart);\n\t\tcells.unshift($headCell.pos - tableStart);\n\t\tconst ranges = cells.map((pos) => {\n\t\t\tconst cell = table.nodeAt(pos);\n\t\t\tif (!cell) throw new RangeError(`No cell with offset ${pos} found`);\n\t\t\tconst from = tableStart + pos + 1;\n\t\t\treturn new SelectionRange(doc.resolve(from), doc.resolve(from + cell.content.size));\n\t\t});\n\t\tsuper(ranges[0].$from, ranges[0].$to, ranges);\n\t\tthis.$anchorCell = $anchorCell;\n\t\tthis.$headCell = $headCell;\n\t}\n\tmap(doc, mapping) {\n\t\tconst $anchorCell = doc.resolve(mapping.map(this.$anchorCell.pos));\n\t\tconst $headCell = doc.resolve(mapping.map(this.$headCell.pos));\n\t\tif (pointsAtCell($anchorCell) && pointsAtCell($headCell) && inSameTable($anchorCell, $headCell)) {\n\t\t\tconst tableChanged = this.$anchorCell.node(-1) != $anchorCell.node(-1);\n\t\t\tif (tableChanged && this.isRowSelection()) return CellSelection.rowSelection($anchorCell, $headCell);\n\t\t\telse if (tableChanged && this.isColSelection()) return CellSelection.colSelection($anchorCell, $headCell);\n\t\t\telse return new CellSelection($anchorCell, $headCell);\n\t\t}\n\t\treturn TextSelection.between($anchorCell, $headCell);\n\t}\n\tcontent() {\n\t\tconst table = this.$anchorCell.node(-1);\n\t\tconst map = TableMap.get(table);\n\t\tconst tableStart = this.$anchorCell.start(-1);\n\t\tconst rect = map.rectBetween(this.$anchorCell.pos - tableStart, this.$headCell.pos - tableStart);\n\t\tconst seen = {};\n\t\tconst rows = [];\n\t\tfor (let row = rect.top; row < rect.bottom; row++) {\n\t\t\tconst rowContent = [];\n\t\t\tfor (let index = row * map.width + rect.left, col = rect.left; col < rect.right; col++, index++) {\n\t\t\t\tconst pos = map.map[index];\n\t\t\t\tif (seen[pos]) continue;\n\t\t\t\tseen[pos] = true;\n\t\t\t\tconst cellRect = map.findCell(pos);\n\t\t\t\tlet cell = table.nodeAt(pos);\n\t\t\t\tif (!cell) throw new RangeError(`No cell with offset ${pos} found`);\n\t\t\t\tconst extraLeft = rect.left - cellRect.left;\n\t\t\t\tconst extraRight = cellRect.right - rect.right;\n\t\t\t\tif (extraLeft > 0 || extraRight > 0) {\n\t\t\t\t\tlet attrs = cell.attrs;\n\t\t\t\t\tif (extraLeft > 0) attrs = removeColSpan(attrs, 0, extraLeft);\n\t\t\t\t\tif (extraRight > 0) attrs = removeColSpan(attrs, attrs.colspan - extraRight, extraRight);\n\t\t\t\t\tif (cellRect.left < rect.left) {\n\t\t\t\t\t\tcell = cell.type.createAndFill(attrs);\n\t\t\t\t\t\tif (!cell) throw new RangeError(`Could not create cell with attrs ${JSON.stringify(attrs)}`);\n\t\t\t\t\t} else cell = cell.type.create(attrs, cell.content);\n\t\t\t\t}\n\t\t\t\tif (cellRect.top < rect.top || cellRect.bottom > rect.bottom) {\n\t\t\t\t\tconst attrs = {\n\t\t\t\t\t\t...cell.attrs,\n\t\t\t\t\t\trowspan: Math.min(cellRect.bottom, rect.bottom) - Math.max(cellRect.top, rect.top)\n\t\t\t\t\t};\n\t\t\t\t\tif (cellRect.top < rect.top) cell = cell.type.createAndFill(attrs);\n\t\t\t\t\telse cell = cell.type.create(attrs, cell.content);\n\t\t\t\t}\n\t\t\t\trowContent.push(cell);\n\t\t\t}\n\t\t\trows.push(table.child(row).copy(Fragment.from(rowContent)));\n\t\t}\n\t\tconst fragment = this.isColSelection() && this.isRowSelection() ? table : rows;\n\t\treturn new Slice(Fragment.from(fragment), 1, 1);\n\t}\n\treplace(tr, content = Slice.empty) {\n\t\tconst mapFrom = tr.steps.length, ranges = this.ranges;\n\t\tfor (let i = 0; i < ranges.length; i++) {\n\t\t\tconst { $from, $to } = ranges[i], mapping = tr.mapping.slice(mapFrom);\n\t\t\ttr.replace(mapping.map($from.pos), mapping.map($to.pos), i ? Slice.empty : content);\n\t\t}\n\t\tconst sel = Selection.findFrom(tr.doc.resolve(tr.mapping.slice(mapFrom).map(this.to)), -1);\n\t\tif (sel) tr.setSelection(sel);\n\t}\n\treplaceWith(tr, node) {\n\t\tthis.replace(tr, new Slice(Fragment.from(node), 0, 0));\n\t}\n\tforEachCell(f) {\n\t\tconst table = this.$anchorCell.node(-1);\n\t\tconst map = TableMap.get(table);\n\t\tconst tableStart = this.$anchorCell.start(-1);\n\t\tconst cells = map.cellsInRect(map.rectBetween(this.$anchorCell.pos - tableStart, this.$headCell.pos - tableStart));\n\t\tfor (let i = 0; i < cells.length; i++) f(table.nodeAt(cells[i]), tableStart + cells[i]);\n\t}\n\tisColSelection() {\n\t\tconst anchorTop = this.$anchorCell.index(-1);\n\t\tconst headTop = this.$headCell.index(-1);\n\t\tif (Math.min(anchorTop, headTop) > 0) return false;\n\t\tconst anchorBottom = anchorTop + this.$anchorCell.nodeAfter.attrs.rowspan;\n\t\tconst headBottom = headTop + this.$headCell.nodeAfter.attrs.rowspan;\n\t\treturn Math.max(anchorBottom, headBottom) == this.$headCell.node(-1).childCount;\n\t}\n\tstatic colSelection($anchorCell, $headCell = $anchorCell) {\n\t\tconst table = $anchorCell.node(-1);\n\t\tconst map = TableMap.get(table);\n\t\tconst tableStart = $anchorCell.start(-1);\n\t\tconst anchorRect = map.findCell($anchorCell.pos - tableStart);\n\t\tconst headRect = map.findCell($headCell.pos - tableStart);\n\t\tconst doc = $anchorCell.node(0);\n\t\tif (anchorRect.top <= headRect.top) {\n\t\t\tif (anchorRect.top > 0) $anchorCell = doc.resolve(tableStart + map.map[anchorRect.left]);\n\t\t\tif (headRect.bottom < map.height) $headCell = doc.resolve(tableStart + map.map[map.width * (map.height - 1) + headRect.right - 1]);\n\t\t} else {\n\t\t\tif (headRect.top > 0) $headCell = doc.resolve(tableStart + map.map[headRect.left]);\n\t\t\tif (anchorRect.bottom < map.height) $anchorCell = doc.resolve(tableStart + map.map[map.width * (map.height - 1) + anchorRect.right - 1]);\n\t\t}\n\t\treturn new CellSelection($anchorCell, $headCell);\n\t}\n\tisRowSelection() {\n\t\tconst table = this.$anchorCell.node(-1);\n\t\tconst map = TableMap.get(table);\n\t\tconst tableStart = this.$anchorCell.start(-1);\n\t\tconst anchorLeft = map.colCount(this.$anchorCell.pos - tableStart);\n\t\tconst headLeft = map.colCount(this.$headCell.pos - tableStart);\n\t\tif (Math.min(anchorLeft, headLeft) > 0) return false;\n\t\tconst anchorRight = anchorLeft + this.$anchorCell.nodeAfter.attrs.colspan;\n\t\tconst headRight = headLeft + this.$headCell.nodeAfter.attrs.colspan;\n\t\treturn Math.max(anchorRight, headRight) == map.width;\n\t}\n\teq(other) {\n\t\treturn other instanceof CellSelection && other.$anchorCell.pos == this.$anchorCell.pos && other.$headCell.pos == this.$headCell.pos;\n\t}\n\tstatic rowSelection($anchorCell, $headCell = $anchorCell) {\n\t\tconst table = $anchorCell.node(-1);\n\t\tconst map = TableMap.get(table);\n\t\tconst tableStart = $anchorCell.start(-1);\n\t\tconst anchorRect = map.findCell($anchorCell.pos - tableStart);\n\t\tconst headRect = map.findCell($headCell.pos - tableStart);\n\t\tconst doc = $anchorCell.node(0);\n\t\tif (anchorRect.left <= headRect.left) {\n\t\t\tif (anchorRect.left > 0) $anchorCell = doc.resolve(tableStart + map.map[anchorRect.top * map.width]);\n\t\t\tif (headRect.right < map.width) $headCell = doc.resolve(tableStart + map.map[map.width * (headRect.top + 1) - 1]);\n\t\t} else {\n\t\t\tif (headRect.left > 0) $headCell = doc.resolve(tableStart + map.map[headRect.top * map.width]);\n\t\t\tif (anchorRect.right < map.width) $anchorCell = doc.resolve(tableStart + map.map[map.width * (anchorRect.top + 1) - 1]);\n\t\t}\n\t\treturn new CellSelection($anchorCell, $headCell);\n\t}\n\ttoJSON() {\n\t\treturn {\n\t\t\ttype: \"cell\",\n\t\t\tanchor: this.$anchorCell.pos,\n\t\t\thead: this.$headCell.pos\n\t\t};\n\t}\n\tstatic fromJSON(doc, json) {\n\t\treturn new CellSelection(doc.resolve(json.anchor), doc.resolve(json.head));\n\t}\n\tstatic create(doc, anchorCell, headCell = anchorCell) {\n\t\treturn new CellSelection(doc.resolve(anchorCell), doc.resolve(headCell));\n\t}\n\tgetBookmark() {\n\t\treturn new CellBookmark(this.$anchorCell.pos, this.$headCell.pos);\n\t}\n};\nCellSelection.prototype.visible = false;\nSelection.jsonID(\"cell\", CellSelection);\n/**\n* @public\n*/\nvar CellBookmark = class CellBookmark {\n\tconstructor(anchor, head) {\n\t\tthis.anchor = anchor;\n\t\tthis.head = head;\n\t}\n\tmap(mapping) {\n\t\treturn new CellBookmark(mapping.map(this.anchor), mapping.map(this.head));\n\t}\n\tresolve(doc) {\n\t\tconst $anchorCell = doc.resolve(this.anchor), $headCell = doc.resolve(this.head);\n\t\tif ($anchorCell.parent.type.spec.tableRole == \"row\" && $headCell.parent.type.spec.tableRole == \"row\" && $anchorCell.index() < $anchorCell.parent.childCount && $headCell.index() < $headCell.parent.childCount && inSameTable($anchorCell, $headCell)) return new CellSelection($anchorCell, $headCell);\n\t\telse return Selection.near($headCell, 1);\n\t}\n};\nfunction drawCellSelection(state) {\n\tif (!(state.selection instanceof CellSelection)) return null;\n\tconst cells = [];\n\tstate.selection.forEachCell((node, pos) => {\n\t\tcells.push(Decoration.node(pos, pos + node.nodeSize, { class: \"selectedCell\" }));\n\t});\n\treturn DecorationSet.create(state.doc, cells);\n}\nfunction isCellBoundarySelection({ $from, $to }) {\n\tif ($from.pos == $to.pos || $from.pos < $to.pos - 6) return false;\n\tlet afterFrom = $from.pos;\n\tlet beforeTo = $to.pos;\n\tlet depth = $from.depth;\n\tfor (; depth >= 0; depth--, afterFrom++) if ($from.after(depth + 1) < $from.end(depth)) break;\n\tfor (let d = $to.depth; d >= 0; d--, beforeTo--) if ($to.before(d + 1) > $to.start(d)) break;\n\treturn afterFrom == beforeTo && /row|table/.test($from.node(depth).type.spec.tableRole);\n}\nfunction isTextSelectionAcrossCells({ $from, $to }) {\n\tlet fromCellBoundaryNode;\n\tlet toCellBoundaryNode;\n\tfor (let i = $from.depth; i > 0; i--) {\n\t\tconst node = $from.node(i);\n\t\tif (node.type.spec.tableRole === \"cell\" || node.type.spec.tableRole === \"header_cell\") {\n\t\t\tfromCellBoundaryNode = node;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor (let i = $to.depth; i > 0; i--) {\n\t\tconst node = $to.node(i);\n\t\tif (node.type.spec.tableRole === \"cell\" || node.type.spec.tableRole === \"header_cell\") {\n\t\t\ttoCellBoundaryNode = node;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn fromCellBoundaryNode !== toCellBoundaryNode && $to.parentOffset === 0;\n}\nfunction normalizeSelection(state, tr, allowTableNodeSelection) {\n\tconst sel = (tr || state).selection;\n\tconst doc = (tr || state).doc;\n\tlet normalize;\n\tlet role;\n\tif (sel instanceof NodeSelection && (role = sel.node.type.spec.tableRole)) {\n\t\tif (role == \"cell\" || role == \"header_cell\") normalize = CellSelection.create(doc, sel.from);\n\t\telse if (role == \"row\") {\n\t\t\tconst $cell = doc.resolve(sel.from + 1);\n\t\t\tnormalize = CellSelection.rowSelection($cell, $cell);\n\t\t} else if (!allowTableNodeSelection) {\n\t\t\tconst map = TableMap.get(sel.node);\n\t\t\tconst start = sel.from + 1;\n\t\t\tconst lastCell = start + map.map[map.width * map.height - 1];\n\t\t\tnormalize = CellSelection.create(doc, start + 1, lastCell);\n\t\t}\n\t} else if (sel instanceof TextSelection && isCellBoundarySelection(sel)) normalize = TextSelection.create(doc, sel.from);\n\telse if (sel instanceof TextSelection && isTextSelectionAcrossCells(sel)) normalize = TextSelection.create(doc, sel.$from.start(), sel.$from.end());\n\tif (normalize) (tr || (tr = state.tr)).setSelection(normalize);\n\treturn tr;\n}\n\n//#endregion\n//#region src/fixtables.ts\n/**\n* @public\n*/\nconst fixTablesKey = new PluginKey(\"fix-tables\");\n/**\n* Helper for iterating through the nodes in a document that changed\n* compared to the given previous document. Useful for avoiding\n* duplicate work on each transaction.\n*\n* @public\n*/\nfunction changedDescendants(old, cur, offset, f) {\n\tconst oldSize = old.childCount, curSize = cur.childCount;\n\touter: for (let i = 0, j = 0; i < curSize; i++) {\n\t\tconst child = cur.child(i);\n\t\tfor (let scan = j, e = Math.min(oldSize, i + 3); scan < e; scan++) if (old.child(scan) == child) {\n\t\t\tj = scan + 1;\n\t\t\toffset += child.nodeSize;\n\t\t\tcontinue outer;\n\t\t}\n\t\tf(child, offset);\n\t\tif (j < oldSize && old.child(j).sameMarkup(child)) changedDescendants(old.child(j), child, offset + 1, f);\n\t\telse child.nodesBetween(0, child.content.size, f, offset + 1);\n\t\toffset += child.nodeSize;\n\t}\n}\n/**\n* Inspect all tables in the given state's document and return a\n* transaction that fixes them, if necessary. If `oldState` was\n* provided, that is assumed to hold a previous, known-good state,\n* which will be used to avoid re-scanning unchanged parts of the\n* document.\n*\n* @public\n*/\nfunction fixTables(state, oldState) {\n\tlet tr;\n\tconst check = (node, pos) => {\n\t\tif (node.type.spec.tableRole == \"table\") tr = fixTable(state, node, pos, tr);\n\t};\n\tif (!oldState) state.doc.descendants(check);\n\telse if (oldState.doc != state.doc) changedDescendants(oldState.doc, state.doc, 0, check);\n\treturn tr;\n}\nfunction fixTable(state, table, tablePos, tr) {\n\tconst map = TableMap.get(table);\n\tif (!map.problems) return tr;\n\tif (!tr) tr = state.tr;\n\tconst mustAdd = [];\n\tfor (let i = 0; i < map.height; i++) mustAdd.push(0);\n\tfor (let i = 0; i < map.problems.length; i++) {\n\t\tconst prob = map.problems[i];\n\t\tif (prob.type == \"collision\") {\n\t\t\tconst cell = table.nodeAt(prob.pos);\n\t\t\tif (!cell) continue;\n\t\t\tconst attrs = cell.attrs;\n\t\t\tfor (let j = 0; j < attrs.rowspan; j++) mustAdd[prob.row + j] += prob.n;\n\t\t\ttr.setNodeMarkup(tr.mapping.map(tablePos + 1 + prob.pos), null, removeColSpan(attrs, attrs.colspan - prob.n, prob.n));\n\t\t} else if (prob.type == \"missing\") mustAdd[prob.row] += prob.n;\n\t\telse if (prob.type == \"overlong_rowspan\") {\n\t\t\tconst cell = table.nodeAt(prob.pos);\n\t\t\tif (!cell) continue;\n\t\t\ttr.setNodeMarkup(tr.mapping.map(tablePos + 1 + prob.pos), null, {\n\t\t\t\t...cell.attrs,\n\t\t\t\trowspan: cell.attrs.rowspan - prob.n\n\t\t\t});\n\t\t} else if (prob.type == \"colwidth mismatch\") {\n\t\t\tconst cell = table.nodeAt(prob.pos);\n\t\t\tif (!cell) continue;\n\t\t\ttr.setNodeMarkup(tr.mapping.map(tablePos + 1 + prob.pos), null, {\n\t\t\t\t...cell.attrs,\n\t\t\t\tcolwidth: prob.colwidth\n\t\t\t});\n\t\t} else if (prob.type == \"zero_sized\") {\n\t\t\tconst pos = tr.mapping.map(tablePos);\n\t\t\ttr.delete(pos, pos + table.nodeSize);\n\t\t}\n\t}\n\tlet first, last;\n\tfor (let i = 0; i < mustAdd.length; i++) if (mustAdd[i]) {\n\t\tif (first == null) first = i;\n\t\tlast = i;\n\t}\n\tfor (let i = 0, pos = tablePos + 1; i < map.height; i++) {\n\t\tconst row = table.child(i);\n\t\tconst end = pos + row.nodeSize;\n\t\tconst add = mustAdd[i];\n\t\tif (add > 0) {\n\t\t\tlet role = \"cell\";\n\t\t\tif (row.firstChild) role = row.firstChild.type.spec.tableRole;\n\t\t\tconst nodes = [];\n\t\t\tfor (let j = 0; j < add; j++) {\n\t\t\t\tconst node = tableNodeTypes(state.schema)[role].createAndFill();\n\t\t\t\tif (node) nodes.push(node);\n\t\t\t}\n\t\t\tconst side = (i == 0 || first == i - 1) && last == i ? pos + 1 : end - 1;\n\t\t\ttr.insert(tr.mapping.map(side), nodes);\n\t\t}\n\t\tpos = end;\n\t}\n\treturn tr.setMeta(fixTablesKey, { fixTables: true });\n}\n\n//#endregion\n//#region src/utils/convert.ts\n/**\n* This function will transform the table node into a matrix of rows and columns\n* respecting merged cells, for example this table:\n*\n* ```\n* ┌──────┬──────┬─────────────┐\n* │  A1  │  B1  │     C1      │\n* ├──────┼──────┴──────┬──────┤\n* │  A2  │     B2      │      │\n* ├──────┼─────────────┤  D1  │\n* │  A3  │  B3  │  C3  │      │\n* └──────┴──────┴──────┴──────┘\n* ```\n*\n* will be converted to the below:\n*\n* ```javascript\n* [\n*   [A1, B1, C1, null],\n*   [A2, B2, null, D1],\n*   [A3, B3, C3, null],\n* ]\n* ```\n* @internal\n*/\nfunction convertTableNodeToArrayOfRows(tableNode) {\n\tconst map = TableMap.get(tableNode);\n\tconst rows = [];\n\tconst rowCount = map.height;\n\tconst colCount$1 = map.width;\n\tfor (let rowIndex = 0; rowIndex < rowCount; rowIndex++) {\n\t\tconst row = [];\n\t\tfor (let colIndex = 0; colIndex < colCount$1; colIndex++) {\n\t\t\tconst cellIndex = rowIndex * colCount$1 + colIndex;\n\t\t\tconst cellPos = map.map[cellIndex];\n\t\t\tif (rowIndex > 0) {\n\t\t\t\tconst topCellIndex = cellIndex - colCount$1;\n\t\t\t\tif (cellPos === map.map[topCellIndex]) {\n\t\t\t\t\trow.push(null);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (colIndex > 0) {\n\t\t\t\tconst leftCellIndex = cellIndex - 1;\n\t\t\t\tif (cellPos === map.map[leftCellIndex]) {\n\t\t\t\t\trow.push(null);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.push(tableNode.nodeAt(cellPos));\n\t\t}\n\t\trows.push(row);\n\t}\n\treturn rows;\n}\n/**\n* Convert an array of rows to a table node.\n*\n* @internal\n*/\nfunction convertArrayOfRowsToTableNode(tableNode, arrayOfNodes) {\n\tconst newRows = [];\n\tconst map = TableMap.get(tableNode);\n\tconst rowCount = map.height;\n\tconst colCount$1 = map.width;\n\tfor (let rowIndex = 0; rowIndex < rowCount; rowIndex++) {\n\t\tconst oldRow = tableNode.child(rowIndex);\n\t\tconst newCells = [];\n\t\tfor (let colIndex = 0; colIndex < colCount$1; colIndex++) {\n\t\t\tconst cell = arrayOfNodes[rowIndex][colIndex];\n\t\t\tif (!cell) continue;\n\t\t\tconst cellPos = map.map[rowIndex * map.width + colIndex];\n\t\t\tconst oldCell = tableNode.nodeAt(cellPos);\n\t\t\tif (!oldCell) continue;\n\t\t\tconst newCell = oldCell.type.createChecked(cell.attrs, cell.content, cell.marks);\n\t\t\tnewCells.push(newCell);\n\t\t}\n\t\tconst newRow = oldRow.type.createChecked(oldRow.attrs, newCells, oldRow.marks);\n\t\tnewRows.push(newRow);\n\t}\n\treturn tableNode.type.createChecked(tableNode.attrs, newRows, tableNode.marks);\n}\n\n//#endregion\n//#region src/utils/move-row-in-array-of-rows.ts\n/**\n* Move a row in an array of rows.\n*\n* @internal\n*/\nfunction moveRowInArrayOfRows(rows, indexesOrigin, indexesTarget, directionOverride) {\n\tconst direction = indexesOrigin[0] > indexesTarget[0] ? -1 : 1;\n\tconst rowsExtracted = rows.splice(indexesOrigin[0], indexesOrigin.length);\n\tconst positionOffset = rowsExtracted.length % 2 === 0 ? 1 : 0;\n\tlet target;\n\tif (directionOverride === -1 && direction === 1) target = indexesTarget[0] - 1;\n\telse if (directionOverride === 1 && direction === -1) target = indexesTarget[indexesTarget.length - 1] - positionOffset + 1;\n\telse target = direction === -1 ? indexesTarget[0] : indexesTarget[indexesTarget.length - 1] - positionOffset;\n\trows.splice(target, 0, ...rowsExtracted);\n\treturn rows;\n}\n\n//#endregion\n//#region src/utils/query.ts\n/**\n* Checks if the given object is a `CellSelection` instance.\n*\n* @internal\n*/\nfunction isCellSelection(value) {\n\treturn value instanceof CellSelection;\n}\n/**\n* Find the closest table node for a given position.\n*\n* @public\n*/\nfunction findTable($pos) {\n\treturn findParentNode((node) => node.type.spec.tableRole === \"table\", $pos);\n}\n/**\n* Try to find the anchor and head cell in the same table by using the given\n* anchor and head as hit points, or fallback to the selection's anchor and\n* head.\n*\n* @public\n*/\nfunction findCellRange(selection, anchorHit, headHit) {\n\tvar _ref, _ref2;\n\tif (anchorHit == null && headHit == null && isCellSelection(selection)) return [selection.$anchorCell, selection.$headCell];\n\tconst anchor = (_ref = anchorHit !== null && anchorHit !== void 0 ? anchorHit : headHit) !== null && _ref !== void 0 ? _ref : selection.anchor;\n\tconst head = (_ref2 = headHit !== null && headHit !== void 0 ? headHit : anchorHit) !== null && _ref2 !== void 0 ? _ref2 : selection.head;\n\tconst doc = selection.$head.doc;\n\tconst $anchorCell = findCellPos(doc, anchor);\n\tconst $headCell = findCellPos(doc, head);\n\tif ($anchorCell && $headCell && inSameTable($anchorCell, $headCell)) return [$anchorCell, $headCell];\n\treturn null;\n}\n/**\n* Try to find a resolved pos of a cell by using the given pos as a hit point.\n*\n* @public\n*/\nfunction findCellPos(doc, pos) {\n\tconst $pos = doc.resolve(pos);\n\treturn cellAround($pos) || cellNear($pos);\n}\n/**\n* Find the closest parent node that satisfies the predicate.\n*\n* @internal\n*/\nfunction findParentNode(predicate, $pos) {\n\tfor (let depth = $pos.depth; depth >= 0; depth -= 1) {\n\t\tconst node = $pos.node(depth);\n\t\tif (predicate(node)) return {\n\t\t\tnode,\n\t\t\tpos: depth === 0 ? 0 : $pos.before(depth),\n\t\t\tstart: $pos.start(depth),\n\t\t\tdepth\n\t\t};\n\t}\n\treturn null;\n}\n\n//#endregion\n//#region src/utils/get-cells.ts\n/**\n* Returns an array of cells in a column at the specified column index.\n*\n* @internal\n*/\nfunction getCellsInColumn(columnIndex, selection) {\n\tconst table = findTable(selection.$from);\n\tif (!table) return;\n\tconst map = TableMap.get(table.node);\n\tif (columnIndex < 0 || columnIndex > map.width - 1) return;\n\treturn map.cellsInRect({\n\t\tleft: columnIndex,\n\t\tright: columnIndex + 1,\n\t\ttop: 0,\n\t\tbottom: map.height\n\t}).map((nodePos) => {\n\t\tconst node = table.node.nodeAt(nodePos);\n\t\tconst pos = nodePos + table.start;\n\t\treturn {\n\t\t\tpos,\n\t\t\tstart: pos + 1,\n\t\t\tnode,\n\t\t\tdepth: table.depth + 2\n\t\t};\n\t});\n}\n/**\n* Returns an array of cells in a row at the specified row index.\n*\n* @internal\n*/\nfunction getCellsInRow(rowIndex, selection) {\n\tconst table = findTable(selection.$from);\n\tif (!table) return;\n\tconst map = TableMap.get(table.node);\n\tif (rowIndex < 0 || rowIndex > map.height - 1) return;\n\treturn map.cellsInRect({\n\t\tleft: 0,\n\t\tright: map.width,\n\t\ttop: rowIndex,\n\t\tbottom: rowIndex + 1\n\t}).map((nodePos) => {\n\t\tconst node = table.node.nodeAt(nodePos);\n\t\tconst pos = nodePos + table.start;\n\t\treturn {\n\t\t\tpos,\n\t\t\tstart: pos + 1,\n\t\t\tnode,\n\t\t\tdepth: table.depth + 2\n\t\t};\n\t});\n}\n\n//#endregion\n//#region src/utils/selection-range.ts\n/**\n* Returns a range of rectangular selection spanning all merged cells around a\n* column at index `columnIndex`.\n*\n* Original implementation from Atlassian (Apache License 2.0)\n*\n* https://bitbucket.org/atlassian/atlassian-frontend-mirror/src/5f91cb871e8248bc3bae5ddc30bb9fd9200fadbb/editor/editor-tables/src/utils/get-selection-range-in-column.ts#editor/editor-tables/src/utils/get-selection-range-in-column.ts\n*\n* @internal\n*/\nfunction getSelectionRangeInColumn(tr, startColIndex, endColIndex = startColIndex) {\n\tlet startIndex = startColIndex;\n\tlet endIndex = endColIndex;\n\tfor (let i = startColIndex; i >= 0; i--) {\n\t\tconst cells = getCellsInColumn(i, tr.selection);\n\t\tif (cells) cells.forEach((cell) => {\n\t\t\tconst maybeEndIndex = cell.node.attrs.colspan + i - 1;\n\t\t\tif (maybeEndIndex >= startIndex) startIndex = i;\n\t\t\tif (maybeEndIndex > endIndex) endIndex = maybeEndIndex;\n\t\t});\n\t}\n\tfor (let i = startColIndex; i <= endIndex; i++) {\n\t\tconst cells = getCellsInColumn(i, tr.selection);\n\t\tif (cells) cells.forEach((cell) => {\n\t\t\tconst maybeEndIndex = cell.node.attrs.colspan + i - 1;\n\t\t\tif (cell.node.attrs.colspan > 1 && maybeEndIndex > endIndex) endIndex = maybeEndIndex;\n\t\t});\n\t}\n\tconst indexes = [];\n\tfor (let i = startIndex; i <= endIndex; i++) {\n\t\tconst maybeCells = getCellsInColumn(i, tr.selection);\n\t\tif (maybeCells && maybeCells.length > 0) indexes.push(i);\n\t}\n\tstartIndex = indexes[0];\n\tendIndex = indexes[indexes.length - 1];\n\tconst firstSelectedColumnCells = getCellsInColumn(startIndex, tr.selection);\n\tconst firstRowCells = getCellsInRow(0, tr.selection);\n\tif (!firstSelectedColumnCells || !firstRowCells) return;\n\tconst $anchor = tr.doc.resolve(firstSelectedColumnCells[firstSelectedColumnCells.length - 1].pos);\n\tlet headCell;\n\tfor (let i = endIndex; i >= startIndex; i--) {\n\t\tconst columnCells = getCellsInColumn(i, tr.selection);\n\t\tif (columnCells && columnCells.length > 0) {\n\t\t\tfor (let j = firstRowCells.length - 1; j >= 0; j--) if (firstRowCells[j].pos === columnCells[0].pos) {\n\t\t\t\theadCell = columnCells[0];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (headCell) break;\n\t\t}\n\t}\n\tif (!headCell) return;\n\treturn {\n\t\t$anchor,\n\t\t$head: tr.doc.resolve(headCell.pos),\n\t\tindexes\n\t};\n}\n/**\n* Returns a range of rectangular selection spanning all merged cells around a\n* row at index `rowIndex`.\n*\n* Original implementation from Atlassian (Apache License 2.0)\n*\n* https://bitbucket.org/atlassian/atlassian-frontend-mirror/src/5f91cb871e8248bc3bae5ddc30bb9fd9200fadbb/editor/editor-tables/src/utils/get-selection-range-in-row.ts#editor/editor-tables/src/utils/get-selection-range-in-row.ts\n*\n* @internal\n*/\nfunction getSelectionRangeInRow(tr, startRowIndex, endRowIndex = startRowIndex) {\n\tlet startIndex = startRowIndex;\n\tlet endIndex = endRowIndex;\n\tfor (let i = startRowIndex; i >= 0; i--) {\n\t\tconst cells = getCellsInRow(i, tr.selection);\n\t\tif (cells) cells.forEach((cell) => {\n\t\t\tconst maybeEndIndex = cell.node.attrs.rowspan + i - 1;\n\t\t\tif (maybeEndIndex >= startIndex) startIndex = i;\n\t\t\tif (maybeEndIndex > endIndex) endIndex = maybeEndIndex;\n\t\t});\n\t}\n\tfor (let i = startRowIndex; i <= endIndex; i++) {\n\t\tconst cells = getCellsInRow(i, tr.selection);\n\t\tif (cells) cells.forEach((cell) => {\n\t\t\tconst maybeEndIndex = cell.node.attrs.rowspan + i - 1;\n\t\t\tif (cell.node.attrs.rowspan > 1 && maybeEndIndex > endIndex) endIndex = maybeEndIndex;\n\t\t});\n\t}\n\tconst indexes = [];\n\tfor (let i = startIndex; i <= endIndex; i++) {\n\t\tconst maybeCells = getCellsInRow(i, tr.selection);\n\t\tif (maybeCells && maybeCells.length > 0) indexes.push(i);\n\t}\n\tstartIndex = indexes[0];\n\tendIndex = indexes[indexes.length - 1];\n\tconst firstSelectedRowCells = getCellsInRow(startIndex, tr.selection);\n\tconst firstColumnCells = getCellsInColumn(0, tr.selection);\n\tif (!firstSelectedRowCells || !firstColumnCells) return;\n\tconst $anchor = tr.doc.resolve(firstSelectedRowCells[firstSelectedRowCells.length - 1].pos);\n\tlet headCell;\n\tfor (let i = endIndex; i >= startIndex; i--) {\n\t\tconst rowCells = getCellsInRow(i, tr.selection);\n\t\tif (rowCells && rowCells.length > 0) {\n\t\t\tfor (let j = firstColumnCells.length - 1; j >= 0; j--) if (firstColumnCells[j].pos === rowCells[0].pos) {\n\t\t\t\theadCell = rowCells[0];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (headCell) break;\n\t\t}\n\t}\n\tif (!headCell) return;\n\treturn {\n\t\t$anchor,\n\t\t$head: tr.doc.resolve(headCell.pos),\n\t\tindexes\n\t};\n}\n\n//#endregion\n//#region src/utils/transpose.ts\n/**\n* Transposes a 2D array by flipping columns to rows.\n*\n* Transposition is a familiar algebra concept where the matrix is flipped\n* along its diagonal. For more details, see:\n* https://en.wikipedia.org/wiki/Transpose\n*\n* @example\n* ```javascript\n* const arr = [\n*   ['a1', 'a2', 'a3'],\n*   ['b1', 'b2', 'b3'],\n*   ['c1', 'c2', 'c3'],\n*   ['d1', 'd2', 'd3'],\n* ];\n*\n* const result = transpose(arr);\n* result === [\n*   ['a1', 'b1', 'c1', 'd1'],\n*   ['a2', 'b2', 'c2', 'd2'],\n*   ['a3', 'b3', 'c3', 'd3'],\n* ]\n* ```\n*/\nfunction transpose(array) {\n\treturn array[0].map((_, i) => {\n\t\treturn array.map((column) => column[i]);\n\t});\n}\n\n//#endregion\n//#region src/utils/move-column.ts\n/**\n* Move a column from index `origin` to index `target`.\n*\n* @internal\n*/\nfunction moveColumn(moveColParams) {\n\tvar _getSelectionRangeInC, _getSelectionRangeInC2;\n\tconst { tr, originIndex, targetIndex, select, pos } = moveColParams;\n\tconst table = findTable(tr.doc.resolve(pos));\n\tif (!table) return false;\n\tconst indexesOriginColumn = (_getSelectionRangeInC = getSelectionRangeInColumn(tr, originIndex)) === null || _getSelectionRangeInC === void 0 ? void 0 : _getSelectionRangeInC.indexes;\n\tconst indexesTargetColumn = (_getSelectionRangeInC2 = getSelectionRangeInColumn(tr, targetIndex)) === null || _getSelectionRangeInC2 === void 0 ? void 0 : _getSelectionRangeInC2.indexes;\n\tif (!indexesOriginColumn || !indexesTargetColumn) return false;\n\tif (indexesOriginColumn.includes(targetIndex)) return false;\n\tconst newTable = moveTableColumn$1(table.node, indexesOriginColumn, indexesTargetColumn, 0);\n\ttr.replaceWith(table.pos, table.pos + table.node.nodeSize, newTable);\n\tif (!select) return true;\n\tconst map = TableMap.get(newTable);\n\tconst start = table.start;\n\tconst index = targetIndex;\n\tconst lastCell = map.positionAt(map.height - 1, index, newTable);\n\tconst $lastCell = tr.doc.resolve(start + lastCell);\n\tconst firstCell = map.positionAt(0, index, newTable);\n\tconst $firstCell = tr.doc.resolve(start + firstCell);\n\ttr.setSelection(CellSelection.colSelection($lastCell, $firstCell));\n\treturn true;\n}\nfunction moveTableColumn$1(table, indexesOrigin, indexesTarget, direction) {\n\tlet rows = transpose(convertTableNodeToArrayOfRows(table));\n\trows = moveRowInArrayOfRows(rows, indexesOrigin, indexesTarget, direction);\n\trows = transpose(rows);\n\treturn convertArrayOfRowsToTableNode(table, rows);\n}\n\n//#endregion\n//#region src/utils/move-row.ts\n/**\n* Move a row from index `origin` to index `target`.\n*\n* @internal\n*/\nfunction moveRow(moveRowParams) {\n\tvar _getSelectionRangeInR, _getSelectionRangeInR2;\n\tconst { tr, originIndex, targetIndex, select, pos } = moveRowParams;\n\tconst table = findTable(tr.doc.resolve(pos));\n\tif (!table) return false;\n\tconst indexesOriginRow = (_getSelectionRangeInR = getSelectionRangeInRow(tr, originIndex)) === null || _getSelectionRangeInR === void 0 ? void 0 : _getSelectionRangeInR.indexes;\n\tconst indexesTargetRow = (_getSelectionRangeInR2 = getSelectionRangeInRow(tr, targetIndex)) === null || _getSelectionRangeInR2 === void 0 ? void 0 : _getSelectionRangeInR2.indexes;\n\tif (!indexesOriginRow || !indexesTargetRow) return false;\n\tif (indexesOriginRow.includes(targetIndex)) return false;\n\tconst newTable = moveTableRow$1(table.node, indexesOriginRow, indexesTargetRow, 0);\n\ttr.replaceWith(table.pos, table.pos + table.node.nodeSize, newTable);\n\tif (!select) return true;\n\tconst map = TableMap.get(newTable);\n\tconst start = table.start;\n\tconst index = targetIndex;\n\tconst lastCell = map.positionAt(index, map.width - 1, newTable);\n\tconst $lastCell = tr.doc.resolve(start + lastCell);\n\tconst firstCell = map.positionAt(index, 0, newTable);\n\tconst $firstCell = tr.doc.resolve(start + firstCell);\n\ttr.setSelection(CellSelection.rowSelection($lastCell, $firstCell));\n\treturn true;\n}\nfunction moveTableRow$1(table, indexesOrigin, indexesTarget, direction) {\n\tlet rows = convertTableNodeToArrayOfRows(table);\n\trows = moveRowInArrayOfRows(rows, indexesOrigin, indexesTarget, direction);\n\treturn convertArrayOfRowsToTableNode(table, rows);\n}\n\n//#endregion\n//#region src/commands.ts\n/**\n* Helper to get the selected rectangle in a table, if any. Adds table\n* map, table node, and table start offset to the object for\n* convenience.\n*\n* @public\n*/\nfunction selectedRect(state) {\n\tconst sel = state.selection;\n\tconst $pos = selectionCell(state);\n\tconst table = $pos.node(-1);\n\tconst tableStart = $pos.start(-1);\n\tconst map = TableMap.get(table);\n\treturn {\n\t\t...sel instanceof CellSelection ? map.rectBetween(sel.$anchorCell.pos - tableStart, sel.$headCell.pos - tableStart) : map.findCell($pos.pos - tableStart),\n\t\ttableStart,\n\t\tmap,\n\t\ttable\n\t};\n}\n/**\n* Add a column at the given position in a table.\n*\n* @public\n*/\nfunction addColumn(tr, { map, tableStart, table }, col) {\n\tlet refColumn = col > 0 ? -1 : 0;\n\tif (columnIsHeader(map, table, col + refColumn)) refColumn = col == 0 || col == map.width ? null : 0;\n\tfor (let row = 0; row < map.height; row++) {\n\t\tconst index = row * map.width + col;\n\t\tif (col > 0 && col < map.width && map.map[index - 1] == map.map[index]) {\n\t\t\tconst pos = map.map[index];\n\t\t\tconst cell = table.nodeAt(pos);\n\t\t\ttr.setNodeMarkup(tr.mapping.map(tableStart + pos), null, addColSpan(cell.attrs, col - map.colCount(pos)));\n\t\t\trow += cell.attrs.rowspan - 1;\n\t\t} else {\n\t\t\tconst type = refColumn == null ? tableNodeTypes(table.type.schema).cell : table.nodeAt(map.map[index + refColumn]).type;\n\t\t\tconst pos = map.positionAt(row, col, table);\n\t\t\ttr.insert(tr.mapping.map(tableStart + pos), type.createAndFill());\n\t\t}\n\t}\n\treturn tr;\n}\n/**\n* Command to add a column before the column with the selection.\n*\n* @public\n*/\nfunction addColumnBefore(state, dispatch) {\n\tif (!isInTable(state)) return false;\n\tif (dispatch) {\n\t\tconst rect = selectedRect(state);\n\t\tdispatch(addColumn(state.tr, rect, rect.left));\n\t}\n\treturn true;\n}\n/**\n* Command to add a column after the column with the selection.\n*\n* @public\n*/\nfunction addColumnAfter(state, dispatch) {\n\tif (!isInTable(state)) return false;\n\tif (dispatch) {\n\t\tconst rect = selectedRect(state);\n\t\tdispatch(addColumn(state.tr, rect, rect.right));\n\t}\n\treturn true;\n}\n/**\n* @public\n*/\nfunction removeColumn(tr, { map, table, tableStart }, col) {\n\tconst mapStart = tr.mapping.maps.length;\n\tfor (let row = 0; row < map.height;) {\n\t\tconst index = row * map.width + col;\n\t\tconst pos = map.map[index];\n\t\tconst cell = table.nodeAt(pos);\n\t\tconst attrs = cell.attrs;\n\t\tif (col > 0 && map.map[index - 1] == pos || col < map.width - 1 && map.map[index + 1] == pos) tr.setNodeMarkup(tr.mapping.slice(mapStart).map(tableStart + pos), null, removeColSpan(attrs, col - map.colCount(pos)));\n\t\telse {\n\t\t\tconst start = tr.mapping.slice(mapStart).map(tableStart + pos);\n\t\t\ttr.delete(start, start + cell.nodeSize);\n\t\t}\n\t\trow += attrs.rowspan;\n\t}\n}\n/**\n* Command function that removes the selected columns from a table.\n*\n* @public\n*/\nfunction deleteColumn(state, dispatch) {\n\tif (!isInTable(state)) return false;\n\tif (dispatch) {\n\t\tconst rect = selectedRect(state);\n\t\tconst tr = state.tr;\n\t\tif (rect.left == 0 && rect.right == rect.map.width) return false;\n\t\tfor (let i = rect.right - 1;; i--) {\n\t\t\tremoveColumn(tr, rect, i);\n\t\t\tif (i == rect.left) break;\n\t\t\tconst table = rect.tableStart ? tr.doc.nodeAt(rect.tableStart - 1) : tr.doc;\n\t\t\tif (!table) throw new RangeError(\"No table found\");\n\t\t\trect.table = table;\n\t\t\trect.map = TableMap.get(table);\n\t\t}\n\t\tdispatch(tr);\n\t}\n\treturn true;\n}\n/**\n* @public\n*/\nfunction rowIsHeader(map, table, row) {\n\tvar _table$nodeAt;\n\tconst headerCell = tableNodeTypes(table.type.schema).header_cell;\n\tfor (let col = 0; col < map.width; col++) if (((_table$nodeAt = table.nodeAt(map.map[col + row * map.width])) === null || _table$nodeAt === void 0 ? void 0 : _table$nodeAt.type) != headerCell) return false;\n\treturn true;\n}\n/**\n* @public\n*/\nfunction addRow(tr, { map, tableStart, table }, row) {\n\tlet rowPos = tableStart;\n\tfor (let i = 0; i < row; i++) rowPos += table.child(i).nodeSize;\n\tconst cells = [];\n\tlet refRow = row > 0 ? -1 : 0;\n\tif (rowIsHeader(map, table, row + refRow)) refRow = row == 0 || row == map.height ? null : 0;\n\tfor (let col = 0, index = map.width * row; col < map.width; col++, index++) if (row > 0 && row < map.height && map.map[index] == map.map[index - map.width]) {\n\t\tconst pos = map.map[index];\n\t\tconst attrs = table.nodeAt(pos).attrs;\n\t\ttr.setNodeMarkup(tableStart + pos, null, {\n\t\t\t...attrs,\n\t\t\trowspan: attrs.rowspan + 1\n\t\t});\n\t\tcol += attrs.colspan - 1;\n\t} else {\n\t\tvar _table$nodeAt2;\n\t\tconst type = refRow == null ? tableNodeTypes(table.type.schema).cell : (_table$nodeAt2 = table.nodeAt(map.map[index + refRow * map.width])) === null || _table$nodeAt2 === void 0 ? void 0 : _table$nodeAt2.type;\n\t\tconst node = type === null || type === void 0 ? void 0 : type.createAndFill();\n\t\tif (node) cells.push(node);\n\t}\n\ttr.insert(rowPos, tableNodeTypes(table.type.schema).row.create(null, cells));\n\treturn tr;\n}\n/**\n* Add a table row before the selection.\n*\n* @public\n*/\nfunction addRowBefore(state, dispatch) {\n\tif (!isInTable(state)) return false;\n\tif (dispatch) {\n\t\tconst rect = selectedRect(state);\n\t\tdispatch(addRow(state.tr, rect, rect.top));\n\t}\n\treturn true;\n}\n/**\n* Add a table row after the selection.\n*\n* @public\n*/\nfunction addRowAfter(state, dispatch) {\n\tif (!isInTable(state)) return false;\n\tif (dispatch) {\n\t\tconst rect = selectedRect(state);\n\t\tdispatch(addRow(state.tr, rect, rect.bottom));\n\t}\n\treturn true;\n}\n/**\n* @public\n*/\nfunction removeRow(tr, { map, table, tableStart }, row) {\n\tlet rowPos = 0;\n\tfor (let i = 0; i < row; i++) rowPos += table.child(i).nodeSize;\n\tconst nextRow = rowPos + table.child(row).nodeSize;\n\tconst mapFrom = tr.mapping.maps.length;\n\ttr.delete(rowPos + tableStart, nextRow + tableStart);\n\tconst seen = /* @__PURE__ */ new Set();\n\tfor (let col = 0, index = row * map.width; col < map.width; col++, index++) {\n\t\tconst pos = map.map[index];\n\t\tif (seen.has(pos)) continue;\n\t\tseen.add(pos);\n\t\tif (row > 0 && pos == map.map[index - map.width]) {\n\t\t\tconst attrs = table.nodeAt(pos).attrs;\n\t\t\ttr.setNodeMarkup(tr.mapping.slice(mapFrom).map(pos + tableStart), null, {\n\t\t\t\t...attrs,\n\t\t\t\trowspan: attrs.rowspan - 1\n\t\t\t});\n\t\t\tcol += attrs.colspan - 1;\n\t\t} else if (row < map.height && pos == map.map[index + map.width]) {\n\t\t\tconst cell = table.nodeAt(pos);\n\t\t\tconst attrs = cell.attrs;\n\t\t\tconst copy = cell.type.create({\n\t\t\t\t...attrs,\n\t\t\t\trowspan: cell.attrs.rowspan - 1\n\t\t\t}, cell.content);\n\t\t\tconst newPos = map.positionAt(row + 1, col, table);\n\t\t\ttr.insert(tr.mapping.slice(mapFrom).map(tableStart + newPos), copy);\n\t\t\tcol += attrs.colspan - 1;\n\t\t}\n\t}\n}\n/**\n* Remove the selected rows from a table.\n*\n* @public\n*/\nfunction deleteRow(state, dispatch) {\n\tif (!isInTable(state)) return false;\n\tif (dispatch) {\n\t\tconst rect = selectedRect(state), tr = state.tr;\n\t\tif (rect.top == 0 && rect.bottom == rect.map.height) return false;\n\t\tfor (let i = rect.bottom - 1;; i--) {\n\t\t\tremoveRow(tr, rect, i);\n\t\t\tif (i == rect.top) break;\n\t\t\tconst table = rect.tableStart ? tr.doc.nodeAt(rect.tableStart - 1) : tr.doc;\n\t\t\tif (!table) throw new RangeError(\"No table found\");\n\t\t\trect.table = table;\n\t\t\trect.map = TableMap.get(rect.table);\n\t\t}\n\t\tdispatch(tr);\n\t}\n\treturn true;\n}\nfunction isEmpty(cell) {\n\tconst c = cell.content;\n\treturn c.childCount == 1 && c.child(0).isTextblock && c.child(0).childCount == 0;\n}\nfunction cellsOverlapRectangle({ width, height, map }, rect) {\n\tlet indexTop = rect.top * width + rect.left, indexLeft = indexTop;\n\tlet indexBottom = (rect.bottom - 1) * width + rect.left, indexRight = indexTop + (rect.right - rect.left - 1);\n\tfor (let i = rect.top; i < rect.bottom; i++) {\n\t\tif (rect.left > 0 && map[indexLeft] == map[indexLeft - 1] || rect.right < width && map[indexRight] == map[indexRight + 1]) return true;\n\t\tindexLeft += width;\n\t\tindexRight += width;\n\t}\n\tfor (let i = rect.left; i < rect.right; i++) {\n\t\tif (rect.top > 0 && map[indexTop] == map[indexTop - width] || rect.bottom < height && map[indexBottom] == map[indexBottom + width]) return true;\n\t\tindexTop++;\n\t\tindexBottom++;\n\t}\n\treturn false;\n}\n/**\n* Merge the selected cells into a single cell. Only available when\n* the selected cells' outline forms a rectangle.\n*\n* @public\n*/\nfunction mergeCells(state, dispatch) {\n\tconst sel = state.selection;\n\tif (!(sel instanceof CellSelection) || sel.$anchorCell.pos == sel.$headCell.pos) return false;\n\tconst rect = selectedRect(state), { map } = rect;\n\tif (cellsOverlapRectangle(map, rect)) return false;\n\tif (dispatch) {\n\t\tconst tr = state.tr;\n\t\tconst seen = {};\n\t\tlet content = Fragment.empty;\n\t\tlet mergedPos;\n\t\tlet mergedCell;\n\t\tfor (let row = rect.top; row < rect.bottom; row++) for (let col = rect.left; col < rect.right; col++) {\n\t\t\tconst cellPos = map.map[row * map.width + col];\n\t\t\tconst cell = rect.table.nodeAt(cellPos);\n\t\t\tif (seen[cellPos] || !cell) continue;\n\t\t\tseen[cellPos] = true;\n\t\t\tif (mergedPos == null) {\n\t\t\t\tmergedPos = cellPos;\n\t\t\t\tmergedCell = cell;\n\t\t\t} else {\n\t\t\t\tif (!isEmpty(cell)) content = content.append(cell.content);\n\t\t\t\tconst mapped = tr.mapping.map(cellPos + rect.tableStart);\n\t\t\t\ttr.delete(mapped, mapped + cell.nodeSize);\n\t\t\t}\n\t\t}\n\t\tif (mergedPos == null || mergedCell == null) return true;\n\t\ttr.setNodeMarkup(mergedPos + rect.tableStart, null, {\n\t\t\t...addColSpan(mergedCell.attrs, mergedCell.attrs.colspan, rect.right - rect.left - mergedCell.attrs.colspan),\n\t\t\trowspan: rect.bottom - rect.top\n\t\t});\n\t\tif (content.size > 0) {\n\t\t\tconst end = mergedPos + 1 + mergedCell.content.size;\n\t\t\tconst start = isEmpty(mergedCell) ? mergedPos + 1 : end;\n\t\t\ttr.replaceWith(start + rect.tableStart, end + rect.tableStart, content);\n\t\t}\n\t\ttr.setSelection(new CellSelection(tr.doc.resolve(mergedPos + rect.tableStart)));\n\t\tdispatch(tr);\n\t}\n\treturn true;\n}\n/**\n* Split a selected cell, whose rowpan or colspan is greater than one,\n* into smaller cells. Use the first cell type for the new cells.\n*\n* @public\n*/\nfunction splitCell(state, dispatch) {\n\tconst nodeTypes = tableNodeTypes(state.schema);\n\treturn splitCellWithType(({ node }) => {\n\t\treturn nodeTypes[node.type.spec.tableRole];\n\t})(state, dispatch);\n}\n/**\n* Split a selected cell, whose rowpan or colspan is greater than one,\n* into smaller cells with the cell type (th, td) returned by getType function.\n*\n* @public\n*/\nfunction splitCellWithType(getCellType) {\n\treturn (state, dispatch) => {\n\t\tconst sel = state.selection;\n\t\tlet cellNode;\n\t\tlet cellPos;\n\t\tif (!(sel instanceof CellSelection)) {\n\t\t\tvar _cellAround;\n\t\t\tcellNode = cellWrapping(sel.$from);\n\t\t\tif (!cellNode) return false;\n\t\t\tcellPos = (_cellAround = cellAround(sel.$from)) === null || _cellAround === void 0 ? void 0 : _cellAround.pos;\n\t\t} else {\n\t\t\tif (sel.$anchorCell.pos != sel.$headCell.pos) return false;\n\t\t\tcellNode = sel.$anchorCell.nodeAfter;\n\t\t\tcellPos = sel.$anchorCell.pos;\n\t\t}\n\t\tif (cellNode == null || cellPos == null) return false;\n\t\tif (cellNode.attrs.colspan == 1 && cellNode.attrs.rowspan == 1) return false;\n\t\tif (dispatch) {\n\t\t\tlet baseAttrs = cellNode.attrs;\n\t\t\tconst attrs = [];\n\t\t\tconst colwidth = baseAttrs.colwidth;\n\t\t\tif (baseAttrs.rowspan > 1) baseAttrs = {\n\t\t\t\t...baseAttrs,\n\t\t\t\trowspan: 1\n\t\t\t};\n\t\t\tif (baseAttrs.colspan > 1) baseAttrs = {\n\t\t\t\t...baseAttrs,\n\t\t\t\tcolspan: 1\n\t\t\t};\n\t\t\tconst rect = selectedRect(state), tr = state.tr;\n\t\t\tfor (let i = 0; i < rect.right - rect.left; i++) attrs.push(colwidth ? {\n\t\t\t\t...baseAttrs,\n\t\t\t\tcolwidth: colwidth && colwidth[i] ? [colwidth[i]] : null\n\t\t\t} : baseAttrs);\n\t\t\tlet lastCell;\n\t\t\tfor (let row = rect.top; row < rect.bottom; row++) {\n\t\t\t\tlet pos = rect.map.positionAt(row, rect.left, rect.table);\n\t\t\t\tif (row == rect.top) pos += cellNode.nodeSize;\n\t\t\t\tfor (let col = rect.left, i = 0; col < rect.right; col++, i++) {\n\t\t\t\t\tif (col == rect.left && row == rect.top) continue;\n\t\t\t\t\ttr.insert(lastCell = tr.mapping.map(pos + rect.tableStart, 1), getCellType({\n\t\t\t\t\t\tnode: cellNode,\n\t\t\t\t\t\trow,\n\t\t\t\t\t\tcol\n\t\t\t\t\t}).createAndFill(attrs[i]));\n\t\t\t\t}\n\t\t\t}\n\t\t\ttr.setNodeMarkup(cellPos, getCellType({\n\t\t\t\tnode: cellNode,\n\t\t\t\trow: rect.top,\n\t\t\t\tcol: rect.left\n\t\t\t}), attrs[0]);\n\t\t\tif (sel instanceof CellSelection) tr.setSelection(new CellSelection(tr.doc.resolve(sel.$anchorCell.pos), lastCell ? tr.doc.resolve(lastCell) : void 0));\n\t\t\tdispatch(tr);\n\t\t}\n\t\treturn true;\n\t};\n}\n/**\n* Returns a command that sets the given attribute to the given value,\n* and is only available when the currently selected cell doesn't\n* already have that attribute set to that value.\n*\n* @public\n*/\nfunction setCellAttr(name, value) {\n\treturn function(state, dispatch) {\n\t\tif (!isInTable(state)) return false;\n\t\tconst $cell = selectionCell(state);\n\t\tif ($cell.nodeAfter.attrs[name] === value) return false;\n\t\tif (dispatch) {\n\t\t\tconst tr = state.tr;\n\t\t\tif (state.selection instanceof CellSelection) state.selection.forEachCell((node, pos) => {\n\t\t\t\tif (node.attrs[name] !== value) tr.setNodeMarkup(pos, null, {\n\t\t\t\t\t...node.attrs,\n\t\t\t\t\t[name]: value\n\t\t\t\t});\n\t\t\t});\n\t\t\telse tr.setNodeMarkup($cell.pos, null, {\n\t\t\t\t...$cell.nodeAfter.attrs,\n\t\t\t\t[name]: value\n\t\t\t});\n\t\t\tdispatch(tr);\n\t\t}\n\t\treturn true;\n\t};\n}\nfunction deprecated_toggleHeader(type) {\n\treturn function(state, dispatch) {\n\t\tif (!isInTable(state)) return false;\n\t\tif (dispatch) {\n\t\t\tconst types = tableNodeTypes(state.schema);\n\t\t\tconst rect = selectedRect(state), tr = state.tr;\n\t\t\tconst cells = rect.map.cellsInRect(type == \"column\" ? {\n\t\t\t\tleft: rect.left,\n\t\t\t\ttop: 0,\n\t\t\t\tright: rect.right,\n\t\t\t\tbottom: rect.map.height\n\t\t\t} : type == \"row\" ? {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: rect.top,\n\t\t\t\tright: rect.map.width,\n\t\t\t\tbottom: rect.bottom\n\t\t\t} : rect);\n\t\t\tconst nodes = cells.map((pos) => rect.table.nodeAt(pos));\n\t\t\tfor (let i = 0; i < cells.length; i++) if (nodes[i].type == types.header_cell) tr.setNodeMarkup(rect.tableStart + cells[i], types.cell, nodes[i].attrs);\n\t\t\tif (tr.steps.length === 0) for (let i = 0; i < cells.length; i++) tr.setNodeMarkup(rect.tableStart + cells[i], types.header_cell, nodes[i].attrs);\n\t\t\tdispatch(tr);\n\t\t}\n\t\treturn true;\n\t};\n}\nfunction isHeaderEnabledByType(type, rect, types) {\n\tconst cellPositions = rect.map.cellsInRect({\n\t\tleft: 0,\n\t\ttop: 0,\n\t\tright: type == \"row\" ? rect.map.width : 1,\n\t\tbottom: type == \"column\" ? rect.map.height : 1\n\t});\n\tfor (let i = 0; i < cellPositions.length; i++) {\n\t\tconst cell = rect.table.nodeAt(cellPositions[i]);\n\t\tif (cell && cell.type !== types.header_cell) return false;\n\t}\n\treturn true;\n}\n/**\n* Toggles between row/column header and normal cells (Only applies to first row/column).\n* For deprecated behavior pass `useDeprecatedLogic` in options with true.\n*\n* @public\n*/\nfunction toggleHeader(type, options) {\n\toptions = options || { useDeprecatedLogic: false };\n\tif (options.useDeprecatedLogic) return deprecated_toggleHeader(type);\n\treturn function(state, dispatch) {\n\t\tif (!isInTable(state)) return false;\n\t\tif (dispatch) {\n\t\t\tconst types = tableNodeTypes(state.schema);\n\t\t\tconst rect = selectedRect(state), tr = state.tr;\n\t\t\tconst isHeaderRowEnabled = isHeaderEnabledByType(\"row\", rect, types);\n\t\t\tconst isHeaderColumnEnabled = isHeaderEnabledByType(\"column\", rect, types);\n\t\t\tconst selectionStartsAt = (type === \"column\" ? isHeaderRowEnabled : type === \"row\" ? isHeaderColumnEnabled : false) ? 1 : 0;\n\t\t\tconst cellsRect = type == \"column\" ? {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: selectionStartsAt,\n\t\t\t\tright: 1,\n\t\t\t\tbottom: rect.map.height\n\t\t\t} : type == \"row\" ? {\n\t\t\t\tleft: selectionStartsAt,\n\t\t\t\ttop: 0,\n\t\t\t\tright: rect.map.width,\n\t\t\t\tbottom: 1\n\t\t\t} : rect;\n\t\t\tconst newType = type == \"column\" ? isHeaderColumnEnabled ? types.cell : types.header_cell : type == \"row\" ? isHeaderRowEnabled ? types.cell : types.header_cell : types.cell;\n\t\t\trect.map.cellsInRect(cellsRect).forEach((relativeCellPos) => {\n\t\t\t\tconst cellPos = relativeCellPos + rect.tableStart;\n\t\t\t\tconst cell = tr.doc.nodeAt(cellPos);\n\t\t\t\tif (cell) tr.setNodeMarkup(cellPos, newType, cell.attrs);\n\t\t\t});\n\t\t\tdispatch(tr);\n\t\t}\n\t\treturn true;\n\t};\n}\n/**\n* Toggles whether the selected row contains header cells.\n*\n* @public\n*/\nconst toggleHeaderRow = toggleHeader(\"row\", { useDeprecatedLogic: true });\n/**\n* Toggles whether the selected column contains header cells.\n*\n* @public\n*/\nconst toggleHeaderColumn = toggleHeader(\"column\", { useDeprecatedLogic: true });\n/**\n* Toggles whether the selected cells are header cells.\n*\n* @public\n*/\nconst toggleHeaderCell = toggleHeader(\"cell\", { useDeprecatedLogic: true });\nfunction findNextCell($cell, dir) {\n\tif (dir < 0) {\n\t\tconst before = $cell.nodeBefore;\n\t\tif (before) return $cell.pos - before.nodeSize;\n\t\tfor (let row = $cell.index(-1) - 1, rowEnd = $cell.before(); row >= 0; row--) {\n\t\t\tconst rowNode = $cell.node(-1).child(row);\n\t\t\tconst lastChild = rowNode.lastChild;\n\t\t\tif (lastChild) return rowEnd - 1 - lastChild.nodeSize;\n\t\t\trowEnd -= rowNode.nodeSize;\n\t\t}\n\t} else {\n\t\tif ($cell.index() < $cell.parent.childCount - 1) return $cell.pos + $cell.nodeAfter.nodeSize;\n\t\tconst table = $cell.node(-1);\n\t\tfor (let row = $cell.indexAfter(-1), rowStart = $cell.after(); row < table.childCount; row++) {\n\t\t\tconst rowNode = table.child(row);\n\t\t\tif (rowNode.childCount) return rowStart + 1;\n\t\t\trowStart += rowNode.nodeSize;\n\t\t}\n\t}\n\treturn null;\n}\n/**\n* Returns a command for selecting the next (direction=1) or previous\n* (direction=-1) cell in a table.\n*\n* @public\n*/\nfunction goToNextCell(direction) {\n\treturn function(state, dispatch) {\n\t\tif (!isInTable(state)) return false;\n\t\tconst cell = findNextCell(selectionCell(state), direction);\n\t\tif (cell == null) return false;\n\t\tif (dispatch) {\n\t\t\tconst $cell = state.doc.resolve(cell);\n\t\t\tdispatch(state.tr.setSelection(TextSelection.between($cell, moveCellForward($cell))).scrollIntoView());\n\t\t}\n\t\treturn true;\n\t};\n}\n/**\n* Deletes the table around the selection, if any.\n*\n* @public\n*/\nfunction deleteTable(state, dispatch) {\n\tconst $pos = state.selection.$anchor;\n\tfor (let d = $pos.depth; d > 0; d--) if ($pos.node(d).type.spec.tableRole == \"table\") {\n\t\tif (dispatch) dispatch(state.tr.delete($pos.before(d), $pos.after(d)).scrollIntoView());\n\t\treturn true;\n\t}\n\treturn false;\n}\n/**\n* Deletes the content of the selected cells, if they are not empty.\n*\n* @public\n*/\nfunction deleteCellSelection(state, dispatch) {\n\tconst sel = state.selection;\n\tif (!(sel instanceof CellSelection)) return false;\n\tif (dispatch) {\n\t\tconst tr = state.tr;\n\t\tconst baseContent = tableNodeTypes(state.schema).cell.createAndFill().content;\n\t\tsel.forEachCell((cell, pos) => {\n\t\t\tif (!cell.content.eq(baseContent)) tr.replace(tr.mapping.map(pos + 1), tr.mapping.map(pos + cell.nodeSize - 1), new Slice(baseContent, 0, 0));\n\t\t});\n\t\tif (tr.docChanged) dispatch(tr);\n\t}\n\treturn true;\n}\n/**\n* Move a table row from index `from` to index `to`.\n*\n* @public\n*/\nfunction moveTableRow(options) {\n\treturn (state, dispatch) => {\n\t\tconst { from: originIndex, to: targetIndex, select = true, pos = state.selection.from } = options;\n\t\tconst tr = state.tr;\n\t\tif (moveRow({\n\t\t\ttr,\n\t\t\toriginIndex,\n\t\t\ttargetIndex,\n\t\t\tselect,\n\t\t\tpos\n\t\t})) {\n\t\t\tdispatch === null || dispatch === void 0 || dispatch(tr);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n}\n/**\n* Move a table column from index `from` to index `to`.\n*\n* @public\n*/\nfunction moveTableColumn(options) {\n\treturn (state, dispatch) => {\n\t\tconst { from: originIndex, to: targetIndex, select = true, pos = state.selection.from } = options;\n\t\tconst tr = state.tr;\n\t\tif (moveColumn({\n\t\t\ttr,\n\t\t\toriginIndex,\n\t\t\ttargetIndex,\n\t\t\tselect,\n\t\t\tpos\n\t\t})) {\n\t\t\tdispatch === null || dispatch === void 0 || dispatch(tr);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n}\n\n//#endregion\n//#region src/copypaste.ts\n/**\n* Get a rectangular area of cells from a slice, or null if the outer\n* nodes of the slice aren't table cells or rows.\n*\n* @internal\n*/\nfunction pastedCells(slice) {\n\tif (slice.size === 0) return null;\n\tlet { content, openStart, openEnd } = slice;\n\twhile (content.childCount == 1 && (openStart > 0 && openEnd > 0 || content.child(0).type.spec.tableRole == \"table\")) {\n\t\topenStart--;\n\t\topenEnd--;\n\t\tcontent = content.child(0).content;\n\t}\n\tconst first = content.child(0);\n\tconst role = first.type.spec.tableRole;\n\tconst schema = first.type.schema, rows = [];\n\tif (role == \"row\") for (let i = 0; i < content.childCount; i++) {\n\t\tlet cells = content.child(i).content;\n\t\tconst left = i ? 0 : Math.max(0, openStart - 1);\n\t\tconst right = i < content.childCount - 1 ? 0 : Math.max(0, openEnd - 1);\n\t\tif (left || right) cells = fitSlice(tableNodeTypes(schema).row, new Slice(cells, left, right)).content;\n\t\trows.push(cells);\n\t}\n\telse if (role == \"cell\" || role == \"header_cell\") rows.push(openStart || openEnd ? fitSlice(tableNodeTypes(schema).row, new Slice(content, openStart, openEnd)).content : content);\n\telse return null;\n\treturn ensureRectangular(schema, rows);\n}\nfunction ensureRectangular(schema, rows) {\n\tconst widths = [];\n\tfor (let i = 0; i < rows.length; i++) {\n\t\tconst row = rows[i];\n\t\tfor (let j = row.childCount - 1; j >= 0; j--) {\n\t\t\tconst { rowspan, colspan } = row.child(j).attrs;\n\t\t\tfor (let r = i; r < i + rowspan; r++) widths[r] = (widths[r] || 0) + colspan;\n\t\t}\n\t}\n\tlet width = 0;\n\tfor (let r = 0; r < widths.length; r++) width = Math.max(width, widths[r]);\n\tfor (let r = 0; r < widths.length; r++) {\n\t\tif (r >= rows.length) rows.push(Fragment.empty);\n\t\tif (widths[r] < width) {\n\t\t\tconst empty = tableNodeTypes(schema).cell.createAndFill();\n\t\t\tconst cells = [];\n\t\t\tfor (let i = widths[r]; i < width; i++) cells.push(empty);\n\t\t\trows[r] = rows[r].append(Fragment.from(cells));\n\t\t}\n\t}\n\treturn {\n\t\theight: rows.length,\n\t\twidth,\n\t\trows\n\t};\n}\nfunction fitSlice(nodeType, slice) {\n\tconst node = nodeType.createAndFill();\n\treturn new Transform(node).replace(0, node.content.size, slice).doc;\n}\n/**\n* Clip or extend (repeat) the given set of cells to cover the given\n* width and height. Will clip rowspan/colspan cells at the edges when\n* they stick out.\n*\n* @internal\n*/\nfunction clipCells({ width, height, rows }, newWidth, newHeight) {\n\tif (width != newWidth) {\n\t\tconst added = [];\n\t\tconst newRows = [];\n\t\tfor (let row = 0; row < rows.length; row++) {\n\t\t\tconst frag = rows[row], cells = [];\n\t\t\tfor (let col = added[row] || 0, i = 0; col < newWidth; i++) {\n\t\t\t\tlet cell = frag.child(i % frag.childCount);\n\t\t\t\tif (col + cell.attrs.colspan > newWidth) cell = cell.type.createChecked(removeColSpan(cell.attrs, cell.attrs.colspan, col + cell.attrs.colspan - newWidth), cell.content);\n\t\t\t\tcells.push(cell);\n\t\t\t\tcol += cell.attrs.colspan;\n\t\t\t\tfor (let j = 1; j < cell.attrs.rowspan; j++) added[row + j] = (added[row + j] || 0) + cell.attrs.colspan;\n\t\t\t}\n\t\t\tnewRows.push(Fragment.from(cells));\n\t\t}\n\t\trows = newRows;\n\t\twidth = newWidth;\n\t}\n\tif (height != newHeight) {\n\t\tconst newRows = [];\n\t\tfor (let row = 0, i = 0; row < newHeight; row++, i++) {\n\t\t\tconst cells = [], source = rows[i % height];\n\t\t\tfor (let j = 0; j < source.childCount; j++) {\n\t\t\t\tlet cell = source.child(j);\n\t\t\t\tif (row + cell.attrs.rowspan > newHeight) cell = cell.type.create({\n\t\t\t\t\t...cell.attrs,\n\t\t\t\t\trowspan: Math.max(1, newHeight - cell.attrs.rowspan)\n\t\t\t\t}, cell.content);\n\t\t\t\tcells.push(cell);\n\t\t\t}\n\t\t\tnewRows.push(Fragment.from(cells));\n\t\t}\n\t\trows = newRows;\n\t\theight = newHeight;\n\t}\n\treturn {\n\t\twidth,\n\t\theight,\n\t\trows\n\t};\n}\nfunction growTable(tr, map, table, start, width, height, mapFrom) {\n\tconst schema = tr.doc.type.schema;\n\tconst types = tableNodeTypes(schema);\n\tlet empty;\n\tlet emptyHead;\n\tif (width > map.width) for (let row = 0, rowEnd = 0; row < map.height; row++) {\n\t\tconst rowNode = table.child(row);\n\t\trowEnd += rowNode.nodeSize;\n\t\tconst cells = [];\n\t\tlet add;\n\t\tif (rowNode.lastChild == null || rowNode.lastChild.type == types.cell) add = empty || (empty = types.cell.createAndFill());\n\t\telse add = emptyHead || (emptyHead = types.header_cell.createAndFill());\n\t\tfor (let i = map.width; i < width; i++) cells.push(add);\n\t\ttr.insert(tr.mapping.slice(mapFrom).map(rowEnd - 1 + start), cells);\n\t}\n\tif (height > map.height) {\n\t\tconst cells = [];\n\t\tfor (let i = 0, start$1 = (map.height - 1) * map.width; i < Math.max(map.width, width); i++) {\n\t\t\tconst header = i >= map.width ? false : table.nodeAt(map.map[start$1 + i]).type == types.header_cell;\n\t\t\tcells.push(header ? emptyHead || (emptyHead = types.header_cell.createAndFill()) : empty || (empty = types.cell.createAndFill()));\n\t\t}\n\t\tconst emptyRow = types.row.create(null, Fragment.from(cells)), rows = [];\n\t\tfor (let i = map.height; i < height; i++) rows.push(emptyRow);\n\t\ttr.insert(tr.mapping.slice(mapFrom).map(start + table.nodeSize - 2), rows);\n\t}\n\treturn !!(empty || emptyHead);\n}\nfunction isolateHorizontal(tr, map, table, start, left, right, top, mapFrom) {\n\tif (top == 0 || top == map.height) return false;\n\tlet found = false;\n\tfor (let col = left; col < right; col++) {\n\t\tconst index = top * map.width + col, pos = map.map[index];\n\t\tif (map.map[index - map.width] == pos) {\n\t\t\tfound = true;\n\t\t\tconst cell = table.nodeAt(pos);\n\t\t\tconst { top: cellTop, left: cellLeft } = map.findCell(pos);\n\t\t\ttr.setNodeMarkup(tr.mapping.slice(mapFrom).map(pos + start), null, {\n\t\t\t\t...cell.attrs,\n\t\t\t\trowspan: top - cellTop\n\t\t\t});\n\t\t\ttr.insert(tr.mapping.slice(mapFrom).map(map.positionAt(top, cellLeft, table)), cell.type.createAndFill({\n\t\t\t\t...cell.attrs,\n\t\t\t\trowspan: cellTop + cell.attrs.rowspan - top\n\t\t\t}));\n\t\t\tcol += cell.attrs.colspan - 1;\n\t\t}\n\t}\n\treturn found;\n}\nfunction isolateVertical(tr, map, table, start, top, bottom, left, mapFrom) {\n\tif (left == 0 || left == map.width) return false;\n\tlet found = false;\n\tfor (let row = top; row < bottom; row++) {\n\t\tconst index = row * map.width + left, pos = map.map[index];\n\t\tif (map.map[index - 1] == pos) {\n\t\t\tfound = true;\n\t\t\tconst cell = table.nodeAt(pos);\n\t\t\tconst cellLeft = map.colCount(pos);\n\t\t\tconst updatePos = tr.mapping.slice(mapFrom).map(pos + start);\n\t\t\ttr.setNodeMarkup(updatePos, null, removeColSpan(cell.attrs, left - cellLeft, cell.attrs.colspan - (left - cellLeft)));\n\t\t\ttr.insert(updatePos + cell.nodeSize, cell.type.createAndFill(removeColSpan(cell.attrs, 0, left - cellLeft)));\n\t\t\trow += cell.attrs.rowspan - 1;\n\t\t}\n\t}\n\treturn found;\n}\n/**\n* Insert the given set of cells (as returned by `pastedCells`) into a\n* table, at the position pointed at by rect.\n*\n* @internal\n*/\nfunction insertCells(state, dispatch, tableStart, rect, cells) {\n\tlet table = tableStart ? state.doc.nodeAt(tableStart - 1) : state.doc;\n\tif (!table) throw new Error(\"No table found\");\n\tlet map = TableMap.get(table);\n\tconst { top, left } = rect;\n\tconst right = left + cells.width, bottom = top + cells.height;\n\tconst tr = state.tr;\n\tlet mapFrom = 0;\n\tfunction recomp() {\n\t\ttable = tableStart ? tr.doc.nodeAt(tableStart - 1) : tr.doc;\n\t\tif (!table) throw new Error(\"No table found\");\n\t\tmap = TableMap.get(table);\n\t\tmapFrom = tr.mapping.maps.length;\n\t}\n\tif (growTable(tr, map, table, tableStart, right, bottom, mapFrom)) recomp();\n\tif (isolateHorizontal(tr, map, table, tableStart, left, right, top, mapFrom)) recomp();\n\tif (isolateHorizontal(tr, map, table, tableStart, left, right, bottom, mapFrom)) recomp();\n\tif (isolateVertical(tr, map, table, tableStart, top, bottom, left, mapFrom)) recomp();\n\tif (isolateVertical(tr, map, table, tableStart, top, bottom, right, mapFrom)) recomp();\n\tfor (let row = top; row < bottom; row++) {\n\t\tconst from = map.positionAt(row, left, table), to = map.positionAt(row, right, table);\n\t\ttr.replace(tr.mapping.slice(mapFrom).map(from + tableStart), tr.mapping.slice(mapFrom).map(to + tableStart), new Slice(cells.rows[row - top], 0, 0));\n\t}\n\trecomp();\n\ttr.setSelection(new CellSelection(tr.doc.resolve(tableStart + map.positionAt(top, left, table)), tr.doc.resolve(tableStart + map.positionAt(bottom - 1, right - 1, table))));\n\tdispatch(tr);\n}\n\n//#endregion\n//#region src/input.ts\nconst handleKeyDown = keydownHandler({\n\tArrowLeft: arrow(\"horiz\", -1),\n\tArrowRight: arrow(\"horiz\", 1),\n\tArrowUp: arrow(\"vert\", -1),\n\tArrowDown: arrow(\"vert\", 1),\n\t\"Shift-ArrowLeft\": shiftArrow(\"horiz\", -1),\n\t\"Shift-ArrowRight\": shiftArrow(\"horiz\", 1),\n\t\"Shift-ArrowUp\": shiftArrow(\"vert\", -1),\n\t\"Shift-ArrowDown\": shiftArrow(\"vert\", 1),\n\tBackspace: deleteCellSelection,\n\t\"Mod-Backspace\": deleteCellSelection,\n\tDelete: deleteCellSelection,\n\t\"Mod-Delete\": deleteCellSelection\n});\nfunction maybeSetSelection(state, dispatch, selection) {\n\tif (selection.eq(state.selection)) return false;\n\tif (dispatch) dispatch(state.tr.setSelection(selection).scrollIntoView());\n\treturn true;\n}\n/**\n* @internal\n*/\nfunction arrow(axis, dir) {\n\treturn (state, dispatch, view) => {\n\t\tif (!view) return false;\n\t\tconst sel = state.selection;\n\t\tif (sel instanceof CellSelection) return maybeSetSelection(state, dispatch, Selection.near(sel.$headCell, dir));\n\t\tif (axis != \"horiz\" && !sel.empty) return false;\n\t\tconst end = atEndOfCell(view, axis, dir);\n\t\tif (end == null) return false;\n\t\tif (axis == \"horiz\") return maybeSetSelection(state, dispatch, Selection.near(state.doc.resolve(sel.head + dir), dir));\n\t\telse {\n\t\t\tconst $cell = state.doc.resolve(end);\n\t\t\tconst $next = nextCell($cell, axis, dir);\n\t\t\tlet newSel;\n\t\t\tif ($next) newSel = Selection.near($next, 1);\n\t\t\telse if (dir < 0) newSel = Selection.near(state.doc.resolve($cell.before(-1)), -1);\n\t\t\telse newSel = Selection.near(state.doc.resolve($cell.after(-1)), 1);\n\t\t\treturn maybeSetSelection(state, dispatch, newSel);\n\t\t}\n\t};\n}\nfunction shiftArrow(axis, dir) {\n\treturn (state, dispatch, view) => {\n\t\tif (!view) return false;\n\t\tconst sel = state.selection;\n\t\tlet cellSel;\n\t\tif (sel instanceof CellSelection) cellSel = sel;\n\t\telse {\n\t\t\tconst end = atEndOfCell(view, axis, dir);\n\t\t\tif (end == null) return false;\n\t\t\tcellSel = new CellSelection(state.doc.resolve(end));\n\t\t}\n\t\tconst $head = nextCell(cellSel.$headCell, axis, dir);\n\t\tif (!$head) return false;\n\t\treturn maybeSetSelection(state, dispatch, new CellSelection(cellSel.$anchorCell, $head));\n\t};\n}\nfunction handleTripleClick(view, pos) {\n\tconst doc = view.state.doc, $cell = cellAround(doc.resolve(pos));\n\tif (!$cell) return false;\n\tview.dispatch(view.state.tr.setSelection(new CellSelection($cell)));\n\treturn true;\n}\n/**\n* @public\n*/\nfunction handlePaste(view, _, slice) {\n\tif (!isInTable(view.state)) return false;\n\tlet cells = pastedCells(slice);\n\tconst sel = view.state.selection;\n\tif (sel instanceof CellSelection) {\n\t\tif (!cells) cells = {\n\t\t\twidth: 1,\n\t\t\theight: 1,\n\t\t\trows: [Fragment.from(fitSlice(tableNodeTypes(view.state.schema).cell, slice))]\n\t\t};\n\t\tconst table = sel.$anchorCell.node(-1);\n\t\tconst start = sel.$anchorCell.start(-1);\n\t\tconst rect = TableMap.get(table).rectBetween(sel.$anchorCell.pos - start, sel.$headCell.pos - start);\n\t\tcells = clipCells(cells, rect.right - rect.left, rect.bottom - rect.top);\n\t\tinsertCells(view.state, view.dispatch, start, rect, cells);\n\t\treturn true;\n\t} else if (cells) {\n\t\tconst $cell = selectionCell(view.state);\n\t\tconst start = $cell.start(-1);\n\t\tinsertCells(view.state, view.dispatch, start, TableMap.get($cell.node(-1)).findCell($cell.pos - start), cells);\n\t\treturn true;\n\t} else return false;\n}\nfunction handleMouseDown$1(view, startEvent) {\n\tvar _cellUnderMouse;\n\tif (startEvent.button != 0) return;\n\tif (startEvent.ctrlKey || startEvent.metaKey) return;\n\tconst startDOMCell = domInCell(view, startEvent.target);\n\tlet $anchor;\n\tif (startEvent.shiftKey && view.state.selection instanceof CellSelection) {\n\t\tsetCellSelection(view.state.selection.$anchorCell, startEvent);\n\t\tstartEvent.preventDefault();\n\t} else if (startEvent.shiftKey && startDOMCell && ($anchor = cellAround(view.state.selection.$anchor)) != null && ((_cellUnderMouse = cellUnderMouse(view, startEvent)) === null || _cellUnderMouse === void 0 ? void 0 : _cellUnderMouse.pos) != $anchor.pos) {\n\t\tsetCellSelection($anchor, startEvent);\n\t\tstartEvent.preventDefault();\n\t} else if (!startDOMCell) return;\n\tfunction setCellSelection($anchor$1, event) {\n\t\tlet $head = cellUnderMouse(view, event);\n\t\tconst starting = tableEditingKey.getState(view.state) == null;\n\t\tif (!$head || !inSameTable($anchor$1, $head)) if (starting) $head = $anchor$1;\n\t\telse return;\n\t\tconst selection = new CellSelection($anchor$1, $head);\n\t\tif (starting || !view.state.selection.eq(selection)) {\n\t\t\tconst tr = view.state.tr.setSelection(selection);\n\t\t\tif (starting) tr.setMeta(tableEditingKey, $anchor$1.pos);\n\t\t\tview.dispatch(tr);\n\t\t}\n\t}\n\tfunction stop() {\n\t\tview.root.removeEventListener(\"mouseup\", stop);\n\t\tview.root.removeEventListener(\"dragstart\", stop);\n\t\tview.root.removeEventListener(\"mousemove\", move);\n\t\tif (tableEditingKey.getState(view.state) != null) view.dispatch(view.state.tr.setMeta(tableEditingKey, -1));\n\t}\n\tfunction move(_event) {\n\t\tconst event = _event;\n\t\tconst anchor = tableEditingKey.getState(view.state);\n\t\tlet $anchor$1;\n\t\tif (anchor != null) $anchor$1 = view.state.doc.resolve(anchor);\n\t\telse if (domInCell(view, event.target) != startDOMCell) {\n\t\t\t$anchor$1 = cellUnderMouse(view, startEvent);\n\t\t\tif (!$anchor$1) return stop();\n\t\t}\n\t\tif ($anchor$1) setCellSelection($anchor$1, event);\n\t}\n\tview.root.addEventListener(\"mouseup\", stop);\n\tview.root.addEventListener(\"dragstart\", stop);\n\tview.root.addEventListener(\"mousemove\", move);\n}\nfunction atEndOfCell(view, axis, dir) {\n\tif (!(view.state.selection instanceof TextSelection)) return null;\n\tconst { $head } = view.state.selection;\n\tfor (let d = $head.depth - 1; d >= 0; d--) {\n\t\tconst parent = $head.node(d);\n\t\tif ((dir < 0 ? $head.index(d) : $head.indexAfter(d)) != (dir < 0 ? 0 : parent.childCount)) return null;\n\t\tif (parent.type.spec.tableRole == \"cell\" || parent.type.spec.tableRole == \"header_cell\") {\n\t\t\tconst cellPos = $head.before(d);\n\t\t\tconst dirStr = axis == \"vert\" ? dir > 0 ? \"down\" : \"up\" : dir > 0 ? \"right\" : \"left\";\n\t\t\treturn view.endOfTextblock(dirStr) ? cellPos : null;\n\t\t}\n\t}\n\treturn null;\n}\nfunction domInCell(view, dom) {\n\tfor (; dom && dom != view.dom; dom = dom.parentNode) if (dom.nodeName == \"TD\" || dom.nodeName == \"TH\") return dom;\n\treturn null;\n}\nfunction cellUnderMouse(view, event) {\n\tconst mousePos = view.posAtCoords({\n\t\tleft: event.clientX,\n\t\ttop: event.clientY\n\t});\n\tif (!mousePos) return null;\n\tlet { inside, pos } = mousePos;\n\treturn inside >= 0 && cellAround(view.state.doc.resolve(inside)) || cellAround(view.state.doc.resolve(pos));\n}\n\n//#endregion\n//#region src/tableview.ts\n/**\n* @public\n*/\nvar TableView = class {\n\tconstructor(node, defaultCellMinWidth) {\n\t\tthis.node = node;\n\t\tthis.defaultCellMinWidth = defaultCellMinWidth;\n\t\tthis.dom = document.createElement(\"div\");\n\t\tthis.dom.className = \"tableWrapper\";\n\t\tthis.table = this.dom.appendChild(document.createElement(\"table\"));\n\t\tthis.table.style.setProperty(\"--default-cell-min-width\", `${defaultCellMinWidth}px`);\n\t\tthis.colgroup = this.table.appendChild(document.createElement(\"colgroup\"));\n\t\tupdateColumnsOnResize(node, this.colgroup, this.table, defaultCellMinWidth);\n\t\tthis.contentDOM = this.table.appendChild(document.createElement(\"tbody\"));\n\t}\n\tupdate(node) {\n\t\tif (node.type != this.node.type) return false;\n\t\tthis.node = node;\n\t\tupdateColumnsOnResize(node, this.colgroup, this.table, this.defaultCellMinWidth);\n\t\treturn true;\n\t}\n\tignoreMutation(record) {\n\t\treturn record.type == \"attributes\" && (record.target == this.table || this.colgroup.contains(record.target));\n\t}\n};\n/**\n* @public\n*/\nfunction updateColumnsOnResize(node, colgroup, table, defaultCellMinWidth, overrideCol, overrideValue) {\n\tlet totalWidth = 0;\n\tlet fixedWidth = true;\n\tlet nextDOM = colgroup.firstChild;\n\tconst row = node.firstChild;\n\tif (!row) return;\n\tfor (let i = 0, col = 0; i < row.childCount; i++) {\n\t\tconst { colspan, colwidth } = row.child(i).attrs;\n\t\tfor (let j = 0; j < colspan; j++, col++) {\n\t\t\tconst hasWidth = overrideCol == col ? overrideValue : colwidth && colwidth[j];\n\t\t\tconst cssWidth = hasWidth ? hasWidth + \"px\" : \"\";\n\t\t\ttotalWidth += hasWidth || defaultCellMinWidth;\n\t\t\tif (!hasWidth) fixedWidth = false;\n\t\t\tif (!nextDOM) {\n\t\t\t\tconst col$1 = document.createElement(\"col\");\n\t\t\t\tcol$1.style.width = cssWidth;\n\t\t\t\tcolgroup.appendChild(col$1);\n\t\t\t} else {\n\t\t\t\tif (nextDOM.style.width != cssWidth) nextDOM.style.width = cssWidth;\n\t\t\t\tnextDOM = nextDOM.nextSibling;\n\t\t\t}\n\t\t}\n\t}\n\twhile (nextDOM) {\n\t\tvar _nextDOM$parentNode;\n\t\tconst after = nextDOM.nextSibling;\n\t\t(_nextDOM$parentNode = nextDOM.parentNode) === null || _nextDOM$parentNode === void 0 || _nextDOM$parentNode.removeChild(nextDOM);\n\t\tnextDOM = after;\n\t}\n\tif (fixedWidth) {\n\t\ttable.style.width = totalWidth + \"px\";\n\t\ttable.style.minWidth = \"\";\n\t} else {\n\t\ttable.style.width = \"\";\n\t\ttable.style.minWidth = totalWidth + \"px\";\n\t}\n}\n\n//#endregion\n//#region src/columnresizing.ts\n/**\n* @public\n*/\nconst columnResizingPluginKey = new PluginKey(\"tableColumnResizing\");\n/**\n* @public\n*/\nfunction columnResizing({ handleWidth = 5, cellMinWidth = 25, defaultCellMinWidth = 100, View = TableView, lastColumnResizable = true } = {}) {\n\tconst plugin = new Plugin({\n\t\tkey: columnResizingPluginKey,\n\t\tstate: {\n\t\t\tinit(_, state) {\n\t\t\t\tvar _plugin$spec;\n\t\t\t\tconst nodeViews = (_plugin$spec = plugin.spec) === null || _plugin$spec === void 0 || (_plugin$spec = _plugin$spec.props) === null || _plugin$spec === void 0 ? void 0 : _plugin$spec.nodeViews;\n\t\t\t\tconst tableName = tableNodeTypes(state.schema).table.name;\n\t\t\t\tif (View && nodeViews) nodeViews[tableName] = (node, view) => {\n\t\t\t\t\treturn new View(node, defaultCellMinWidth, view);\n\t\t\t\t};\n\t\t\t\treturn new ResizeState(-1, false);\n\t\t\t},\n\t\t\tapply(tr, prev) {\n\t\t\t\treturn prev.apply(tr);\n\t\t\t}\n\t\t},\n\t\tprops: {\n\t\t\tattributes: (state) => {\n\t\t\t\tconst pluginState = columnResizingPluginKey.getState(state);\n\t\t\t\treturn pluginState && pluginState.activeHandle > -1 ? { class: \"resize-cursor\" } : {};\n\t\t\t},\n\t\t\thandleDOMEvents: {\n\t\t\t\tmousemove: (view, event) => {\n\t\t\t\t\thandleMouseMove(view, event, handleWidth, lastColumnResizable);\n\t\t\t\t},\n\t\t\t\tmouseleave: (view) => {\n\t\t\t\t\thandleMouseLeave(view);\n\t\t\t\t},\n\t\t\t\tmousedown: (view, event) => {\n\t\t\t\t\thandleMouseDown(view, event, cellMinWidth, defaultCellMinWidth);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdecorations: (state) => {\n\t\t\t\tconst pluginState = columnResizingPluginKey.getState(state);\n\t\t\t\tif (pluginState && pluginState.activeHandle > -1) return handleDecorations(state, pluginState.activeHandle);\n\t\t\t},\n\t\t\tnodeViews: {}\n\t\t}\n\t});\n\treturn plugin;\n}\n/**\n* @public\n*/\nvar ResizeState = class ResizeState {\n\tconstructor(activeHandle, dragging) {\n\t\tthis.activeHandle = activeHandle;\n\t\tthis.dragging = dragging;\n\t}\n\tapply(tr) {\n\t\tconst state = this;\n\t\tconst action = tr.getMeta(columnResizingPluginKey);\n\t\tif (action && action.setHandle != null) return new ResizeState(action.setHandle, false);\n\t\tif (action && action.setDragging !== void 0) return new ResizeState(state.activeHandle, action.setDragging);\n\t\tif (state.activeHandle > -1 && tr.docChanged) {\n\t\t\tlet handle = tr.mapping.map(state.activeHandle, -1);\n\t\t\tif (!pointsAtCell(tr.doc.resolve(handle))) handle = -1;\n\t\t\treturn new ResizeState(handle, state.dragging);\n\t\t}\n\t\treturn state;\n\t}\n};\nfunction handleMouseMove(view, event, handleWidth, lastColumnResizable) {\n\tif (!view.editable) return;\n\tconst pluginState = columnResizingPluginKey.getState(view.state);\n\tif (!pluginState) return;\n\tif (!pluginState.dragging) {\n\t\tconst target = domCellAround(event.target);\n\t\tlet cell = -1;\n\t\tif (target) {\n\t\t\tconst { left, right } = target.getBoundingClientRect();\n\t\t\tif (event.clientX - left <= handleWidth) cell = edgeCell(view, event, \"left\", handleWidth);\n\t\t\telse if (right - event.clientX <= handleWidth) cell = edgeCell(view, event, \"right\", handleWidth);\n\t\t}\n\t\tif (cell != pluginState.activeHandle) {\n\t\t\tif (!lastColumnResizable && cell !== -1) {\n\t\t\t\tconst $cell = view.state.doc.resolve(cell);\n\t\t\t\tconst table = $cell.node(-1);\n\t\t\t\tconst map = TableMap.get(table);\n\t\t\t\tconst tableStart = $cell.start(-1);\n\t\t\t\tif (map.colCount($cell.pos - tableStart) + $cell.nodeAfter.attrs.colspan - 1 == map.width - 1) return;\n\t\t\t}\n\t\t\tupdateHandle(view, cell);\n\t\t}\n\t}\n}\nfunction handleMouseLeave(view) {\n\tif (!view.editable) return;\n\tconst pluginState = columnResizingPluginKey.getState(view.state);\n\tif (pluginState && pluginState.activeHandle > -1 && !pluginState.dragging) updateHandle(view, -1);\n}\nfunction handleMouseDown(view, event, cellMinWidth, defaultCellMinWidth) {\n\tvar _view$dom$ownerDocume;\n\tif (!view.editable) return false;\n\tconst win = (_view$dom$ownerDocume = view.dom.ownerDocument.defaultView) !== null && _view$dom$ownerDocume !== void 0 ? _view$dom$ownerDocume : window;\n\tconst pluginState = columnResizingPluginKey.getState(view.state);\n\tif (!pluginState || pluginState.activeHandle == -1 || pluginState.dragging) return false;\n\tconst cell = view.state.doc.nodeAt(pluginState.activeHandle);\n\tconst width = currentColWidth(view, pluginState.activeHandle, cell.attrs);\n\tview.dispatch(view.state.tr.setMeta(columnResizingPluginKey, { setDragging: {\n\t\tstartX: event.clientX,\n\t\tstartWidth: width\n\t} }));\n\tfunction finish(event$1) {\n\t\twin.removeEventListener(\"mouseup\", finish);\n\t\twin.removeEventListener(\"mousemove\", move);\n\t\tconst pluginState$1 = columnResizingPluginKey.getState(view.state);\n\t\tif (pluginState$1 === null || pluginState$1 === void 0 ? void 0 : pluginState$1.dragging) {\n\t\t\tupdateColumnWidth(view, pluginState$1.activeHandle, draggedWidth(pluginState$1.dragging, event$1, cellMinWidth));\n\t\t\tview.dispatch(view.state.tr.setMeta(columnResizingPluginKey, { setDragging: null }));\n\t\t}\n\t}\n\tfunction move(event$1) {\n\t\tif (!event$1.which) return finish(event$1);\n\t\tconst pluginState$1 = columnResizingPluginKey.getState(view.state);\n\t\tif (!pluginState$1) return;\n\t\tif (pluginState$1.dragging) {\n\t\t\tconst dragged = draggedWidth(pluginState$1.dragging, event$1, cellMinWidth);\n\t\t\tdisplayColumnWidth(view, pluginState$1.activeHandle, dragged, defaultCellMinWidth);\n\t\t}\n\t}\n\tdisplayColumnWidth(view, pluginState.activeHandle, width, defaultCellMinWidth);\n\twin.addEventListener(\"mouseup\", finish);\n\twin.addEventListener(\"mousemove\", move);\n\tevent.preventDefault();\n\treturn true;\n}\nfunction currentColWidth(view, cellPos, { colspan, colwidth }) {\n\tconst width = colwidth && colwidth[colwidth.length - 1];\n\tif (width) return width;\n\tconst dom = view.domAtPos(cellPos);\n\tlet domWidth = dom.node.childNodes[dom.offset].offsetWidth, parts = colspan;\n\tif (colwidth) {\n\t\tfor (let i = 0; i < colspan; i++) if (colwidth[i]) {\n\t\t\tdomWidth -= colwidth[i];\n\t\t\tparts--;\n\t\t}\n\t}\n\treturn domWidth / parts;\n}\nfunction domCellAround(target) {\n\twhile (target && target.nodeName != \"TD\" && target.nodeName != \"TH\") target = target.classList && target.classList.contains(\"ProseMirror\") ? null : target.parentNode;\n\treturn target;\n}\nfunction edgeCell(view, event, side, handleWidth) {\n\tconst offset = side == \"right\" ? -handleWidth : handleWidth;\n\tconst found = view.posAtCoords({\n\t\tleft: event.clientX + offset,\n\t\ttop: event.clientY\n\t});\n\tif (!found) return -1;\n\tconst { pos } = found;\n\tconst $cell = cellAround(view.state.doc.resolve(pos));\n\tif (!$cell) return -1;\n\tif (side == \"right\") return $cell.pos;\n\tconst map = TableMap.get($cell.node(-1)), start = $cell.start(-1);\n\tconst index = map.map.indexOf($cell.pos - start);\n\treturn index % map.width == 0 ? -1 : start + map.map[index - 1];\n}\nfunction draggedWidth(dragging, event, resizeMinWidth) {\n\tconst offset = event.clientX - dragging.startX;\n\treturn Math.max(resizeMinWidth, dragging.startWidth + offset);\n}\nfunction updateHandle(view, value) {\n\tview.dispatch(view.state.tr.setMeta(columnResizingPluginKey, { setHandle: value }));\n}\nfunction updateColumnWidth(view, cell, width) {\n\tconst $cell = view.state.doc.resolve(cell);\n\tconst table = $cell.node(-1), map = TableMap.get(table), start = $cell.start(-1);\n\tconst col = map.colCount($cell.pos - start) + $cell.nodeAfter.attrs.colspan - 1;\n\tconst tr = view.state.tr;\n\tfor (let row = 0; row < map.height; row++) {\n\t\tconst mapIndex = row * map.width + col;\n\t\tif (row && map.map[mapIndex] == map.map[mapIndex - map.width]) continue;\n\t\tconst pos = map.map[mapIndex];\n\t\tconst attrs = table.nodeAt(pos).attrs;\n\t\tconst index = attrs.colspan == 1 ? 0 : col - map.colCount(pos);\n\t\tif (attrs.colwidth && attrs.colwidth[index] == width) continue;\n\t\tconst colwidth = attrs.colwidth ? attrs.colwidth.slice() : zeroes(attrs.colspan);\n\t\tcolwidth[index] = width;\n\t\ttr.setNodeMarkup(start + pos, null, {\n\t\t\t...attrs,\n\t\t\tcolwidth\n\t\t});\n\t}\n\tif (tr.docChanged) view.dispatch(tr);\n}\nfunction displayColumnWidth(view, cell, width, defaultCellMinWidth) {\n\tconst $cell = view.state.doc.resolve(cell);\n\tconst table = $cell.node(-1), start = $cell.start(-1);\n\tconst col = TableMap.get(table).colCount($cell.pos - start) + $cell.nodeAfter.attrs.colspan - 1;\n\tlet dom = view.domAtPos($cell.start(-1)).node;\n\twhile (dom && dom.nodeName != \"TABLE\") dom = dom.parentNode;\n\tif (!dom) return;\n\tupdateColumnsOnResize(table, dom.firstChild, dom, defaultCellMinWidth, col, width);\n}\nfunction zeroes(n) {\n\treturn Array(n).fill(0);\n}\nfunction handleDecorations(state, cell) {\n\tconst decorations = [];\n\tconst $cell = state.doc.resolve(cell);\n\tconst table = $cell.node(-1);\n\tif (!table) return DecorationSet.empty;\n\tconst map = TableMap.get(table);\n\tconst start = $cell.start(-1);\n\tconst col = map.colCount($cell.pos - start) + $cell.nodeAfter.attrs.colspan - 1;\n\tfor (let row = 0; row < map.height; row++) {\n\t\tconst index = col + row * map.width;\n\t\tif ((col == map.width - 1 || map.map[index] != map.map[index + 1]) && (row == 0 || map.map[index] != map.map[index - map.width])) {\n\t\t\tvar _columnResizingPlugin;\n\t\t\tconst cellPos = map.map[index];\n\t\t\tconst pos = start + cellPos + table.nodeAt(cellPos).nodeSize - 1;\n\t\t\tconst dom = document.createElement(\"div\");\n\t\t\tdom.className = \"column-resize-handle\";\n\t\t\tif ((_columnResizingPlugin = columnResizingPluginKey.getState(state)) === null || _columnResizingPlugin === void 0 ? void 0 : _columnResizingPlugin.dragging) decorations.push(Decoration.node(start + cellPos, start + cellPos + table.nodeAt(cellPos).nodeSize, { class: \"column-resize-dragging\" }));\n\t\t\tdecorations.push(Decoration.widget(pos, dom));\n\t\t}\n\t}\n\treturn DecorationSet.create(state.doc, decorations);\n}\n\n//#endregion\n//#region src/index.ts\n/**\n* Creates a [plugin](http://prosemirror.net/docs/ref/#state.Plugin)\n* that, when added to an editor, enables cell-selection, handles\n* cell-based copy/paste, and makes sure tables stay well-formed (each\n* row has the same width, and cells don't overlap).\n*\n* You should probably put this plugin near the end of your array of\n* plugins, since it handles mouse and arrow key events in tables\n* rather broadly, and other plugins, like the gap cursor or the\n* column-width dragging plugin, might want to get a turn first to\n* perform more specific behavior.\n*\n* @public\n*/\nfunction tableEditing({ allowTableNodeSelection = false } = {}) {\n\treturn new Plugin({\n\t\tkey: tableEditingKey,\n\t\tstate: {\n\t\t\tinit() {\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tapply(tr, cur) {\n\t\t\t\tconst set = tr.getMeta(tableEditingKey);\n\t\t\t\tif (set != null) return set == -1 ? null : set;\n\t\t\t\tif (cur == null || !tr.docChanged) return cur;\n\t\t\t\tconst { deleted, pos } = tr.mapping.mapResult(cur);\n\t\t\t\treturn deleted ? null : pos;\n\t\t\t}\n\t\t},\n\t\tprops: {\n\t\t\tdecorations: drawCellSelection,\n\t\t\thandleDOMEvents: { mousedown: handleMouseDown$1 },\n\t\t\tcreateSelectionBetween(view) {\n\t\t\t\treturn tableEditingKey.getState(view.state) != null ? view.state.selection : null;\n\t\t\t},\n\t\t\thandleTripleClick,\n\t\t\thandleKeyDown,\n\t\t\thandlePaste\n\t\t},\n\t\tappendTransaction(_, oldState, state) {\n\t\t\treturn normalizeSelection(state, fixTables(state, oldState), allowTableNodeSelection);\n\t\t}\n\t});\n}\n\n//#endregion\nexport { CellBookmark, CellSelection, ResizeState, TableMap, TableView, clipCells as __clipCells, insertCells as __insertCells, pastedCells as __pastedCells, addColSpan, addColumn, addColumnAfter, addColumnBefore, addRow, addRowAfter, addRowBefore, cellAround, cellNear, colCount, columnIsHeader, columnResizing, columnResizingPluginKey, deleteCellSelection, deleteColumn, deleteRow, deleteTable, findCell, findCellPos, findCellRange, findTable, fixTables, fixTablesKey, goToNextCell, handlePaste, inSameTable, isInTable, mergeCells, moveCellForward, moveTableColumn, moveTableRow, nextCell, pointsAtCell, removeColSpan, removeColumn, removeRow, rowIsHeader, selectedRect, selectionCell, setCellAttr, splitCell, splitCellWithType, tableEditing, tableEditingKey, tableNodeTypes, tableNodes, toggleHeader, toggleHeaderCell, toggleHeaderColumn, toggleHeaderRow, updateColumnsOnResize };\n//# sourceMappingURL=index.js.map","// src/cell/table-cell.ts\nimport { mergeAttributes, Node } from \"@tiptap/core\";\nvar TableCell = Node.create({\n  name: \"tableCell\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  content: \"block+\",\n  addAttributes() {\n    return {\n      colspan: {\n        default: 1\n      },\n      rowspan: {\n        default: 1\n      },\n      colwidth: {\n        default: null,\n        parseHTML: (element) => {\n          var _a, _b;\n          const colwidth = element.getAttribute(\"colwidth\");\n          const value = colwidth ? colwidth.split(\",\").map((width) => parseInt(width, 10)) : null;\n          if (!value) {\n            const cols = (_a = element.closest(\"table\")) == null ? void 0 : _a.querySelectorAll(\"colgroup > col\");\n            const cellIndex = Array.from(((_b = element.parentElement) == null ? void 0 : _b.children) || []).indexOf(element);\n            if (cellIndex && cellIndex > -1 && cols && cols[cellIndex]) {\n              const colWidth = cols[cellIndex].getAttribute(\"width\");\n              return colWidth ? [parseInt(colWidth, 10)] : null;\n            }\n          }\n          return value;\n        }\n      }\n    };\n  },\n  tableRole: \"cell\",\n  isolating: true,\n  parseHTML() {\n    return [{ tag: \"td\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"td\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes), 0];\n  }\n});\n\n// src/header/table-header.ts\nimport { mergeAttributes as mergeAttributes2, Node as Node2 } from \"@tiptap/core\";\nvar TableHeader = Node2.create({\n  name: \"tableHeader\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  content: \"block+\",\n  addAttributes() {\n    return {\n      colspan: {\n        default: 1\n      },\n      rowspan: {\n        default: 1\n      },\n      colwidth: {\n        default: null,\n        parseHTML: (element) => {\n          const colwidth = element.getAttribute(\"colwidth\");\n          const value = colwidth ? colwidth.split(\",\").map((width) => parseInt(width, 10)) : null;\n          return value;\n        }\n      }\n    };\n  },\n  tableRole: \"header_cell\",\n  isolating: true,\n  parseHTML() {\n    return [{ tag: \"th\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"th\", mergeAttributes2(this.options.HTMLAttributes, HTMLAttributes), 0];\n  }\n});\n\n// src/kit/index.ts\nimport { Extension } from \"@tiptap/core\";\n\n// src/row/table-row.ts\nimport { mergeAttributes as mergeAttributes3, Node as Node3 } from \"@tiptap/core\";\nvar TableRow = Node3.create({\n  name: \"tableRow\",\n  addOptions() {\n    return {\n      HTMLAttributes: {}\n    };\n  },\n  content: \"(tableCell | tableHeader)*\",\n  tableRole: \"row\",\n  parseHTML() {\n    return [{ tag: \"tr\" }];\n  },\n  renderHTML({ HTMLAttributes }) {\n    return [\"tr\", mergeAttributes3(this.options.HTMLAttributes, HTMLAttributes), 0];\n  }\n});\n\n// src/table/table.ts\nimport {\n  callOrReturn,\n  getExtensionField,\n  mergeAttributes as mergeAttributes4,\n  Node as Node4\n} from \"@tiptap/core\";\nimport { TextSelection } from \"@tiptap/pm/state\";\nimport {\n  addColumnAfter,\n  addColumnBefore,\n  addRowAfter,\n  addRowBefore,\n  CellSelection as CellSelection2,\n  columnResizing,\n  deleteColumn,\n  deleteRow,\n  deleteTable,\n  fixTables,\n  goToNextCell,\n  mergeCells,\n  setCellAttr,\n  splitCell,\n  tableEditing,\n  toggleHeader,\n  toggleHeaderCell\n} from \"@tiptap/pm/tables\";\n\n// src/table/utilities/colStyle.ts\nfunction getColStyleDeclaration(minWidth, width) {\n  if (width) {\n    return [\"width\", `${Math.max(width, minWidth)}px`];\n  }\n  return [\"min-width\", `${minWidth}px`];\n}\n\n// src/table/TableView.ts\nfunction updateColumns(node, colgroup, table, cellMinWidth, overrideCol, overrideValue) {\n  var _a;\n  let totalWidth = 0;\n  let fixedWidth = true;\n  let nextDOM = colgroup.firstChild;\n  const row = node.firstChild;\n  if (row !== null) {\n    for (let i = 0, col = 0; i < row.childCount; i += 1) {\n      const { colspan, colwidth } = row.child(i).attrs;\n      for (let j = 0; j < colspan; j += 1, col += 1) {\n        const hasWidth = overrideCol === col ? overrideValue : colwidth && colwidth[j];\n        const cssWidth = hasWidth ? `${hasWidth}px` : \"\";\n        totalWidth += hasWidth || cellMinWidth;\n        if (!hasWidth) {\n          fixedWidth = false;\n        }\n        if (!nextDOM) {\n          const colElement = document.createElement(\"col\");\n          const [propertyKey, propertyValue] = getColStyleDeclaration(cellMinWidth, hasWidth);\n          colElement.style.setProperty(propertyKey, propertyValue);\n          colgroup.appendChild(colElement);\n        } else {\n          if (nextDOM.style.width !== cssWidth) {\n            const [propertyKey, propertyValue] = getColStyleDeclaration(cellMinWidth, hasWidth);\n            nextDOM.style.setProperty(propertyKey, propertyValue);\n          }\n          nextDOM = nextDOM.nextSibling;\n        }\n      }\n    }\n  }\n  while (nextDOM) {\n    const after = nextDOM.nextSibling;\n    (_a = nextDOM.parentNode) == null ? void 0 : _a.removeChild(nextDOM);\n    nextDOM = after;\n  }\n  const hasUserWidth = node.attrs.style && typeof node.attrs.style === \"string\" && /\\bwidth\\s*:/i.test(node.attrs.style);\n  if (fixedWidth && !hasUserWidth) {\n    table.style.width = `${totalWidth}px`;\n    table.style.minWidth = \"\";\n  } else {\n    table.style.width = \"\";\n    table.style.minWidth = `${totalWidth}px`;\n  }\n}\nvar TableView = class {\n  constructor(node, cellMinWidth) {\n    this.node = node;\n    this.cellMinWidth = cellMinWidth;\n    this.dom = document.createElement(\"div\");\n    this.dom.className = \"tableWrapper\";\n    this.table = this.dom.appendChild(document.createElement(\"table\"));\n    if (node.attrs.style) {\n      this.table.style.cssText = node.attrs.style;\n    }\n    this.colgroup = this.table.appendChild(document.createElement(\"colgroup\"));\n    updateColumns(node, this.colgroup, this.table, cellMinWidth);\n    this.contentDOM = this.table.appendChild(document.createElement(\"tbody\"));\n  }\n  update(node) {\n    if (node.type !== this.node.type) {\n      return false;\n    }\n    this.node = node;\n    updateColumns(node, this.colgroup, this.table, this.cellMinWidth);\n    return true;\n  }\n  ignoreMutation(mutation) {\n    const target = mutation.target;\n    const isInsideWrapper = this.dom.contains(target);\n    const isInsideContent = this.contentDOM.contains(target);\n    if (isInsideWrapper && !isInsideContent) {\n      if (mutation.type === \"attributes\" || mutation.type === \"childList\" || mutation.type === \"characterData\") {\n        return true;\n      }\n    }\n    return false;\n  }\n};\n\n// src/table/utilities/createColGroup.ts\nfunction createColGroup(node, cellMinWidth, overrideCol, overrideValue) {\n  let totalWidth = 0;\n  let fixedWidth = true;\n  const cols = [];\n  const row = node.firstChild;\n  if (!row) {\n    return {};\n  }\n  for (let i = 0, col = 0; i < row.childCount; i += 1) {\n    const { colspan, colwidth } = row.child(i).attrs;\n    for (let j = 0; j < colspan; j += 1, col += 1) {\n      const hasWidth = overrideCol === col ? overrideValue : colwidth && colwidth[j];\n      totalWidth += hasWidth || cellMinWidth;\n      if (!hasWidth) {\n        fixedWidth = false;\n      }\n      const [property, value] = getColStyleDeclaration(cellMinWidth, hasWidth);\n      cols.push([\"col\", { style: `${property}: ${value}` }]);\n    }\n  }\n  const tableWidth = fixedWidth ? `${totalWidth}px` : \"\";\n  const tableMinWidth = fixedWidth ? \"\" : `${totalWidth}px`;\n  const colgroup = [\"colgroup\", {}, ...cols];\n  return { colgroup, tableWidth, tableMinWidth };\n}\n\n// src/table/utilities/createCell.ts\nfunction createCell(cellType, cellContent) {\n  if (cellContent) {\n    return cellType.createChecked(null, cellContent);\n  }\n  return cellType.createAndFill();\n}\n\n// src/table/utilities/getTableNodeTypes.ts\nfunction getTableNodeTypes(schema) {\n  if (schema.cached.tableNodeTypes) {\n    return schema.cached.tableNodeTypes;\n  }\n  const roles = {};\n  Object.keys(schema.nodes).forEach((type) => {\n    const nodeType = schema.nodes[type];\n    if (nodeType.spec.tableRole) {\n      roles[nodeType.spec.tableRole] = nodeType;\n    }\n  });\n  schema.cached.tableNodeTypes = roles;\n  return roles;\n}\n\n// src/table/utilities/createTable.ts\nfunction createTable(schema, rowsCount, colsCount, withHeaderRow, cellContent) {\n  const types = getTableNodeTypes(schema);\n  const headerCells = [];\n  const cells = [];\n  for (let index = 0; index < colsCount; index += 1) {\n    const cell = createCell(types.cell, cellContent);\n    if (cell) {\n      cells.push(cell);\n    }\n    if (withHeaderRow) {\n      const headerCell = createCell(types.header_cell, cellContent);\n      if (headerCell) {\n        headerCells.push(headerCell);\n      }\n    }\n  }\n  const rows = [];\n  for (let index = 0; index < rowsCount; index += 1) {\n    rows.push(types.row.createChecked(null, withHeaderRow && index === 0 ? headerCells : cells));\n  }\n  return types.table.createChecked(null, rows);\n}\n\n// src/table/utilities/deleteTableWhenAllCellsSelected.ts\nimport { findParentNodeClosestToPos } from \"@tiptap/core\";\n\n// src/table/utilities/isCellSelection.ts\nimport { CellSelection } from \"@tiptap/pm/tables\";\nfunction isCellSelection(value) {\n  return value instanceof CellSelection;\n}\n\n// src/table/utilities/deleteTableWhenAllCellsSelected.ts\nvar deleteTableWhenAllCellsSelected = ({ editor }) => {\n  const { selection } = editor.state;\n  if (!isCellSelection(selection)) {\n    return false;\n  }\n  let cellCount = 0;\n  const table = findParentNodeClosestToPos(selection.ranges[0].$from, (node) => {\n    return node.type.name === \"table\";\n  });\n  table == null ? void 0 : table.node.descendants((node) => {\n    if (node.type.name === \"table\") {\n      return false;\n    }\n    if ([\"tableCell\", \"tableHeader\"].includes(node.type.name)) {\n      cellCount += 1;\n    }\n  });\n  const allCellsSelected = cellCount === selection.ranges.length;\n  if (!allCellsSelected) {\n    return false;\n  }\n  editor.commands.deleteTable();\n  return true;\n};\n\n// src/table/utilities/markdown.ts\nvar DEFAULT_CELL_LINE_SEPARATOR = \"\u001f\";\nfunction collapseWhitespace(s) {\n  return (s || \"\").replace(/\\s+/g, \" \").trim();\n}\nfunction renderTableToMarkdown(node, h, options = {}) {\n  var _a;\n  const cellSep = (_a = options.cellLineSeparator) != null ? _a : DEFAULT_CELL_LINE_SEPARATOR;\n  if (!node || !node.content || node.content.length === 0) {\n    return \"\";\n  }\n  const rows = [];\n  node.content.forEach((rowNode) => {\n    const cells = [];\n    if (rowNode.content) {\n      rowNode.content.forEach((cellNode) => {\n        let raw = \"\";\n        if (cellNode.content && Array.isArray(cellNode.content) && cellNode.content.length > 1) {\n          const parts = cellNode.content.map((child) => h.renderChildren(child));\n          raw = parts.join(cellSep);\n        } else {\n          raw = cellNode.content ? h.renderChildren(cellNode.content) : \"\";\n        }\n        const text = collapseWhitespace(raw);\n        const isHeader = cellNode.type === \"tableHeader\";\n        cells.push({ text, isHeader });\n      });\n    }\n    rows.push(cells);\n  });\n  const columnCount = rows.reduce((max, r) => Math.max(max, r.length), 0);\n  if (columnCount === 0) {\n    return \"\";\n  }\n  const colWidths = new Array(columnCount).fill(0);\n  rows.forEach((r) => {\n    var _a2;\n    for (let i = 0; i < columnCount; i += 1) {\n      const cell = ((_a2 = r[i]) == null ? void 0 : _a2.text) || \"\";\n      const len = cell.length;\n      if (len > colWidths[i]) {\n        colWidths[i] = len;\n      }\n      if (colWidths[i] < 3) {\n        colWidths[i] = 3;\n      }\n    }\n  });\n  const pad = (s, width) => s + \" \".repeat(Math.max(0, width - s.length));\n  const headerRow = rows[0];\n  const hasHeader = headerRow.some((c) => c.isHeader);\n  let out = \"\\n\";\n  const headerTexts = new Array(columnCount).fill(0).map((_, i) => hasHeader ? headerRow[i] && headerRow[i].text || \"\" : \"\");\n  out += `| ${headerTexts.map((t, i) => pad(t, colWidths[i])).join(\" | \")} |\n`;\n  out += `| ${colWidths.map((w) => \"-\".repeat(Math.max(3, w))).join(\" | \")} |\n`;\n  const body = hasHeader ? rows.slice(1) : rows;\n  body.forEach((r) => {\n    out += `| ${new Array(columnCount).fill(0).map((_, i) => pad(r[i] && r[i].text || \"\", colWidths[i])).join(\" | \")} |\n`;\n  });\n  return out;\n}\nvar markdown_default = renderTableToMarkdown;\n\n// src/table/table.ts\nvar Table = Node4.create({\n  name: \"table\",\n  // @ts-ignore\n  addOptions() {\n    return {\n      HTMLAttributes: {},\n      resizable: false,\n      renderWrapper: false,\n      handleWidth: 5,\n      cellMinWidth: 25,\n      // TODO: fix\n      View: TableView,\n      lastColumnResizable: true,\n      allowTableNodeSelection: false\n    };\n  },\n  content: \"tableRow+\",\n  tableRole: \"table\",\n  isolating: true,\n  group: \"block\",\n  parseHTML() {\n    return [{ tag: \"table\" }];\n  },\n  renderHTML({ node, HTMLAttributes }) {\n    const { colgroup, tableWidth, tableMinWidth } = createColGroup(node, this.options.cellMinWidth);\n    const userStyles = HTMLAttributes.style;\n    function getTableStyle() {\n      if (userStyles) {\n        return userStyles;\n      }\n      return tableWidth ? `width: ${tableWidth}` : `min-width: ${tableMinWidth}`;\n    }\n    const table = [\n      \"table\",\n      mergeAttributes4(this.options.HTMLAttributes, HTMLAttributes, {\n        style: getTableStyle()\n      }),\n      colgroup,\n      [\"tbody\", 0]\n    ];\n    return this.options.renderWrapper ? [\"div\", { class: \"tableWrapper\" }, table] : table;\n  },\n  parseMarkdown: (token, h) => {\n    const rows = [];\n    if (token.header) {\n      const headerCells = [];\n      token.header.forEach((cell) => {\n        headerCells.push(h.createNode(\"tableHeader\", {}, [{ type: \"paragraph\", content: h.parseInline(cell.tokens) }]));\n      });\n      rows.push(h.createNode(\"tableRow\", {}, headerCells));\n    }\n    if (token.rows) {\n      token.rows.forEach((row) => {\n        const bodyCells = [];\n        row.forEach((cell) => {\n          bodyCells.push(h.createNode(\"tableCell\", {}, [{ type: \"paragraph\", content: h.parseInline(cell.tokens) }]));\n        });\n        rows.push(h.createNode(\"tableRow\", {}, bodyCells));\n      });\n    }\n    return h.createNode(\"table\", void 0, rows);\n  },\n  renderMarkdown: (node, h) => {\n    return markdown_default(node, h);\n  },\n  addCommands() {\n    return {\n      insertTable: ({ rows = 3, cols = 3, withHeaderRow = true } = {}) => ({ tr, dispatch, editor }) => {\n        const node = createTable(editor.schema, rows, cols, withHeaderRow);\n        if (dispatch) {\n          const offset = tr.selection.from + 1;\n          tr.replaceSelectionWith(node).scrollIntoView().setSelection(TextSelection.near(tr.doc.resolve(offset)));\n        }\n        return true;\n      },\n      addColumnBefore: () => ({ state, dispatch }) => {\n        return addColumnBefore(state, dispatch);\n      },\n      addColumnAfter: () => ({ state, dispatch }) => {\n        return addColumnAfter(state, dispatch);\n      },\n      deleteColumn: () => ({ state, dispatch }) => {\n        return deleteColumn(state, dispatch);\n      },\n      addRowBefore: () => ({ state, dispatch }) => {\n        return addRowBefore(state, dispatch);\n      },\n      addRowAfter: () => ({ state, dispatch }) => {\n        return addRowAfter(state, dispatch);\n      },\n      deleteRow: () => ({ state, dispatch }) => {\n        return deleteRow(state, dispatch);\n      },\n      deleteTable: () => ({ state, dispatch }) => {\n        return deleteTable(state, dispatch);\n      },\n      mergeCells: () => ({ state, dispatch }) => {\n        return mergeCells(state, dispatch);\n      },\n      splitCell: () => ({ state, dispatch }) => {\n        return splitCell(state, dispatch);\n      },\n      toggleHeaderColumn: () => ({ state, dispatch }) => {\n        return toggleHeader(\"column\")(state, dispatch);\n      },\n      toggleHeaderRow: () => ({ state, dispatch }) => {\n        return toggleHeader(\"row\")(state, dispatch);\n      },\n      toggleHeaderCell: () => ({ state, dispatch }) => {\n        return toggleHeaderCell(state, dispatch);\n      },\n      mergeOrSplit: () => ({ state, dispatch }) => {\n        if (mergeCells(state, dispatch)) {\n          return true;\n        }\n        return splitCell(state, dispatch);\n      },\n      setCellAttribute: (name, value) => ({ state, dispatch }) => {\n        return setCellAttr(name, value)(state, dispatch);\n      },\n      goToNextCell: () => ({ state, dispatch }) => {\n        return goToNextCell(1)(state, dispatch);\n      },\n      goToPreviousCell: () => ({ state, dispatch }) => {\n        return goToNextCell(-1)(state, dispatch);\n      },\n      fixTables: () => ({ state, dispatch }) => {\n        if (dispatch) {\n          fixTables(state);\n        }\n        return true;\n      },\n      setCellSelection: (position) => ({ tr, dispatch }) => {\n        if (dispatch) {\n          const selection = CellSelection2.create(tr.doc, position.anchorCell, position.headCell);\n          tr.setSelection(selection);\n        }\n        return true;\n      }\n    };\n  },\n  addKeyboardShortcuts() {\n    return {\n      Tab: () => {\n        if (this.editor.commands.goToNextCell()) {\n          return true;\n        }\n        if (!this.editor.can().addRowAfter()) {\n          return false;\n        }\n        return this.editor.chain().addRowAfter().goToNextCell().run();\n      },\n      \"Shift-Tab\": () => this.editor.commands.goToPreviousCell(),\n      Backspace: deleteTableWhenAllCellsSelected,\n      \"Mod-Backspace\": deleteTableWhenAllCellsSelected,\n      Delete: deleteTableWhenAllCellsSelected,\n      \"Mod-Delete\": deleteTableWhenAllCellsSelected\n    };\n  },\n  addProseMirrorPlugins() {\n    const isResizable = this.options.resizable && this.editor.isEditable;\n    return [\n      ...isResizable ? [\n        columnResizing({\n          handleWidth: this.options.handleWidth,\n          cellMinWidth: this.options.cellMinWidth,\n          defaultCellMinWidth: this.options.cellMinWidth,\n          View: this.options.View,\n          lastColumnResizable: this.options.lastColumnResizable\n        })\n      ] : [],\n      tableEditing({\n        allowTableNodeSelection: this.options.allowTableNodeSelection\n      })\n    ];\n  },\n  extendNodeSchema(extension) {\n    const context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    return {\n      tableRole: callOrReturn(getExtensionField(extension, \"tableRole\", context))\n    };\n  }\n});\n\n// src/kit/index.ts\nvar TableKit = Extension.create({\n  name: \"tableKit\",\n  addExtensions() {\n    const extensions = [];\n    if (this.options.table !== false) {\n      extensions.push(Table.configure(this.options.table));\n    }\n    if (this.options.tableCell !== false) {\n      extensions.push(TableCell.configure(this.options.tableCell));\n    }\n    if (this.options.tableHeader !== false) {\n      extensions.push(TableHeader.configure(this.options.tableHeader));\n    }\n    if (this.options.tableRow !== false) {\n      extensions.push(TableRow.configure(this.options.tableRow));\n    }\n    return extensions;\n  }\n});\nexport {\n  DEFAULT_CELL_LINE_SEPARATOR,\n  Table,\n  TableCell,\n  TableHeader,\n  TableKit,\n  TableRow,\n  TableView,\n  createColGroup,\n  createTable,\n  renderTableToMarkdown,\n  updateColumns\n};\n//# sourceMappingURL=index.js.map","/**\r\n * TipTap custom inline node for {{variable}} placeholders.\r\n * Renders as an orange chip. Typing {{name}} auto-converts.\r\n */\r\nimport { Node, mergeAttributes, InputRule } from '@tiptap/core'\r\n\r\nexport const Variable = Node.create({\r\n  name: 'variable',\r\n  group: 'inline',\r\n  inline: true,\r\n  atom: true,\r\n  selectable: true,\r\n  draggable: false,\r\n\r\n  addAttributes() {\r\n    return {\r\n      name: { default: '' },\r\n    }\r\n  },\r\n\r\n  parseHTML() {\r\n    return [\r\n      {\r\n        tag: 'span[data-variable]',\r\n        getAttrs: (el) => ({ name: el.getAttribute('data-variable') }),\r\n      },\r\n    ]\r\n  },\r\n\r\n  renderHTML({ node, HTMLAttributes }) {\r\n    return [\r\n      'span',\r\n      mergeAttributes(HTMLAttributes, {\r\n        'data-variable': node.attrs.name,\r\n        class: 'variable-chip',\r\n        contenteditable: 'false',\r\n      }),\r\n      `{{${node.attrs.name}}}`,\r\n    ]\r\n  },\r\n\r\n  addNodeView() {\r\n    return ({ node }) => {\r\n      const dom = document.createElement('span')\r\n      dom.className = 'variable-chip'\r\n      dom.setAttribute('data-variable', node.attrs.name)\r\n      dom.setAttribute('contenteditable', 'false')\r\n      dom.textContent = `{{${node.attrs.name}}}`\r\n      return { dom }\r\n    }\r\n  },\r\n\r\n  addInputRules() {\r\n    return [\r\n      new InputRule({\r\n        find: /\\{\\{([a-zA-Z0-9_]+)\\}\\}(\\s?)$/,\r\n        handler: ({ state, range, match }) => {\r\n          const name = match[1]\r\n          if (!name) return null\r\n          const { tr } = state\r\n          tr.replaceWith(range.from, range.to, this.type.create({ name }))\r\n          return tr\r\n        },\r\n      }),\r\n    ]\r\n  },\r\n\r\n  addCommands() {\r\n    return {\r\n      insertVariable:\r\n        (name) =>\r\n        ({ chain }) =>\r\n          chain().insertContent({ type: this.name, attrs: { name } }).run(),\r\n    }\r\n  },\r\n})\r\n","/**\r\n * TipTap font-size extension built on top of TextStyle.\r\n */\r\nimport { Extension } from '@tiptap/core'\r\n\r\nexport const FontSize = Extension.create({\r\n  name: 'fontSize',\r\n\r\n  addGlobalAttributes() {\r\n    return [\r\n      {\r\n        types: ['textStyle'],\r\n        attributes: {\r\n          fontSize: {\r\n            default: null,\r\n            parseHTML: (el) => el.style.fontSize?.replace('pt', '') || null,\r\n            renderHTML: (attrs) => {\r\n              if (!attrs.fontSize) return {}\r\n              return { style: `font-size: ${attrs.fontSize}pt` }\r\n            },\r\n          },\r\n        },\r\n      },\r\n    ]\r\n  },\r\n\r\n  addCommands() {\r\n    return {\r\n      setFontSize:\r\n        (size) =>\r\n        ({ chain }) =>\r\n          chain().setMark('textStyle', { fontSize: String(size) }).run(),\r\n\r\n      unsetFontSize:\r\n        () =>\r\n        ({ chain }) =>\r\n          chain().setMark('textStyle', { fontSize: null }).removeEmptyTextStyle().run(),\r\n    }\r\n  },\r\n})\r\n","<template>\r\n  <div class=\"toolbar bg-white border-b border-gray-200 px-3 py-1.5 flex items-center flex-wrap gap-1 select-none\">\r\n\r\n    <!-- Undo / Redo -->\r\n    <div class=\"toolbar-group\">\r\n      <ToolBtn title=\"Undo (Ctrl+Z)\" :disabled=\"!editor.can().undo()\" @click=\"editor.chain().focus().undo().run()\">\r\n        <Undo class=\"w-4 h-4\" />\r\n      </ToolBtn>\r\n      <ToolBtn title=\"Redo (Ctrl+Y)\" :disabled=\"!editor.can().redo()\" @click=\"editor.chain().focus().redo().run()\">\r\n        <Redo class=\"w-4 h-4\" />\r\n      </ToolBtn>\r\n    </div>\r\n\r\n    <div class=\"toolbar-sep\" />\r\n\r\n    <!-- Heading / Paragraph -->\r\n    <select\r\n      :value=\"currentHeading\"\r\n      @change=\"setHeading($event.target.value)\"\r\n      class=\"toolbar-select w-28\"\r\n      title=\"Paragraph style\"\r\n    >\r\n      <option value=\"paragraph\">Normal</option>\r\n      <option value=\"1\">Heading 1</option>\r\n      <option value=\"2\">Heading 2</option>\r\n      <option value=\"3\">Heading 3</option>\r\n    </select>\r\n\r\n    <div class=\"toolbar-sep\" />\r\n\r\n    <!-- Font family -->\r\n    <select\r\n      :value=\"currentFont\"\r\n      @change=\"editor.chain().focus().setFontFamily($event.target.value).run()\"\r\n      class=\"toolbar-select w-32\"\r\n      title=\"Font family\"\r\n    >\r\n      <option v-for=\"f in fonts\" :key=\"f.value\" :value=\"f.value\">{{ f.label }}</option>\r\n    </select>\r\n\r\n    <!-- Font size -->\r\n    <select\r\n      :value=\"currentFontSize\"\r\n      @change=\"editor.chain().focus().setFontSize($event.target.value).run()\"\r\n      class=\"toolbar-select w-14\"\r\n      title=\"Font size\"\r\n    >\r\n      <option v-for=\"s in fontSizes\" :key=\"s\" :value=\"s\">{{ s }}</option>\r\n    </select>\r\n\r\n    <div class=\"toolbar-sep\" />\r\n\r\n    <!-- Bold / Italic / Underline / Strike -->\r\n    <ToolBtn title=\"Bold (Ctrl+B)\" :active=\"editor.isActive('bold')\" @click=\"editor.chain().focus().toggleBold().run()\">\r\n      <Bold class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n    <ToolBtn title=\"Italic (Ctrl+I)\" :active=\"editor.isActive('italic')\" @click=\"editor.chain().focus().toggleItalic().run()\">\r\n      <Italic class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n    <ToolBtn title=\"Underline (Ctrl+U)\" :active=\"editor.isActive('underline')\" @click=\"editor.chain().focus().toggleUnderline().run()\">\r\n      <UnderlineIcon class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n    <ToolBtn title=\"Strikethrough\" :active=\"editor.isActive('strike')\" @click=\"editor.chain().focus().toggleStrike().run()\">\r\n      <Strikethrough class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n\r\n    <div class=\"toolbar-sep\" />\r\n\r\n    <!-- Text color -->\r\n    <div class=\"relative\" title=\"Text color\">\r\n      <ToolBtn class=\"relative\" @click=\"showColorPicker = !showColorPicker\">\r\n        <span class=\"flex flex-col items-center gap-0.5\">\r\n          <Baseline class=\"w-4 h-4\" />\r\n          <span class=\"w-4 h-1 rounded-sm\" :style=\"{ background: currentColor }\"></span>\r\n        </span>\r\n      </ToolBtn>\r\n      <div v-if=\"showColorPicker\" class=\"color-picker-popup\">\r\n        <div class=\"grid grid-cols-8 gap-1 p-2\">\r\n          <button\r\n            v-for=\"c in colors\" :key=\"c\"\r\n            class=\"w-5 h-5 rounded border border-gray-200 hover:scale-110 transition-transform\"\r\n            :style=\"{ background: c }\"\r\n            @click=\"applyColor(c)\"\r\n          />\r\n        </div>\r\n        <button class=\"w-full text-xs text-center py-1 border-t border-gray-100 text-gray-500 hover:text-gray-700\" @click=\"editor.chain().focus().unsetColor().run(); showColorPicker=false\">Remove color</button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Highlight -->\r\n    <div class=\"relative\" title=\"Highlight\">\r\n      <ToolBtn :active=\"editor.isActive('highlight')\" @click=\"showHighlightPicker = !showHighlightPicker\">\r\n        <span class=\"flex flex-col items-center gap-0.5\">\r\n          <Highlighter class=\"w-4 h-4\" />\r\n          <span class=\"w-4 h-1 rounded-sm\" :style=\"{ background: currentHighlight }\"></span>\r\n        </span>\r\n      </ToolBtn>\r\n      <div v-if=\"showHighlightPicker\" class=\"color-picker-popup\">\r\n        <div class=\"grid grid-cols-5 gap-1 p-2\">\r\n          <button\r\n            v-for=\"c in highlights\" :key=\"c\"\r\n            class=\"w-6 h-6 rounded border border-gray-200 hover:scale-110 transition-transform\"\r\n            :style=\"{ background: c }\"\r\n            @click=\"applyHighlight(c)\"\r\n          />\r\n        </div>\r\n        <button class=\"w-full text-xs text-center py-1 border-t border-gray-100 text-gray-500 hover:text-gray-700\" @click=\"editor.chain().focus().unsetHighlight().run(); showHighlightPicker=false\">Remove highlight</button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"toolbar-sep\" />\r\n\r\n    <!-- Alignment -->\r\n    <ToolBtn title=\"Align left\" :active=\"editor.isActive({textAlign:'left'})\" @click=\"editor.chain().focus().setTextAlign('left').run()\">\r\n      <AlignLeft class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n    <ToolBtn title=\"Align center\" :active=\"editor.isActive({textAlign:'center'})\" @click=\"editor.chain().focus().setTextAlign('center').run()\">\r\n      <AlignCenter class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n    <ToolBtn title=\"Align right\" :active=\"editor.isActive({textAlign:'right'})\" @click=\"editor.chain().focus().setTextAlign('right').run()\">\r\n      <AlignRight class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n    <ToolBtn title=\"Justify\" :active=\"editor.isActive({textAlign:'justify'})\" @click=\"editor.chain().focus().setTextAlign('justify').run()\">\r\n      <AlignJustify class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n\r\n    <div class=\"toolbar-sep\" />\r\n\r\n    <!-- Lists -->\r\n    <ToolBtn title=\"Bullet list\" :active=\"editor.isActive('bulletList')\" @click=\"editor.chain().focus().toggleBulletList().run()\">\r\n      <List class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n    <ToolBtn title=\"Numbered list\" :active=\"editor.isActive('orderedList')\" @click=\"editor.chain().focus().toggleOrderedList().run()\">\r\n      <ListOrdered class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n\r\n    <div class=\"toolbar-sep\" />\r\n\r\n    <!-- Table -->\r\n    <ToolBtn title=\"Insert table\" @click=\"insertTable\">\r\n      <Table2 class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n\r\n    <!-- Image -->\r\n    <ToolBtn title=\"Insert image\" @click=\"insertImage\">\r\n      <ImageIcon class=\"w-4 h-4\" />\r\n    </ToolBtn>\r\n\r\n    <div class=\"toolbar-sep\" />\r\n\r\n    <!-- Variable -->\r\n    <div class=\"relative\">\r\n      <button\r\n        class=\"flex items-center gap-1.5 px-2 py-1 text-xs font-medium bg-orange-50 text-orange-700 border border-orange-200 rounded hover:bg-orange-100 transition-colors\"\r\n        @click=\"showVarInput = !showVarInput\"\r\n        title=\"Insert variable\"\r\n      >\r\n        <Braces class=\"w-3.5 h-3.5\" />\r\n        Insert Variable\r\n      </button>\r\n      <div v-if=\"showVarInput\" class=\"var-popup\" @keydown.esc=\"showVarInput=false\">\r\n        <p class=\"text-xs text-gray-500 mb-2\">Select or type a variable name</p>\r\n        <div class=\"flex flex-wrap gap-1 mb-2\">\r\n          <button\r\n            v-for=\"v in variables\" :key=\"v\"\r\n            class=\"px-2 py-0.5 text-xs bg-orange-100 text-orange-800 rounded-full hover:bg-orange-200\"\r\n            @click=\"doInsertVariable(v)\"\r\n          >{{ chipLabel(v) }}</button>\r\n        </div>\r\n        <div class=\"flex gap-1\">\r\n          <input\r\n            v-model=\"newVarName\"\r\n            type=\"text\"\r\n            placeholder=\"variable_name\"\r\n            class=\"flex-1 text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-orange-400\"\r\n            @keydown.enter=\"doInsertVariable(newVarName)\"\r\n            @keydown.esc=\"showVarInput=false\"\r\n          />\r\n          <button\r\n            class=\"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600\"\r\n            @click=\"doInsertVariable(newVarName)\"\r\n          >Insert</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onUnmounted, defineComponent, h } from 'vue'\r\nimport {\r\n  Undo, Redo, Bold, Italic, Strikethrough,\r\n  AlignLeft, AlignCenter, AlignRight, AlignJustify,\r\n  List, ListOrdered, Table2, Image as ImageIcon,\r\n  Baseline, Highlighter, Braces,\r\n} from 'lucide-vue-next'\r\nimport { Underline as UnderlineIcon } from 'lucide-vue-next'\r\n\r\n// ToolBtn defined in setup scope so it's automatically available in the template\r\nconst ToolBtn = defineComponent({\r\n  props: { active: Boolean, disabled: Boolean, title: String },\r\n  emits: ['click'],\r\n  setup(props, { slots, emit }) {\r\n    return () =>\r\n      h('button', {\r\n        title: props.title,\r\n        disabled: props.disabled,\r\n        onClick: (e) => { e.preventDefault(); emit('click') },\r\n        class: [\r\n          'toolbar-btn',\r\n          props.active ? 'toolbar-btn-active' : '',\r\n          props.disabled ? 'opacity-40 cursor-not-allowed' : '',\r\n        ].join(' '),\r\n      }, slots.default?.())\r\n  },\r\n})\r\n\r\nconst props = defineProps({\r\n  editor: { type: Object, required: true },\r\n  variables: { type: Array, default: () => [] },\r\n})\r\n\r\nconst emit = defineEmits(['add-variable'])\r\n\r\nconst showColorPicker = ref(false)\r\nconst showHighlightPicker = ref(false)\r\nconst showVarInput = ref(false)\r\nconst newVarName = ref('')\r\nconst currentColor = ref('#000000')\r\nconst currentHighlight = ref('#fef08a')\r\n\r\nconst fonts = [\r\n  { label: 'Arial', value: 'Arial, sans-serif' },\r\n  { label: 'Times New Roman', value: \"'Times New Roman', serif\" },\r\n  { label: 'Calibri', value: 'Calibri, sans-serif' },\r\n  { label: 'Georgia', value: 'Georgia, serif' },\r\n  { label: 'Courier New', value: \"'Courier New', monospace\" },\r\n  { label: 'Helvetica', value: 'Helvetica, sans-serif' },\r\n]\r\n\r\nconst fontSizes = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 28, 32, 36, 48, 72]\r\n\r\nconst colors = [\r\n  '#000000','#1a1a1a','#374151','#6B7280','#9CA3AF','#D1D5DB','#F3F4F6','#ffffff',\r\n  '#dc2626','#ea580c','#d97706','#16a34a','#0284c7','#7c3aed','#db2777','#0f766e',\r\n  '#fca5a5','#fdba74','#fde68a','#86efac','#93c5fd','#c4b5fd','#f9a8d4','#99f6e4',\r\n]\r\n\r\nconst highlights = ['#fef08a','#bbf7d0','#bfdbfe','#fecaca','#e9d5ff','#fed7aa','#f0fdf4','#fffbeb']\r\n\r\nconst currentHeading = computed(() => {\r\n  for (let i = 1; i <= 3; i++) {\r\n    if (props.editor.isActive('heading', { level: i })) return String(i)\r\n  }\r\n  return 'paragraph'\r\n})\r\n\r\nconst currentFont = computed(() => {\r\n  return props.editor.getAttributes('textStyle').fontFamily || 'Arial, sans-serif'\r\n})\r\n\r\nconst currentFontSize = computed(() => {\r\n  return props.editor.getAttributes('textStyle').fontSize || '12'\r\n})\r\n\r\nfunction setHeading(val) {\r\n  if (val === 'paragraph') {\r\n    props.editor.chain().focus().setParagraph().run()\r\n  } else {\r\n    props.editor.chain().focus().toggleHeading({ level: parseInt(val) }).run()\r\n  }\r\n}\r\n\r\nfunction applyColor(c) {\r\n  currentColor.value = c\r\n  props.editor.chain().focus().setColor(c).run()\r\n  showColorPicker.value = false\r\n}\r\n\r\nfunction applyHighlight(c) {\r\n  currentHighlight.value = c\r\n  props.editor.chain().focus().setHighlight({ color: c }).run()\r\n  showHighlightPicker.value = false\r\n}\r\n\r\nfunction insertTable() {\r\n  props.editor.chain().focus().insertTable({ rows: 3, cols: 3, withHeaderRow: true }).run()\r\n}\r\n\r\nfunction insertImage() {\r\n  const input = document.createElement('input')\r\n  input.type = 'file'\r\n  input.accept = 'image/*'\r\n  input.onchange = async (e) => {\r\n    const file = e.target.files[0]\r\n    if (!file) return\r\n    const reader = new FileReader()\r\n    reader.onload = (ev) => {\r\n      props.editor.chain().focus().setImage({ src: ev.target.result }).run()\r\n    }\r\n    reader.readAsDataURL(file)\r\n  }\r\n  input.click()\r\n}\r\n\r\nfunction doInsertVariable(name) {\r\n  name = name?.trim().replace(/[^a-zA-Z0-9_]/g, '_')\r\n  if (!name) return\r\n  props.editor.chain().focus().insertVariable(name).run()\r\n  emit('add-variable', name)\r\n  newVarName.value = ''\r\n  showVarInput.value = false\r\n}\r\n\r\nfunction chipLabel(name) {\r\n  return '{{' + name + '}}'\r\n}\r\n\r\n// Close popups on outside click\r\nfunction onDocClick(e) {\r\n  if (!e.target.closest('.toolbar')) {\r\n    showColorPicker.value = false\r\n    showHighlightPicker.value = false\r\n    showVarInput.value = false\r\n  }\r\n}\r\n\r\nonMounted(() => document.addEventListener('click', onDocClick))\r\nonUnmounted(() => document.removeEventListener('click', onDocClick))\r\n</script>\r\n\r\n<style scoped>\r\n.toolbar-group { @apply flex items-center gap-0.5; }\r\n.toolbar-sep { @apply w-px h-5 bg-gray-200 mx-1; }\r\n\r\n:deep(.toolbar-btn) {\r\n  @apply flex items-center justify-center w-7 h-7 rounded text-gray-700 hover:bg-gray-100 transition-colors;\r\n}\r\n:deep(.toolbar-btn-active) {\r\n  @apply bg-blue-50 text-blue-700 hover:bg-blue-100;\r\n}\r\n.toolbar-select {\r\n  @apply text-xs border border-gray-200 rounded px-1.5 py-1 bg-white text-gray-700 focus:outline-none focus:ring-1 focus:ring-blue-400;\r\n}\r\n.color-picker-popup {\r\n  @apply absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-max;\r\n}\r\n.var-popup {\r\n  @apply absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 p-3 w-64;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"flex flex-col h-screen overflow-hidden bg-gray-100\">\r\n\r\n    <!-- Top bar -->\r\n    <div class=\"flex items-center gap-3 px-4 py-2 bg-white border-b border-gray-200 flex-shrink-0 shadow-sm\">\r\n      <button\r\n        class=\"flex items-center gap-1.5 text-sm text-gray-600 hover:text-gray-900 transition-colors\"\r\n        @click=\"$router.push('/templates')\"\r\n      >\r\n        <ArrowLeft class=\"w-4 h-4\" />\r\n        Templates\r\n      </button>\r\n      <div class=\"w-px h-5 bg-gray-200\" />\r\n      <input\r\n        v-model=\"templateName\"\r\n        type=\"text\"\r\n        placeholder=\"Template Name\"\r\n        class=\"flex-1 text-base font-semibold text-gray-900 border-none outline-none bg-transparent max-w-xs placeholder-gray-400\"\r\n      />\r\n      <div class=\"flex-1\" />\r\n      <span v-if=\"lastSaved\" class=\"text-xs text-gray-400\">Saved {{ lastSaved }}</span>\r\n      <button\r\n        class=\"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50\"\r\n        @click=\"saveTemplate\"\r\n        :disabled=\"saving\"\r\n      >\r\n        <Save class=\"w-4 h-4\" />\r\n        {{ saving ? 'Saving…' : 'Save' }}\r\n      </button>\r\n      <button\r\n        class=\"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors disabled:opacity-50\"\r\n        @click=\"goGenerate\"\r\n        :disabled=\"!savedTemplateName\"\r\n        :title=\"savedTemplateName ? 'Generate PDF from this template' : 'Save first'\"\r\n      >\r\n        <FileDown class=\"w-4 h-4\" />\r\n        Generate PDF\r\n      </button>\r\n    </div>\r\n\r\n    <!-- Toolbar -->\r\n    <TemplateToolbar\r\n      v-if=\"editor\"\r\n      :editor=\"editor\"\r\n      :variables=\"variables\"\r\n      @add-variable=\"onToolbarAddVariable\"\r\n      class=\"flex-shrink-0\"\r\n    />\r\n\r\n    <!-- Body -->\r\n    <div class=\"flex flex-1 overflow-hidden\">\r\n\r\n      <!-- Variables sidebar -->\r\n      <div class=\"w-52 bg-white border-r border-gray-200 flex flex-col flex-shrink-0\">\r\n        <div class=\"px-3 py-2.5 border-b border-gray-100\">\r\n          <p class=\"text-xs font-semibold text-gray-500 uppercase tracking-wide\">Variables</p>\r\n          <p class=\"text-xs text-gray-400 mt-0.5\">Click to insert at cursor</p>\r\n        </div>\r\n        <div class=\"flex-1 overflow-y-auto p-3 space-y-1.5\">\r\n          <button\r\n            v-for=\"v in variables\"\r\n            :key=\"v\"\r\n            class=\"w-full text-left px-2.5 py-1 text-xs bg-orange-50 text-orange-700 border border-orange-200 rounded-full hover:bg-orange-100 truncate transition-colors\"\r\n            @click=\"insertVariableAtCursor(v)\"\r\n            :title=\"'Insert ' + chipLabel(v)\"\r\n          >\r\n            {{ chipLabel(v) }}\r\n          </button>\r\n          <p v-if=\"variables.length === 0\" class=\"text-xs text-gray-400 text-center py-4\">\r\n            No variables yet\r\n          </p>\r\n        </div>\r\n        <div class=\"p-3 border-t border-gray-100\">\r\n          <p class=\"text-xs text-gray-500 mb-1.5\">Add variable</p>\r\n          <div class=\"flex gap-1\">\r\n            <input\r\n              v-model=\"newVarInput\"\r\n              type=\"text\"\r\n              placeholder=\"var_name\"\r\n              class=\"flex-1 text-xs border border-gray-200 rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-orange-400 min-w-0\"\r\n              @keydown.enter=\"addVariable(newVarInput)\"\r\n            />\r\n            <button\r\n              class=\"px-2.5 py-1.5 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 transition-colors flex-shrink-0\"\r\n              @click=\"addVariable(newVarInput)\"\r\n            >+</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Paper viewport -->\r\n      <div class=\"flex-1 overflow-auto bg-[#d9d9d9] py-8 px-6\">\r\n        <div\r\n          class=\"relative mx-auto bg-white shadow-2xl\"\r\n          style=\"width: 794px; min-height: 1123px;\"\r\n        >\r\n          <!-- Optional background image -->\r\n          <img\r\n            v-if=\"backgroundImage\"\r\n            :src=\"backgroundImage\"\r\n            class=\"absolute inset-0 w-full h-full object-cover pointer-events-none select-none\"\r\n            style=\"opacity: 0.12;\"\r\n            alt=\"\"\r\n          />\r\n          <!-- TipTap content area -->\r\n          <editor-content\r\n            v-if=\"editor\"\r\n            :editor=\"editor\"\r\n            class=\"template-paper relative z-10\"\r\n            style=\"padding: 80px; min-height: 1123px;\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Right panel -->\r\n      <div class=\"w-44 bg-white border-l border-gray-200 p-3 flex-shrink-0 space-y-4\">\r\n        <div>\r\n          <p class=\"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">Page</p>\r\n          <p class=\"text-xs text-gray-600\">A4 · 794 × 1123 px</p>\r\n        </div>\r\n        <div class=\"border-t border-gray-100 pt-3\">\r\n          <p class=\"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">Background</p>\r\n          <button\r\n            class=\"w-full text-xs px-2 py-2 border border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-orange-400 hover:text-orange-600 text-center transition-colors\"\r\n            @click=\"$refs.bgFileInput.click()\"\r\n          >\r\n            {{ backgroundImage ? 'Change image' : '+ Upload image' }}\r\n          </button>\r\n          <input ref=\"bgFileInput\" type=\"file\" accept=\"image/*\" class=\"hidden\" @change=\"onBgImageChange\" />\r\n          <button\r\n            v-if=\"backgroundImage\"\r\n            @click=\"backgroundImage = ''\"\r\n            class=\"mt-1.5 w-full text-xs text-red-500 hover:underline text-center\"\r\n          >Remove</button>\r\n        </div>\r\n        <div class=\"border-t border-gray-100 pt-3\">\r\n          <p class=\"text-xs text-gray-400\">Variables: {{ variables.length }}</p>\r\n          <p class=\"text-xs text-gray-400 mt-0.5\">Words: {{ wordCount }}</p>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onBeforeUnmount } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { useEditor, EditorContent } from '@tiptap/vue-3'\r\nimport StarterKit from '@tiptap/starter-kit'\r\nimport { TextStyle } from '@tiptap/extension-text-style'\r\nimport { Color } from '@tiptap/extension-color'\r\nimport { Underline } from '@tiptap/extension-underline'\r\nimport { TextAlign } from '@tiptap/extension-text-align'\r\nimport { FontFamily } from '@tiptap/extension-font-family'\r\nimport { Highlight } from '@tiptap/extension-highlight'\r\nimport { Image } from '@tiptap/extension-image'\r\nimport { Table, TableRow, TableCell, TableHeader } from '@tiptap/extension-table'\r\nimport { Link } from '@tiptap/extension-link'\r\nimport { ArrowLeft, Save, FileDown } from 'lucide-vue-next'\r\nimport { Variable } from './VariableNode.js'\r\nimport { FontSize } from './FontSizeExtension.js'\r\nimport TemplateToolbar from './TemplateToolbar.vue'\r\nimport { usePdfApi } from '@/composables/usePdfApi'\r\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst api = usePdfApi()\r\n\r\nconst templateName = ref('Untitled Template')\r\nconst variables = ref([])\r\nconst newVarInput = ref('')\r\nconst backgroundImage = ref('')\r\nconst saving = ref(false)\r\nconst lastSaved = ref('')\r\nconst savedTemplateName = ref('')\r\n\r\nconst editor = useEditor({\r\n  extensions: [\r\n    StarterKit.configure({ codeBlock: false }),\r\n    TextStyle,\r\n    Color,\r\n    Underline,\r\n    TextAlign.configure({ types: ['heading', 'paragraph'] }),\r\n    FontFamily,\r\n    Highlight.configure({ multicolor: true }),\r\n    Image.configure({ inline: false, allowBase64: true }),\r\n    Table.configure({ resizable: true }),\r\n    TableRow,\r\n    TableCell,\r\n    TableHeader,\r\n    Link.configure({ openOnClick: false }),\r\n    Variable,\r\n    FontSize,\r\n  ],\r\n  content: '<p>Start typing your template here…</p>',\r\n})\r\n\r\nconst wordCount = computed(() => {\r\n  if (!editor.value) return 0\r\n  const text = editor.value.getText()\r\n  return text.trim() ? text.trim().split(/\\s+/).length : 0\r\n})\r\n\r\nonMounted(async () => {\r\n  const name = route.params.name\r\n  if (name && name !== 'new') {\r\n    savedTemplateName.value = name\r\n    await loadTemplate(name)\r\n  }\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  editor.value?.destroy()\r\n})\r\n\r\nasync function loadTemplate(name) {\r\n  const res = await api.getTemplate(name)\r\n  if (!res?.success) return\r\n  const schema = res.data.schema || {}\r\n  templateName.value = res.data.template_name || name\r\n  if (schema.type === 'tiptap') {\r\n    variables.value = schema.variables || []\r\n    backgroundImage.value = schema.background_image || ''\r\n    if (schema.html) {\r\n      editor.value?.commands.setContent(schema.html)\r\n    }\r\n  }\r\n}\r\n\r\nasync function saveTemplate() {\r\n  const name = templateName.value.trim()\r\n  if (!name) return\r\n  saving.value = true\r\n  try {\r\n    const html = editor.value?.getHTML() || ''\r\n    const schema = {\r\n      type: 'tiptap',\r\n      html,\r\n      variables: variables.value,\r\n      background_image: backgroundImage.value,\r\n    }\r\n    const res = await api.saveTemplate(name, schema, '', '')\r\n    if (res?.success) {\r\n      savedTemplateName.value = res.data.template_name\r\n      lastSaved.value = new Date().toLocaleTimeString()\r\n    }\r\n  } finally {\r\n    saving.value = false\r\n  }\r\n}\r\n\r\nfunction insertVariableAtCursor(name) {\r\n  editor.value?.chain().focus().insertVariable(name).run()\r\n}\r\n\r\nfunction addVariable(name) {\r\n  name = name?.trim().replace(/[^a-zA-Z0-9_]/g, '_')\r\n  if (!name || variables.value.includes(name)) {\r\n    newVarInput.value = ''\r\n    return\r\n  }\r\n  variables.value.push(name)\r\n  insertVariableAtCursor(name)\r\n  newVarInput.value = ''\r\n}\r\n\r\nfunction onToolbarAddVariable(name) {\r\n  if (name && !variables.value.includes(name)) {\r\n    variables.value.push(name)\r\n  }\r\n}\r\n\r\nfunction goGenerate() {\r\n  router.push({ name: 'template-generate', params: { name: savedTemplateName.value } })\r\n}\r\n\r\nfunction chipLabel(name) {\r\n  return '{{' + name + '}}'\r\n}\r\n\r\nfunction onBgImageChange(e) {\r\n  const file = e.target.files[0]\r\n  if (!file) return\r\n  const reader = new FileReader()\r\n  reader.onload = (ev) => { backgroundImage.value = ev.target.result }\r\n  reader.readAsDataURL(file)\r\n}\r\n</script>\r\n\r\n<style>\r\n/* Paper editor styles (not scoped — needed for deep TipTap elements) */\r\n.template-paper .ProseMirror {\r\n  outline: none;\r\n  min-height: 960px;\r\n  font-size: 12pt;\r\n  line-height: 1.6;\r\n  color: #111827;\r\n}\r\n.template-paper .ProseMirror > * + * { margin-top: 0.5em; }\r\n.template-paper .ProseMirror p { margin: 0 0 0.4em; }\r\n.template-paper .ProseMirror h1 { font-size: 2em; font-weight: 700; margin: 0.6em 0 0.3em; }\r\n.template-paper .ProseMirror h2 { font-size: 1.5em; font-weight: 700; margin: 0.5em 0 0.25em; }\r\n.template-paper .ProseMirror h3 { font-size: 1.25em; font-weight: 600; margin: 0.4em 0 0.2em; }\r\n.template-paper .ProseMirror ul { list-style: disc; padding-left: 1.5em; margin: 0.4em 0; }\r\n.template-paper .ProseMirror ol { list-style: decimal; padding-left: 1.5em; margin: 0.4em 0; }\r\n.template-paper .ProseMirror table {\r\n  border-collapse: collapse;\r\n  width: 100%;\r\n  margin: 0.8em 0;\r\n}\r\n.template-paper .ProseMirror th,\r\n.template-paper .ProseMirror td {\r\n  border: 1px solid #d1d5db;\r\n  padding: 6px 10px;\r\n  text-align: left;\r\n  min-width: 80px;\r\n}\r\n.template-paper .ProseMirror th {\r\n  background: #f9fafb;\r\n  font-weight: 600;\r\n}\r\n/* Variable chip in editor */\r\n.variable-chip {\r\n  display: inline-block;\r\n  background: #fed7aa;\r\n  color: #9a3412;\r\n  border: 1px solid #fdba74;\r\n  border-radius: 999px;\r\n  padding: 0 7px;\r\n  font-size: 0.85em;\r\n  font-weight: 500;\r\n  user-select: none;\r\n  cursor: default;\r\n  white-space: nowrap;\r\n}\r\n</style>\r\n"],"names":["h","tag","attributes","_a","children","rest","__objRest","inputRegex","Blockquote","Node","HTMLAttributes","jsx","__spreadProps","__spreadValues","mergeAttributes","token","helpers","node","prefix","result","child","linesWithPrefix","line","commands","wrappingInputRule","starInputRegex","starPasteRegex","underscoreInputRegex","underscorePasteRegex","Bold","Mark","mark","value","markInputRule","markPasteRule","pasteRegex","Code","DEFAULT_TAB_SIZE","backtickInputRegex","tildeInputRegex","CodeBlock","element","languageClassPrefix","language","className","output","empty","$anchor","isAtStart","editor","tabSize","state","selection","$from","indent","tr","from","to","indentedText","_a2","pos","codeBlockStart","codeBlockEnd","lines","currentLineIndex","charCount","relativeCursorPos","i","leadingSpaces","spacesToRemove","lineStartPos","TextSelection","reverseIndentText","isAtEnd","endsWithDoubleNewline","doc","after","Selection","textblockTypeInputRule","match","Plugin","PluginKey","view","event","text","vscode","vscodeData","schema","textNode","Document","HardBreak","chain","storedMarks","keepMarks","splittableMarks","marks","dispatch","filteredMarks","Heading","level","headingChars","items","HorizontalRule","canInsertNode","$originTo","currentChain","isNodeSelection","chainState","$to","posAfter","NodeSelection","nodeType","nodeInputRule","Italic","encodedTlds","encodedUtlds","numeric","ascii","alpha","asciinumeric","alphanumeric","domain","emoji","scheme","slashscheme","whitespace","registerGroup","name","groups","addToGroups","t","flags","k","group","flagsForToken","c","State","input","nextState","regex","exactOnly","inputs","next","regexp","len","templateState","allFlags","ta","ts","tt","WORD","UWORD","ASCIINUMERICAL","ALPHANUMERICAL","LOCALHOST","TLD","UTLD","SCHEME","SLASH_SCHEME","NUM","WS","NL","OPENBRACE","CLOSEBRACE","OPENBRACKET","CLOSEBRACKET","OPENPAREN","CLOSEPAREN","OPENANGLEBRACKET","CLOSEANGLEBRACKET","FULLWIDTHLEFTPAREN","FULLWIDTHRIGHTPAREN","LEFTCORNERBRACKET","RIGHTCORNERBRACKET","LEFTWHITECORNERBRACKET","RIGHTWHITECORNERBRACKET","FULLWIDTHLESSTHAN","FULLWIDTHGREATERTHAN","AMPERSAND","APOSTROPHE","ASTERISK","AT","BACKSLASH","BACKTICK","CARET","COLON","COMMA","DOLLAR","DOT","EQUALS","EXCLAMATION","HYPHEN","PERCENT","PIPE","PLUS","POUND","QUERY","QUOTE","FULLWIDTHMIDDLEDOT","SEMI","SLASH","TILDE","UNDERSCORE","EMOJI$1","SYM","tk","ASCII_LETTER","LETTER","EMOJI","DIGIT","SPACE","CR","LF","EMOJI_VARIATION","EMOJI_JOINER","OBJECT_REPLACEMENT","tlds","utlds","init$2","customSchemes","Start","decodeTlds","Num","Asciinumeric","Alphanumeric","Word","UWord","Nl","Cr","Ws","Emoji","EmojiJoiner","wordjr","uwordjr","fastts","a","b","sch","run$1","start","str","iterable","stringToArray","tokens","cursor","charCursor","tokenLength","latestAccepting","sinceAccepts","charsSinceAccepts","index","first","second","char","defaultt","jr","encoded","words","stack","digits","popDigitCount","popCount","defaults","noop","Options","opts","defaultRender","o","ignoredTags","uppercaseIgnoredTags","ir","key","operator","isCallable","option","obj","val","MultiToken","options","truncate","formatted","protocol","href","formattedHref","tagName","content","target","rel","attrs","eventListeners","createTokenClass","type","props","Token","p","Email","Text","Url","makeState","arg","init$1","qsAccepting","qsNonAccepting","localpartAccepting","Localpart","Domain","Scheme","SlashScheme","LocalpartAt","LocalpartDot","EmailDomain","EmailDomainDot","Email$1","EmailDomainHyphen","EmailColon","DomainHyphen","DomainDot","DomainDotTld","DomainDotTldColon","DomainDotTldColonPort","Url$1","UrlNonaccept","SchemeColon","SlashSchemeColon","SlashSchemeColonSlash","UriPrefix","bracketPairs","OPEN","CLOSE","UrlOpen","UrlOpenQ","UrlOpenSyms","run","multis","textTokens","secondState","multiLength","initMultiToken","Multi","subtokens","startIdx","endIdx","warn","warnAdvice","INIT","reset","registerCustomProtocol","optionalSlashSlash","init","tokenize","find","filtered","UNICODE_WHITESPACE_PATTERN","UNICODE_WHITESPACE_REGEX","UNICODE_WHITESPACE_REGEX_END","UNICODE_WHITESPACE_REGEX_GLOBAL","isValidLinkStructure","autolink","transactions","oldState","newState","docChanges","transaction","preventAutolink","transform","combineTransactionSteps","getChangedRanges","newRange","nodesInChangedRanges","findChildrenInRange","textBlock","textBeforeWhitespace","endText","wordsBeforeWhitespace","lastWordBeforeSpace","lastWordAndBlockOffset","linksBeforeSpace","link","getMarksBetween","item","clickHandler","Plugin2","PluginKey2","_b","root","handled","getAttributes","pasteHandler","Plugin3","PluginKey3","_event","slice","shouldAutoLink","textContent","isAllowedUri","uri","protocols","allowedProtocols","nextProtocol","Link","url","ctx","hasProtocol","hasMaybeProtocol","hostname","dom","_c","_d","title","foundLinks","defaultProtocol","links","find2","plugins","__defProp","__export","all","ListItemName","TextStyleName","bulletListInputRegex","BulletList","inputRule","ListItem","Node2","mergeAttributes2","firstToken","remainingTokens","additionalContent","renderNestedMarkdownContent","context","listHelpers_exports","findListItemPos","getNextListDepth","handleBackspace","handleDelete","hasListBefore","hasListItemAfter","hasListItemBefore","listItemHasSubList","nextListIsDeeper","nextListIsHigher","typeOrName","getNodeType","currentNode","currentDepth","currentPos","targetDepth","listItemPos","depth","getNodeAtPosition","editorState","parentListTypes","previousNodePos","previousNode","$targetPos","getNodeType2","hasSubList","isNodeActive","$listPos","listDescendants","lastItem","$lastItemPos","isAtStartOfNode","prevNode","previousListItemHasSubList","listDepth","isNodeActive2","isAtEndOfNode","ListKeymap","Extension","itemName","wrapperNames","ORDERED_LIST_ITEM_REGEX","INDENTED_LINE_REGEX","collectOrderedListItems","listItems","consumed","number","indentLevel","itemContent","nextLineIndex","itemLines","nextLine","buildNestedStructure","baseIndent","lexer","currentIndex","contentLines","mainText","blockTokens","lookAheadIndex","nestedItems","nextIndent","nestedItem","nestedListItems","parseListItems","itemToken","inlineContent","parsed","ListItemName2","TextStyleName2","orderedListInputRegex","OrderedList","Node3","attributesWithoutStart","mergeAttributes3","startValue","src","_tokens","wrappingInputRule2","TaskItem","Node4","dataChecked","mergeAttributes4","nestedContent","renderNestedMarkdownContent2","shortcuts","getPos","listItem","checkboxWrapper","checkboxStyler","checkbox","updateA11Y","checked","position","prevRenderedAttributeKeys","updatedNode","extensionAttributes","newHTMLAttributes","getRenderedAttributes","newKeys","staticAttrs","wrappingInputRule3","TaskList","Node5","mergeAttributes5","parseTaskListContent","nestedResult","parseIndentedBlocks","data","nestedTokens","Extension2","extensions","EMPTY_PARAGRAPH_MARKDOWN","NBSP_CHAR","Paragraph","Strike","style","Underline","innerContent","dropCursor","editorView","DropCursorView","handler","e","prevState","$pos","isBlock","rect","editorDOM","editorRect","scaleX","scaleY","before","nodeRect","top","halfWidth","coords","parent","parentLeft","parentTop","parentScaleX","parentScaleY","timeout","disableDropCursor","disabled","point","dropPoint","GapCursor","mapping","Slice","other","json","GapBookmark","closedBefore","closedAfter","override","deflt","dir","mustMove","search","d","$cur","inside","needsGap","gapCursor","drawGapCursor","_view","$head","handleClick","handleKeyDown","beforeinput","keydownHandler","arrow","axis","dirStr","sel","$start","$found","clickPos","insert","frag","Fragment","DecorationSet","Decoration","GOOD_LEAF_SIZE","RopeSequence","Append","f","elt","values","Leaf","prototypeAccessors","left","right","leftLen","inner","max_empty_items","Branch","eventCount","preserveItems","end","remap","mapFrom","remaining","addAfter","addBefore","Item","step","map","histOptions","newItems","oldItems","merged","overflow","DEPTH_OVERFLOW","cutOffEvents","maps","Mapping","mirrorPos","array","rebasedTransform","rebasedCount","rebasedItems","newUntil","iRebased","newMaps","branch","count","upto","events","newItem","last","n","cutPoint","mirrorOffset","HistoryState","done","undone","prevRanges","prevTime","prevComposition","applyTransaction","history","historyTr","historyKey","rebased","closeHistoryKey","appended","mustPreserveItems","rangesFor","composition","newGroup","isAdjacentTo","mapRanges","adjacent","_from","_to","ranges","histTransaction","redo","pop","added","newHist","cachedPreserveItems","cachedPreserveItemsPlugins","config","hist","inputType","command","undo","buildCommand","scroll","word","initialEvaluationDone","limit","initialContentSize","over","oldSize","newSize","Dropcursor","Extension3","isEditable","isFocused","anchor","decorations","maxLevels","currentLevel","Gapcursor","Extension4","extension","callOrReturn","getExtensionField","DEFAULT_DATA_ATTRIBUTE","preparePlaceholderAttribute","attr","Extension5","dataAttribute","active","isEmptyDoc","hasAnchor","isEmpty","isNodeEmpty","classes","decoration","Decoration2","DecorationSet2","Extension6","Plugin4","PluginKey4","DecorationSet3","Decoration3","nodeEqualsType","types","TrailingNode","Extension7","plugin","PluginKey5","defaultNode","disabledNodes","Plugin5","_","__","shouldInsertNodeAtEnd","endPosition","lastNode","UndoRedo","Extension8","StarterKit","index_default","MAX_FIND_CHILD_SPAN_DEPTH","findChildSpans","childSpans","mergeNestedSpanStyles","childSpan","childStyle","closestParentSpanStyleOfChild","TextStyle","BackgroundColor","styleAttr","decls","parts","prop","backgroundColor","Color","color","FontFamily","fontFamily","FontSize","fontSize","LineHeight","lineHeight","TextAlign","alignment","response","Highlight","Image","_e","_f","alt","directions","minWidth","minHeight","alwaysPreserveAspectRatio","el","nodeView","ResizableNodeView","width","height","_decorations","_innerDecorations","readFromCache","addToCache","cache","cachePos","TableMap","problems","curPos","bottom","j","leftA","rightA","topA","bottomA","leftB","rightB","topB","bottomB","seen","row","col","table","rowStart","rowEnd","rowEndIndex","computeMap","findWidth","mapPos","colWidths","rowNode","cellNode","colspan","rowspan","colwidth","colW","widthIndex","prev","expectedPos","missing","tableMap","badWidths","findBadColWidths","hasRowSpan","rowWidth","prevRow","cell","updated","colWidth","freshColWidth","tableNodeTypes","role","tableEditingKey","cellAround","cellWrapping","isInTable","selectionCell","$cell","cellNear","pointsAtCell","moveCellForward","inSameTable","$cellA","$cellB","nextCell","tableStart","moved","removeColSpan","w","addColSpan","columnIsHeader","headerCell","CellSelection","$anchorCell","$headCell","cells","SelectionRange","tableChanged","rows","rowContent","cellRect","extraLeft","extraRight","fragment","anchorTop","headTop","anchorBottom","headBottom","anchorRect","headRect","anchorLeft","headLeft","anchorRight","headRight","anchorCell","headCell","CellBookmark","head","drawCellSelection","isCellBoundarySelection","afterFrom","beforeTo","isTextSelectionAcrossCells","fromCellBoundaryNode","toCellBoundaryNode","normalizeSelection","allowTableNodeSelection","normalize","lastCell","fixTablesKey","changedDescendants","old","cur","offset","curSize","outer","scan","fixTables","check","fixTable","tablePos","mustAdd","prob","add","nodes","side","selectedRect","addColumn","refColumn","addColumnBefore","addColumnAfter","removeColumn","mapStart","deleteColumn","rowIsHeader","_table$nodeAt","addRow","rowPos","refRow","_table$nodeAt2","addRowBefore","addRowAfter","removeRow","nextRow","copy","newPos","deleteRow","cellsOverlapRectangle","indexTop","indexLeft","indexBottom","indexRight","mergeCells","mergedPos","mergedCell","cellPos","mapped","splitCell","nodeTypes","splitCellWithType","getCellType","_cellAround","baseAttrs","setCellAttr","deprecated_toggleHeader","isHeaderEnabledByType","cellPositions","toggleHeader","isHeaderRowEnabled","isHeaderColumnEnabled","selectionStartsAt","cellsRect","newType","relativeCellPos","toggleHeaderCell","findNextCell","lastChild","goToNextCell","direction","deleteTable","deleteCellSelection","baseContent","pastedCells","openStart","openEnd","fitSlice","ensureRectangular","widths","r","Transform","clipCells","newWidth","newHeight","newRows","source","growTable","emptyHead","start$1","header","emptyRow","isolateHorizontal","found","cellTop","cellLeft","isolateVertical","updatePos","insertCells","recomp","shiftArrow","maybeSetSelection","atEndOfCell","$next","newSel","cellSel","handleTripleClick","handlePaste","handleMouseDown$1","startEvent","_cellUnderMouse","startDOMCell","domInCell","setCellSelection","cellUnderMouse","$anchor$1","starting","stop","move","mousePos","TableView","defaultCellMinWidth","updateColumnsOnResize","record","colgroup","overrideCol","overrideValue","totalWidth","fixedWidth","nextDOM","hasWidth","cssWidth","col$1","_nextDOM$parentNode","columnResizingPluginKey","columnResizing","handleWidth","cellMinWidth","View","lastColumnResizable","_plugin$spec","nodeViews","tableName","ResizeState","pluginState","handleMouseMove","handleMouseLeave","handleMouseDown","handleDecorations","activeHandle","dragging","action","handle","domCellAround","edgeCell","updateHandle","_view$dom$ownerDocume","win","currentColWidth","finish","event$1","pluginState$1","updateColumnWidth","draggedWidth","dragged","displayColumnWidth","domWidth","resizeMinWidth","mapIndex","zeroes","_columnResizingPlugin","tableEditing","set","deleted","TableCell","cols","cellIndex","TableHeader","TableRow","getColStyleDeclaration","updateColumns","propertyKey","propertyValue","colElement","hasUserWidth","mutation","isInsideWrapper","isInsideContent","createColGroup","property","tableWidth","tableMinWidth","createCell","cellType","cellContent","getTableNodeTypes","roles","createTable","rowsCount","colsCount","withHeaderRow","headerCells","isCellSelection","deleteTableWhenAllCellsSelected","cellCount","findParentNodeClosestToPos","DEFAULT_CELL_LINE_SEPARATOR","collapseWhitespace","s","renderTableToMarkdown","cellSep","raw","isHeader","columnCount","max","pad","headerRow","hasHeader","out","headerTexts","markdown_default","Table","userStyles","getTableStyle","bodyCells","CellSelection2","Variable","InputRule","range","size","ToolBtn","defineComponent","slots","emit","__props","__emit","showColorPicker","ref","showHighlightPicker","showVarInput","newVarName","currentColor","currentHighlight","fonts","fontSizes","colors","highlights","currentHeading","computed","currentFont","currentFontSize","setHeading","applyColor","applyHighlight","insertTable","insertImage","__async","file","reader","ev","doInsertVariable","chipLabel","onDocClick","onMounted","onUnmounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_unref","_cache","$event","Undo","Redo","_Fragment","_renderList","_toDisplayString","_hoisted_5","_hoisted_7","UnderlineIcon","Strikethrough","_hoisted_8","_hoisted_9","Baseline","_hoisted_10","_hoisted_11","_hoisted_13","_hoisted_14","Highlighter","_hoisted_15","_hoisted_16","AlignLeft","AlignCenter","AlignRight","AlignJustify","List","ListOrdered","Table2","ImageIcon","_hoisted_18","Braces","_hoisted_19","v","_hoisted_20","_hoisted_21","_withKeys","router","useRouter","route","useRoute","api","usePdfApi","templateName","variables","newVarInput","backgroundImage","saving","lastSaved","savedTemplateName","useEditor","wordCount","loadTemplate","onBeforeUnmount","res","saveTemplate","insertVariableAtCursor","addVariable","onToolbarAddVariable","goGenerate","onBgImageChange","$router","ArrowLeft","_hoisted_3","Save","_createTextVNode","FileDown","_createBlock","TemplateToolbar","_hoisted_6","_hoisted_12","EditorContent","_hoisted_17","$refs"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]}