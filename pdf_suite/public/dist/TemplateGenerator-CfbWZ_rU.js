var N=Object.defineProperty;var C=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var P=(i,o,a)=>o in i?N(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a,V=(i,o)=>{for(var a in o||(o={}))U.call(o,a)&&P(i,a,o[a]);if(C)for(var a of C(o))j.call(o,a)&&P(i,a,o[a]);return i};var F=(i,o,a)=>new Promise((y,m)=>{var p=r=>{try{g(a.next(r))}catch(u){m(u)}},f=r=>{try{g(a.throw(r))}catch(u){m(u)}},g=r=>r.done?y(r.value):Promise.resolve(r.value).then(p,f);g((a=a.apply(i,o)).next())});import{s as A,o as n,c as d,b as t,a as k,g as b,bg as L,i as w,F as T,t as v,d as D,ac as M,r as O,U as $,V as B,n as R,ad as z,bi as H,a8 as S,u as q,z as x,O as I,A as J}from"./vue-vendor-Cf1u-26_.js";import{u as K}from"./usePdfApi-BXiAzpXu.js";const Q={class:"min-h-screen bg-gray-50"},W={class:"max-w-xl mx-auto px-6 py-10"},X={class:"flex items-center gap-3 mb-8"},Y={key:0,class:"flex justify-center py-16"},Z={key:1,class:"text-center py-16"},ee={class:"bg-white border border-gray-200 rounded-2xl p-5 mb-5 shadow-sm"},te={class:"flex items-start justify-between"},se={class:"text-lg font-bold text-gray-900"},ae={key:0,class:"text-sm text-gray-500 mt-1"},oe={class:"bg-white border border-gray-200 rounded-2xl p-5 mb-5 shadow-sm"},ne={class:"text-sm font-semibold text-gray-700 mb-4"},re={class:"font-normal text-gray-400"},le={key:0,class:"text-sm text-gray-400 py-4 text-center"},de={key:1,class:"space-y-4"},ie={class:"block text-sm font-medium text-gray-700 mb-1"},ue={class:"inline-flex items-center gap-1"},ce={class:"px-1.5 py-0.5 bg-orange-100 text-orange-700 text-xs rounded font-mono"},me=["onUpdate:modelValue","placeholder"],pe={class:"bg-white border border-gray-200 rounded-2xl p-5 mb-5 shadow-sm"},ge={class:"flex items-center gap-2"},xe=["disabled"],fe={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},be={key:0,class:"mt-4 p-4 bg-green-50 border border-green-200 rounded-xl flex items-center justify-between gap-3"},ve={class:"flex items-center gap-2"},ye=["href","download"],he={key:1,class:"mt-4 p-4 bg-red-50 border border-red-200 rounded-xl"},we={class:"text-sm text-red-700"},De={__name:"TemplateGenerator",setup(i){const o=q();J();const a=K(),y=x(!0),m=x(!1),p=x(null),f=x([]),g=I({}),r=x(""),u=x(""),_=x(""),h=x("");A(()=>F(this,null,function*(){const l=o.params.name;if(!l){y.value=!1;return}try{const e=yield a.getTemplate(l);if(e!=null&&e.success){p.value=e.data,r.value=e.data.template_name||l;const s=e.data.schema||{};s.type==="tiptap"&&(f.value=s.variables||[],f.value.forEach(c=>{g[c]=""}))}}finally{y.value=!1}}));function E(l){return"{{"+l+"}}"}function G(){return F(this,null,function*(){var l;h.value="",u.value="",_.value="",m.value=!0;try{const e=r.value.trim()||((l=p.value)==null?void 0:l.template_name)||"document",s=yield a.generateHtmlPdf(o.params.name,V({},g),e);if(s!=null&&s.success){u.value=s.data.file_url,_.value=s.data.filename;const c=document.createElement("a");c.href=u.value,c.download=_.value,document.body.appendChild(c),c.click(),document.body.removeChild(c)}else h.value=(s==null?void 0:s.error)||"Failed to generate PDF"}catch(e){h.value="Network error. Please try again."}finally{m.value=!1}})}return(l,e)=>(n(),d("div",Q,[t("div",W,[t("div",X,[t("button",{class:"flex items-center gap-1.5 text-sm text-gray-600 hover:text-gray-900 transition-colors",onClick:e[0]||(e[0]=s=>l.$router.push("/templates"))},[k(b(L),{class:"w-4 h-4"}),e[4]||(e[4]=w(" Templates ",-1))]),e[5]||(e[5]=t("div",{class:"w-px h-4 bg-gray-200"},null,-1)),e[6]||(e[6]=t("span",{class:"text-sm text-gray-500"},"Generate PDF",-1))]),y.value?(n(),d("div",Y,[...e[7]||(e[7]=[t("div",{class:"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"},null,-1)])])):p.value?(n(),d(T,{key:2},[t("div",ee,[t("div",te,[t("div",null,[t("h1",se,v(p.value.template_name),1),p.value.description?(n(),d("p",ae,v(p.value.description),1)):D("",!0)]),t("button",{class:"text-sm text-gray-500 hover:text-orange-600 flex items-center gap-1 transition-colors",onClick:e[2]||(e[2]=s=>l.$router.push({name:"template-edit",params:{name:b(o).params.name}}))},[k(b(M),{class:"w-3.5 h-3.5"}),e[9]||(e[9]=w(" Edit ",-1))])])]),t("div",oe,[t("h2",ne,[e[10]||(e[10]=w(" Fill in Variables ",-1)),t("span",re,"("+v(f.value.length)+")",1)]),f.value.length===0?(n(),d("p",le," This template has no variables. Click Generate to create the PDF. ")):(n(),d("div",de,[(n(!0),d(T,null,O(f.value,s=>(n(),d("div",{key:s},[t("label",ie,[t("span",ue,[t("span",ce,v(E(s)),1)])]),$(t("input",{"onUpdate:modelValue":c=>g[s]=c,type:"text",placeholder:`Enter value for ${s}`,class:"w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-transparent transition"},null,8,me),[[B,g[s]]])]))),128))]))]),t("div",pe,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1.5"},"Output filename",-1)),t("div",ge,[$(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.value=s),type:"text",placeholder:"document",class:"flex-1 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-transparent"},null,512),[[B,r.value]]),e[11]||(e[11]=t("span",{class:"text-sm text-gray-400"},".pdf",-1))])]),t("button",{onClick:G,disabled:m.value,class:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-orange-500 text-white font-medium rounded-xl hover:bg-orange-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm"},[m.value?(n(),d("span",fe)):(n(),R(b(z),{key:1,class:"w-4 h-4"})),w(" "+v(m.value?"Generating PDFâ€¦":"Generate PDF"),1)],8,xe),u.value?(n(),d("div",be,[t("div",ve,[k(b(H),{class:"w-5 h-5 text-green-600 flex-shrink-0"}),e[13]||(e[13]=t("span",{class:"text-sm text-green-800"},"PDF generated successfully!",-1))]),t("a",{href:u.value,download:_.value,class:"flex items-center gap-1.5 px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors flex-shrink-0"},[k(b(S),{class:"w-3.5 h-3.5"}),e[14]||(e[14]=w(" Download ",-1))],8,ye)])):D("",!0),h.value?(n(),d("div",he,[t("p",we,v(h.value),1)])):D("",!0)],64)):(n(),d("div",Z,[e[8]||(e[8]=t("p",{class:"text-red-600 mb-3"},"Template not found.",-1)),t("button",{onClick:e[1]||(e[1]=s=>l.$router.push("/templates")),class:"text-sm text-orange-600 hover:underline"}," Back to templates ")]))])]))}};export{De as default};
//# sourceMappingURL=TemplateGenerator-CfbWZ_rU.js.map
